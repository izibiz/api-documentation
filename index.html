<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>İZİBİZ Entegrasyon Kılavuzu</title>

    <link href="stylesheets/screen.css" rel="stylesheet" type="text/css" media="screen" />
    <link href="stylesheets/print.css" rel="stylesheet" type="text/css" media="print" />
    <link href="stylesheets/fakeloader.css" rel="stylesheet" type="text/css" />
    <link href="stylesheets/izibiz.css" rel="stylesheet" type="text/css" />
    <link rel="icon" href="https://izibiz.com.tr/templates/theme3181/favicon.ico">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
    <script src="javascripts/fakeloader.js"></script>
      <script src="javascripts/all.js" type="text/javascript"></script>

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-122965680-2"></script>
    <script>
        /* Google Analytics start*/
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'UA-122965680-2');
        /* Google Analytics end*/

 $(document).ready(function() {
      $('.tocify-item a').on('click', function(){
        ga('send', 'pageview', {'page': location.pathname + location.search  + location.hash});
      });
    });
    </script>

      <script>
        $(document).ready(
          function() {
              window.FakeLoader.init( );
          }
        );
        $(function() {
          setupLanguages(["csharp"]);
        });
      </script>
  </head>

  <body class="index">
    <div id="fakeloader-overlay" class="visible incoming"><div class="loader-wrapper-outer"><div class="loader-wrapper-inner"><div class="loader"></div></div></div></div>
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar.png" alt="Navbar" />
      </span>
    </a>
    <div class="tocify-wrapper">
      <div class="logo-holder">
        <a href="https://izibiz.com.tr"><img src="images/logo.png" alt="Logo" /></a>
      </div>
        <div class="lang-selector">
              <a href="#" data-language-name="csharp">C#</a>
        </div>
     <!-- <div class="key-replace">
        <input type="text" class="key-replace" placeholder="Your API Key (optional)">
      </div>
-->   
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <div id="toc">
      </div>
        <ul class="toc-footer">
            <li><a href='https://izibiz.com.tr/index.php/urun-ve-hizmetler/e-fatura-destek/demo' target='_blank'>Test Hesabı Talep Formu</a></li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        
          <h1 id="ba-larken">Başlarken</h1>

<p>İZİBİZ Entegrasyon kılavuzuna hoşgeldiniz. Bu kılavuz yazılımlarını İZİBİZ sistemlerine entegre etmek isteyen firmalara yol göstermek için hazırlanmıştır.  Entegrasyon kılavuzumuz aşağıda ki ürünleri desteklemektedir  |</p>

<ul>
<li>E-Fatura</li>
<li>E-Arşiv Fatura</li>
<li>E-İrsaliye</li>
<li>E-Mutabakat</li>
<li>E-Defter</li>
<li>E-Müstahsil Makbuzu</li>
<li>E-Serbest Meslek Makbuzu</li>
<li>Z-Rapor</li>
</ul>

<p>Eğer entegrasyona yeni başlıyorsanız <code class="prettyprint">Başlarken</code> başlığı altında ki bilgileri okumanızı tavsiye ederiz.</p>

<h2 id="yard-m-talebi">Yardım Talebi</h2>

<p>Entegrasyon süreci ile ilgili her türlü teknik sorularınızı <strong>entegrasyon@izibiz.com.tr</strong> adresine iletebilirsiniz.</p>

<h2 id="tan-mlar-ve-k-saltmalar">Tanımlar ve Kısaltmalar</h2>

<table><thead>
<tr>
<th>Tanım</th>
<th>Açıklama</th>
</tr>
</thead><tbody>
<tr>
<td>Başkanlık</td>
<td>T.C. Maliye Bakanlığı Gelir İdaresi Başkanlığı</td>
</tr>
<tr>
<td>GİB</td>
<td>T.C. Maliye Bakanlığı Gelir İdaresi Başkanlığı</td>
</tr>
<tr>
<td>E-Fatura</td>
<td>Elektronik Fatura</td>
</tr>
<tr>
<td>Gönderici Birim</td>
<td>e-Faturanın düzenlenmesinden ve gönderilmesinden sorumlu birim</td>
</tr>
<tr>
<td>Posta Kutusu</td>
<td>Gönderilen e-faturanın alınmasından sorumlu birim</td>
</tr>
<tr>
<td>HTTP</td>
<td>(Hyper Text Transfer Protocol) Hiper Metin Transferi Protokolü</td>
</tr>
<tr>
<td>HTTPS</td>
<td>(Hyper Text Transfer Protocol Secure) Hiper Metin Transferi Protokolü–Güvenli</td>
</tr>
<tr>
<td>Merkez</td>
<td>Gönderici Birim ile Posta Kutusu arasındaki iletişimi sağlayan ve denetleyen birim</td>
</tr>
<tr>
<td>MTOM</td>
<td>(Message Transfer Optimization Method) Mesaj Transferi Optimizasyon Mekanizması. Web servisleri üzerinden verimli bir şekilde ikilik dosya iletimine olanak sağlayan veri iletim yöntemi</td>
</tr>
<tr>
<td>MD5</td>
<td>(Message-Digest Algorithm 5) Veri bütünlüğünü test etmek içinkullanılan, tek yönlü şifreleme algoritması</td>
</tr>
<tr>
<td>Schematron/Şematron</td>
<td>XML belgelerini mantıksal olarak kontrol etmek için kullanılan kural tabanlı doğrulama dili</td>
</tr>
<tr>
<td>Sistem Yanıtı</td>
<td>Fatura veya uygulama yanıtı içeren zarfların durumları ile ilgili olarak birimlerden gönderilen cevap mesajlarıdır.</td>
</tr>
<tr>
<td>SOAP</td>
<td>(Simple Object Access Protocol) Basit Nesne Erişim Protokolü. Dağıtık uygulamalarda ve web servislerinin haberleşmesinde kullanılmak üzere tasarlanan, sunucu/istemci mantığına dayalıiletişim protokolü</td>
</tr>
<tr>
<td>SSL</td>
<td>(Secure Sockets Layer) Bilginin bütünlüğü ve gizliliği için,internet üzerinde iki taraf arasında oluşan trafiğin şifrelenerek, gizliliğinin ve bütünlüğünün korunmasını sa ğlayan bir protokol</td>
</tr>
<tr>
<td>Schema/Şema</td>
<td>XML dosyalarında taşınan verilerin nasıl yorumlanacağının belirtimi</td>
</tr>
<tr>
<td>TCKN</td>
<td>T.C. Kimlik Numarası</td>
</tr>
<tr>
<td>VKN</td>
<td>Vergi Kimlik Numarası</td>
</tr>
<tr>
<td>Veritabanı</td>
<td>Çeşitli kaynaklardan elde edilen verilerin depolandığı veri yapısı</td>
</tr>
<tr>
<td>VPN</td>
<td>(Virtual Private Network) Telekomünikasyon altyapısı kullanılarak güvenli ve özel veri aktarımını sağlayan sanal özel ağ teknolojisi</td>
</tr>
<tr>
<td>W3C</td>
<td>WWW Birliği</td>
</tr>
<tr>
<td>Web Servis</td>
<td>Bilgisayarlar arasında ağ üzerinden etkileşimi ve uyumluluğu sağlayan yazılım sistemi</td>
</tr>
<tr>
<td>WSDL</td>
<td>(Web Services Description Language) Web Servislerinin tanımlandığı, erişim ve işlev bilgilerinin detaylı olarak sunulduğu XML tabanlı metin işaretleme dili</td>
</tr>
<tr>
<td>WS-I</td>
<td>(Web Services Interoperability) Değişik web servis belirtimlerinin birlikte çalışabilmesini sağlayan endüstri konsorsiyumu</td>
</tr>
<tr>
<td>WS-I Basic Profile</td>
<td>SOAP, WSDL, UDDI gibi temel web servis belirtimlerinin birlikte çalışabilmesini sağlayan profil</td>
</tr>
<tr>
<td>XML</td>
<td>(Extensible Markup Language) Verinin tanımlanması ve tarif edilmesi için kullanılan genişletilebilir işaretleme dili</td>
</tr>
<tr>
<td>XSD</td>
<td>(XML Schema Definition) XML belgelerinin uyması gereken kuralların belirlendiği metin işaretleme dili</td>
</tr>
<tr>
<td>XSLT</td>
<td>(Extensible Stylesheet Language Transformations) Genişletilebilir Biçimlendirme Dili Dönüşümleri, XML dokümanlarını dönüştürmek için kullanılan ve orijinal dokümanı değiştirmeden, yeni bir doküman oluşturmaya olanak sağlayan</td>
</tr>
<tr>
<td>UBL</td>
<td>(Universal Business Language) Evrensel İş Dili</td>
</tr>
<tr>
<td>UBL-TR</td>
<td>UBL Türkiye Özelleştirmesi</td>
</tr>
<tr>
<td>Uygulama</td>
<td>Elektronik Fatura Uygulaması</td>
</tr>
<tr>
<td>Uygulama Yanıtı</td>
<td>Ticari fatura senaryosunda alınan bir faturaya ait “KABUL”, “RED” veya “İADE” bilgisini içeren belge türüdür.</td>
</tr>
<tr>
<td>Fatura Tarihi</td>
<td>Faturanın kaynak sistemde düzenleme tarihi</td>
</tr>
<tr>
<td>E-Fatura Numarası</td>
<td>Faturaya Ait E-fatura Numarası</td>
</tr>
<tr>
<td>Sistem Referansı</td>
<td>Kaynak sistemden gelen folyo/çek/fatura referans numarası</td>
</tr>
<tr>
<td>Senaryo</td>
<td>Kullanılan fatura senaryosu (Temel Fatura / Ticari Fatura)</td>
</tr>
<tr>
<td>Fatura Tipi</td>
<td>Fatura Tipi Kodu (Satış / İade)</td>
</tr>
<tr>
<td>Alıcı Ünvan / Ad Soyad</td>
<td>Alıcı cari hesap ünvanı</td>
</tr>
<tr>
<td>TCKN / VKN</td>
<td>Alıcı vergi kimlik numarası</td>
</tr>
<tr>
<td>Fatura Net Tutar</td>
<td>KDV Tutarı / Toplam Tutarı</td>
</tr>
<tr>
<td>GTB</td>
<td>Gümrük ve Ticaret Bakanlığı</td>
</tr>
<tr>
<td>GÇB</td>
<td>Gümrük Çıkış Belgesi</td>
</tr>
<tr>
<td>ZIP</td>
<td>Veri sıkıştırma ve arşivleme formatı</td>
</tr>
</tbody></table>

<h2 id="belge-numaras-y-netimi">Belge Numarası Yönetimi</h2>

<ul>
<li>E-Dönüşüm sisteminde düzenlenen bir belgeyi tanımlayan iki önemli bilgi vardır. Bir tanesi Evrensel Tekil Tanımlama Numarası (ETTN), diğeri ise belge numarasıdır.</li>
<li>ETTN numarası GUID formatında olurken, belge numarası aşağıda açıklanmış formata olması zorunludur.</li>
<li>Belge numarası toplam 16 haneden oluşmak zorundadır.</li>
<li>3 hane alfanumerik seri ön eki  + 4 hane belgenin düzenlendiği yılı + 9 hane müteselsil sıra numarasını ifade etmektedir.  <strong>Örnek: IZI+2018+000000001</strong></li>
<li>Her yıl sıra numarası 1 den başlamak zorundadır.</li>
<li>Ser ön eki (ilk 3 hane) Türkçe karakter içermemeli ve büyük harfler yada sayılardan oluşmalıdr.</li>
<li>İlk 3 Karakter firmalar tarafından serbestçe belirlebilir. Her firma İstediği kadar seri kullanabilir. Her seri kendi içerisinde 1’den başlayarak sıralı devam etmelidir.</li>
<li>E-Fatura, E-İhracat fatura, E-Arşiv normal satış ve E-Arşiv internet üzerinden yapılan satışlar için düzenlenen faturalar  <strong>mutlaka</strong> farklı seriden düzenlenmelidir.</li>
<li>Belge numarası takibi gönderici sistemde yapılmalıdır.</li>
<li>Fatura düzenleyen bünyesinde aynı fatura numarası birden fazla kullanılamaz.</li>
</ul>

<h2 id="belge-g-r-nt-leme">Belge Görüntüleme</h2>

<ul>
<li><p>Bilindiği gibi e-dönüşüm sisteminde düzenlenen ve saklanan belgeler UBL-TR XML formatındadır. Düzenlenmiş her XML belgenin içerisinde görüntüsünü sağlayacak bir şablon (XSLT) dosya bulunmak zorundadır. Şablon belgesinin formatı XSLT (Extensible Stylesheet Language Transformations) Genişletilebilir Biçimlendirme Dili Dönüşümleridir. Bu dosya XML dokümanlarını insanların anlayacağı formata (HTML/PDF) dönüştürmek için kullanılır.</p></li>
<li><p>Belge şablon dosyası XML dosya içerisinde ki <strong>AdditionalDocumentReference</strong> elemanına eklenmek zorundadır.
<img src="/images/xslt_ekleme.png" height="200" width="400"/></p></li>
<li><p>Gelir İdaresi Başkanlığı tarafından mükellefler arasında ki anlaşmazlıklarda kullanabilecekleri ortak bir uygulama olan <strong>E-Belge Görüntüleyici</strong> uygulaması yayınlamıştır. Bu uygulama UBL-TR formatında ki belgenin içerisinde ki şablon ile görüntülemesini sağlar, şema ve şematron kontrolü yapar, belgenin içerisinde ki imzanın geçerliliğini kontrol eder ve belgenin GİB&#39;de ki durumunu kontrol eder.</p></li>
</ul>

<p>Kullandığınız Java Versiyonuna Göre E-Belge Görüntüleyici İndirebilirsiniz:
<a href="http://www.efatura.gov.tr/EFaturaGoruntuleyici/Windows/EFaturaGoruntuleyici.jnlp">E-Belge Görüntüleyici Java 1.6 İndir</a><br>
<a href="http://www.efatura.gov.tr/EFaturaGoruntuleyici/Windows/Java17/EFaturaGoruntuleyici.jnlp">E-Belge Görüntüleyici Java 1.7 İndir</a></p>

<h2 id="belge-g-nderme-kontrolleri">Belge Gönderme Kontrolleri</h2>

<p>Özel entegratör sistemi senkron çalışmaktadır. Yani herhangi bir servise gönderilen istek sunucu tarafından anlık olarak işlenerek sonuç dönülür. Yüklenen belgelerde hatalı durum tespit edilmesi durumunda webservis hata (SOAP Fault) dönülmektedir.</p>

<p>Belge gönderiminde aşağıda ki kontroller yapılmaktadır:</p>

<ul>
<li>Webservis parametre kontrolü</li>
<li>İşlem yapılacak aktif oturum kontrolü</li>
<li>Gönderici firmanın özel entegratör sisteminde ki tanımlama kontrolü</li>
<li>Gönderici ve alıcı firmaların mükellefiyet ve etiket kontrolü</li>
<li>Belgenin UBL-TR şemasına uygunluk kontrolü</li>
<li>Belgenin UBL-TR şematronuna uygunluk kontrolü</li>
<li>Gönderilen belge(lerin) özel entegratör sisteminde tekillik kontrolü</li>
</ul>

<h2 id="belge-olu-turma">Belge Oluşturma</h2>

<p>Özel Entegeratör webservislerine gönderilecek belgelerin (fatura, irsaliye, müstahsil vs) UBL-TR formatında istemci ortamında oluşturulması gerekmektedir. UBL-TR XML belge oluşturmak için <strong>iki yöntem kullanılabilir</strong> :</p>

<aside class="notice">
1. Gelir İdaresi Başkanlığı tarafından yayınlan UBL-TR paketinde bulunan belgelere ait şema (XSD) dosyasında uygulama geliştirme ortamına uygun sınıflar üretilebilir. Üretilen sınıftan obje oluşturarak fieldleri doldurarak belge hazırlanır. Hazırlanan belge webservise parametre olarak gönderilebiir.
</aside>

<ul>
<li><p>Güncel <a href="http://www.efatura.gov.tr/dosyalar/kilavuzlar/UBL-TR1.2.1_Paketi.zip">GİB UBL-TR Paketi</a> indirilip yerel C: disizine çıkarılır (unzip/extract).</p></li>
<li><p>Eğer <strong>Visual Studio 2015 öncesi</strong> yüklü olan bir bilgisayar kullanılıyorsa <strong>V(StudioVersiyonu) Command Prompt</strong> komutu çalıştırılır. Örneğin Visual studio 2013 kurulu bir bilgisayarda <strong>V2013 Command Prompt</strong> şeklinde çalıştırılır.</p></li>
<li><p>Eğer <strong>Visual Studio 2015 ve sonrası</strong> yüklü olan bir bilgisayar kullanılıyorsa <strong>Developer Command Prompt</strong> komut çalıştırılır.</p></li>
<li><p>Açılan komut satırında UBL-TR paketinin unzip edildiği dizinde bulunan <strong>maindoc</strong> klasörüne geçiş yapılır. <br> <strong>Örneğin:</strong> cd %UNZIP_EDILEN_KLASOR%\UBLTR_1.2.1_Paketi\xsdrt\maindoc\</p></li>
<li><p>Sınıfı oluşturulacak belge türüne uygun komut aşağıda ki listeye göre çalıştırılır.</p></li>
</ul>

<table><thead>
<tr>
<th>Belge Tipi</th>
<th>Çalıştırılacak Komut</th>
<th>Oluşacak Sınıf</th>
<th>Belge Tipi</th>
</tr>
</thead><tbody>
<tr>
<td>E-Fatura / E-Arşiv Fatura</td>
<td>xsd /c UBL-Invoice-2.1.xsd ../common/UBL-CommonExtensionComponents-2.1.xsd ../common/UBL-CommonBasicComponents-2.1.xsd ../common/UBL-UnqualifiedDataTypes-2.1.xsd ../common/UBL-CoreComponentParameters-2.1.xsd ../common/CCTS_CCT_SchemaModule-2.1.xsd ../common/UBL-CommonAggregateComponents-2.1.xsd</td>
<td>UBL-Invoice-2.1.cs</td>
<td>InvoiceType</td>
</tr>
<tr>
<td>E-İrsaliye</td>
<td>xsd /c UBL-DespatchAdvice-2.1.xsd ../common/UBL-CommonExtensionComponents-2.1.xsd ../common/UBL-CommonBasicComponents-2.1.xsd ../common/UBL-UnqualifiedDataTypes-2.1.xsd ../common/UBL-CoreComponentParameters-2.1.xsd ../common/CCTS_CCT_SchemaModule-2.1.xsd ../common/UBL-CommonAggregateComponents-2.1.xsd</td>
<td>UBL-DespatchAdvice-2.1.cs</td>
<td>DespatchAdviceType</td>
</tr>
<tr>
<td>E-İrsaliye Yanıtı</td>
<td>xsd /c UBL-ReceiptAdvice-2.1.xsd ../common/UBL-CommonExtensionComponents-2.1.xsd ../common/UBL-CommonBasicComponents-2.1.xsd ../common/UBL-UnqualifiedDataTypes-2.1.xsd ../common/UBL-CoreComponentParameters-2.1.xsd ../common/CCTS_CCT_SchemaModule-2.1.xsd ../common/UBL-CommonAggregateComponents-2.1.xsd</td>
<td>UBL-ReceiptAdvice-2.1.cs</td>
<td>ReceiptAdviceType</td>
</tr>
<tr>
<td>Müstahsil Makbuzu</td>
<td>xsd /c UBL-CreditNote-2.1.xsd ../common/UBL-CommonExtensionComponents-2.1.xsd ../common/UBL-CommonBasicComponents-2.1.xsd ../common/UBL-UnqualifiedDataTypes-2.1.xsd ../common/UBL-CoreComponentParameters-2.1.xsd ../common/CCTS_CCT_SchemaModule-2.1.xsd ../common/UBL-CommonAggregateComponents-2.1.xsd</td>
<td>UBL-CreditNote-2.1.cs</td>
<td>CreditNoteType</td>
</tr>
</tbody></table>

<p><br>
<aside class="notice">
2. Diğer bir yöntem ise String Replacement yöntemidir. Belgelere ait değişecek alanların belirlendiği bir şablon oluşturulur. Belge düzenlenirken ilgili alanlar güncellenir. Oluşan belge webservice parametre olarak gönderilir.
</aside></p>

<h2 id="webservice-endpoint-wsdl-url">Webservice Endpoint (WSDL) URL</h2>

<table><thead>
<tr>
<th>Ürün</th>
<th>Endpoint URL</th>
</tr>
</thead><tbody>
<tr>
<td>Kimlik Doğrulama</td>
<td><a href="https://efaturatest.izibiz.com.tr/AuthenticationWS?wsdl">https://efaturatest.izibiz.com.tr/AuthenticationWS?wsdl</a></td>
</tr>
<tr>
<td>E-Fatura Webservis</td>
<td><a href="https://efaturatest.izibiz.com.tr/EFaturaOIB?wsdl">https://efaturatest.izibiz.com.tr/EFaturaOIB?wsdl</a></td>
</tr>
<tr>
<td>E-Arşiv Fatura Webservis</td>
<td><a href="https://efaturatest.izibiz.com.tr/EIArchiveWS/EFaturaArchive?wsdl">https://efaturatest.izibiz.com.tr/EIArchiveWS/EFaturaArchive?wsdl</a></td>
</tr>
<tr>
<td>E-İrsaliye Webservis</td>
<td><a href="https://efaturatest.izibiz.com.tr/EIrsaliyeWS/EIrsaliye?wsdl">https://efaturatest.izibiz.com.tr/EIrsaliyeWS/EIrsaliye?wsdl</a></td>
</tr>
<tr>
<td>E-Müstahsil Webservis</td>
<td><a href="http://efaturatest.izibiz.com.tr/CreditNoteWS/CreditNote?wsdl">http://efaturatest.izibiz.com.tr/CreditNoteWS/CreditNote?wsdl</a></td>
</tr>
<tr>
<td>E-Mutabakat Webservis</td>
<td><a href="http://efaturatest.izibiz.com.tr/Reconciliation?wsdl">http://efaturatest.izibiz.com.tr/Reconciliation?wsdl</a></td>
</tr>
<tr>
<td>E-Serbest Meslek Webservis</td>
<td><a href="https://efaturatest.izibiz.com.tr/SmmWS?wsdl">https://efaturatest.izibiz.com.tr/SmmWS?wsdl</a></td>
</tr>
<tr>
<td>E-ZRapor Webservis</td>
<td><a href="https://efaturatest.izibiz.com.tr/ZReportWS?wsdl">https://efaturatest.izibiz.com.tr/ZReportWS?wsdl</a></td>
</tr>
</tbody></table>

<h3 id="portal-uygulamas">Portal Uygulaması</h3>

<p>Entegrasyon sürecinde Portal uygulamamızı aşağıda ki durumlar için kullanabilirsiniz:</p>

<ul>
<li>Belgelerin durumunu kontrol</li>
<li>Farklı senaryolar için belge düzenleyerek XML içeriğini kontrol</li>
<li>Alıcı firmanın mükellefiyet sorgulaması</li>
</ul>

<p>Test Portal Adresimiz: <a href="https://portaltest.izibiz.com.tr">https://portaltest.izibiz.com.tr</a></p>

<p>Test portali erişim bilgileri için <strong>entegrasyon@izibiz.com.tr</strong> adresi ile iletişime geçebilirsiniz.</p>

          <h1 id="kimlik-do-rulama-webservisi">Kimlik Doğrulama Webservisi</h1>

<p>Entegrasyon sürecinin ilk adımı olan kimlik doğrulamayı sağlayan servistir.  Yapılan her işlem mutlaka aktif bir oturum ile yapılmalıdır.</p>

<h2 id="ortak-kullan-lan-eleman">Ortak Kullanılan Eleman</h2>

<p>Her webservis isteğinde gönderilmesi beklen ortak elemandır (REQUEST_HEADER)</p>

<table><thead>
<tr>
<th>Parametre</th>
<th>Tip</th>
<th>Zorunluluk</th>
<th>Açıklama</th>
</tr>
</thead><tbody>
<tr>
<td><strong>SESSION_ID</strong></td>
<td>String</td>
<td><strong>Evet</strong></td>
<td>Login Metodunda sistem tarafında gönderilen SESSION_ID bilgisi. Sonraki tüm metod çağrılarında parametre olarak metoda geçmelidir.</td>
</tr>
<tr>
<td><strong>APPLICATION_NAME</strong></td>
<td>String</td>
<td><strong>Evet</strong></td>
<td>Metodu çağıran uygulamanın adı. Mutlaka uygulama adının yazılması gerekmektedir.</td>
</tr>
<tr>
<td><strong>CHANNEL_NAME</strong></td>
<td>String</td>
<td><strong>Evet</strong></td>
<td>Metodun çağrıldığı kanal adı.</td>
</tr>
<tr>
<td><strong>COMPRESSED</strong></td>
<td>String</td>
<td>Hayır</td>
<td>İçerikte taşınan bilginin ZIP formatında sıkıştırılmış mı gönderildiği/talep edildiği bilgisi. Belge gönderim ve belge okuma servislerinde gönderilen değere göre işlem yapılmaktadır.</td>
</tr>
<tr>
<td><strong>CLIENT_TXN_ID</strong></td>
<td>String</td>
<td>Hayır</td>
<td>İstemci uygulama tarafından işlem için üretilen işlem bilgisi (transaction id) varsa istek esnasında gönderilip, sonuçta alabileceğiniz bir değerdir. request/response eşleşmesi yapmak için kullanılabilir.</td>
</tr>
<tr>
<td><strong>INT_PARENT_TXN_ID</strong></td>
<td>String</td>
<td>Hayır</td>
<td>İstemci uygulamasında ana modül entitileri ile ilişkilendirelmek istenen ana transaction ID.</td>
</tr>
<tr>
<td><strong>ACTION_DATE</strong></td>
<td>String</td>
<td>Hayır</td>
<td>Metodun çağrılma tarihi</td>
</tr>
<tr>
<td><strong>CHANGE_INFO</strong></td>
<td>Array</td>
<td>Hayır</td>
<td>Bu eleman ile eğer verilerde bir değişiklik yapılacak ise o değişikliği ait bilgi.</td>
</tr>
<tr>
<td><strong>REASON</strong></td>
<td>String</td>
<td>Hayır</td>
<td>İşlem sebebi. Fatura gönderme, fatura alma vs.</td>
</tr>
<tr>
<td><strong>HOST_NAME</strong></td>
<td>String</td>
<td>Hayır</td>
<td>Metodu çağıran sunucunun host bilgisi.</td>
</tr>
<tr>
<td><strong>SIMULATION_FLAG</strong></td>
<td>String</td>
<td>Hayır</td>
<td>Metod çağrılır ancak arkadaki işlem yapılmaz.</td>
</tr>
</tbody></table>

<h2 id="oturum-a-ma-login">Oturum Açma (Login)</h2>

<ul>
<li>Web servis istemcisinin(client) özel entegratör platformuna kimlik doğrulayarak giriş yapmasını sağlar.</li>
<li>Bu servise giriş için kullanılan kullanıcı bilgileri, portale giriş için kullanılan kullanıcı bilgileri ile aynıdır.</li>
<li><strong>Login</strong> işleminden dönen işlem ID parametresi daha sonra çağrılacak tüm metotlarda <code class="prettyprint">HEADER_REQUEST.SESSION_ID</code> elemanı olarak gönderilmelidir.</li>
</ul>

<aside class="notice">DİKKAT: Açılan oturum sistemimizde 8 saat aktif kalmaktadır. Her fatura gönderiminde oturum açma ve kapatmak zorunda değilsiniz.
</aside>

<p>Servise gönderilmesi gereken parametreler şu şekildedir:</p>

<table><thead>
<tr>
<th>Parametre</th>
<th>Tip</th>
<th>Zorunluluk</th>
<th>Açıklama</th>
</tr>
</thead><tbody>
<tr>
<td><strong>REQUEST_HEADER</strong></td>
<td>ComplexType</td>
<td><strong>Evet</strong></td>
<td>Request Header objesi içerisinde <code class="prettyprint">SESSION_ID</code> ve <code class="prettyprint">APPLICATION_NAME</code> alanı zorunludur.</td>
</tr>
<tr>
<td><strong>REQUEST_HEADER.SESSION_ID</strong></td>
<td>String</td>
<td><strong>Evet</strong></td>
<td>Request Header objesi içerisinde bulunan <code class="prettyprint">SESSION_ID</code> login servisinde -1 olarak gönderilmelidir.</td>
</tr>
<tr>
<td><strong>USER_NAME</strong></td>
<td>String</td>
<td><strong>Evet</strong></td>
<td>Sisteme tanımlı kullanıcı adı. <strong>Test hesabı için entegrasyon@izibiz.com.tr e-posta adresiyle iletişime geçebilirsiniz.</strong></td>
</tr>
<tr>
<td><strong>PASSWORD</strong></td>
<td>String</td>
<td><strong>Evet</strong></td>
<td>Sisteme tanımlı kullanıcıya ait şifre.</td>
</tr>
</tbody></table>

<p><br><br>
Servisten dönen parametreler şu şekildedir:</p>

<table><thead>
<tr>
<th>Parametre</th>
<th>Tip</th>
<th>Açıklama</th>
</tr>
</thead><tbody>
<tr>
<td><strong>SESSION_ID</strong></td>
<td>String</td>
<td>Sonraki metod çağrılarında kullanılacak oturum bilgisi.</td>
</tr>
</tbody></table>

<h2 id="oturum-kapatma-logout">Oturum Kapatma (Logout)</h2>

<p>Web servis istemcisinin özel entegratör platformunda ki oturumu kapatmasını sağlayan servistir.</p>

<p>Servise gönderilmesi gereken parametreler şu şekildedir:</p>

<table><thead>
<tr>
<th>Parametre</th>
<th>Tip</th>
<th>Zorunluluk</th>
<th>Açıklama</th>
</tr>
</thead><tbody>
<tr>
<td><strong>SESSION_ID</strong></td>
<td>String</td>
<td><strong>Evet</strong></td>
<td>Oturum kapatılmak istenen session ID değeri</td>
</tr>
</tbody></table>

<p><br>
<br>
Servisten dönen parametreler şu şekildedir:</p>

<table><thead>
<tr>
<th>Parametre</th>
<th>Tip</th>
<th>Açıklama</th>
</tr>
</thead><tbody>
<tr>
<td><strong>RETURN_CODE</strong></td>
<td>String</td>
<td>Oturum başarı ile sonlandırılmışsa <code class="prettyprint">0</code> döner</td>
</tr>
</tbody></table>

<h2 id="m-kellef-listesi-ekme-getgibuserlist">Mükellef Listesi Çekme (GetGibUserList)</h2>

<p>E-Fatura ve E-İrsaliye sistemine kayıtlı firmalara ait GB/PK etiketlerinin sıkıştırılmış olarak istenilen tipte dönüldüğü servistir.</p>

<table><thead>
<tr>
<th>Parametre</th>
<th>Tip</th>
<th>Zorunluluk</th>
<th>Açıklama</th>
</tr>
</thead><tbody>
<tr>
<td><strong>REQUEST_HEADER</strong></td>
<td>ComplexType</td>
<td>Evet</td>
<td>Request Header objesi içerisinde <code class="prettyprint">SESSION_ID</code> ve <code class="prettyprint">APPLICATION_NAME</code> alanı zorunludur.</td>
</tr>
<tr>
<td><strong>TYPE</strong></td>
<td>String</td>
<td>Hayır</td>
<td>Listenin dönüleceği dosya tipi. <code class="prettyprint">XML</code> ve <code class="prettyprint">CSV</code> olabilir. Varsayılan <code class="prettyprint">XML</code>dir.</td>
</tr>
<tr>
<td><strong>DOCUMENT_TYPE</strong></td>
<td>String</td>
<td>Hayır</td>
<td>Mükellef listesi çekilmek istenilen ürün tipi. E-Fatura için <code class="prettyprint">INVOICE</code>, E-İrsaliye için <code class="prettyprint">DESPATCHADVICE</code> gönderilmelidir. Her iki ürüne ait etiketleri çekmek için <code class="prettyprint">ALL</code> değeri gönderilebilir. Parametre gönderilmez veya boş gönderilirse bütün liste dönülecektir.</td>
</tr>
<tr>
<td><strong>REGISTER_TIME_START</strong></td>
<td>DateTime</td>
<td>Hayır</td>
<td>Belirli bir tarihten sonra sisteme dahil olmuş mükellefleri çekmek için kullanılabilir. formatı: 2013-01-01T01:01:01</td>
</tr>
</tbody></table>

<p><br><br>
Servisten dönen parametreler şu şekildedir:</p>

<table><thead>
<tr>
<th>Parametre</th>
<th>Tip</th>
<th>Açıklama</th>
</tr>
</thead><tbody>
<tr>
<td><strong>CONTENT</strong></td>
<td>Base64Encoded</td>
<td>Kriterlere uygun mükelleflere ait GB ve PK adresleri</td>
</tr>
</tbody></table>

<aside class="success">
Sonuç sıkıştırılmış XML dosyası içerisinde `USER` tipinde değer dönülmektedir. Sonuç istemci tarafına çekildikten sonra zipten çıkarılmalı ve XML dosya işlenmelidir.
</aside>

<p><strong>XML dosyasının içerisinde bulunan USER objesinin elamanları şu şekildedir :</strong></p>

<table><thead>
<tr>
<th>Eleman</th>
<th>Tip</th>
<th>Açıklama</th>
</tr>
</thead><tbody>
<tr>
<td><strong>USER.IDENTIFIER</strong></td>
<td>String</td>
<td>Mükellefe ait VKNsı.</td>
</tr>
<tr>
<td><strong>USER.ALIAS</strong></td>
<td>String</td>
<td>Mükellefe ait GB veya PK etiketi. format: urn:mail:defaultgb@firma.com</td>
</tr>
<tr>
<td><strong>USER.TITLE</strong></td>
<td>String</td>
<td>Firmanın GİB e-fatura sisteminde tanımlı ünvanı.</td>
</tr>
<tr>
<td><strong>USER.TYPE</strong></td>
<td>String</td>
<td>Firmanın GİB e-fatura sisteminde tanımlı tipi. <code class="prettyprint">OZEL</code> veya <code class="prettyprint">KAMU</code> olabilir.</td>
</tr>
<tr>
<td><strong>USER.UNIT</strong></td>
<td>String</td>
<td>Etiketin tipi. <code class="prettyprint">GB</code> veya <code class="prettyprint">PK</code></td>
</tr>
<tr>
<td><strong>USER.DOCUMENT_TYPE</strong></td>
<td>String</td>
<td>E-Fatura için <code class="prettyprint">INVOICE</code>, E-İrsaliye için <code class="prettyprint">DESPATCHADVICE</code> dönülmektedir.</td>
</tr>
<tr>
<td><strong>USER.REGISTER_TIME</strong></td>
<td>DateTime</td>
<td>Firmanın GİB e-fatura sistemine ilk kayıt olduğu tarih. formatı: 2013-07-01T15:22:11</td>
</tr>
<tr>
<td><strong>USER.ALIAS_CREATION_TIME</strong></td>
<td>DateTime</td>
<td>Etiketin oluşturulduğu tarih. formatı: 2013-07-01T15:22:11</td>
</tr>
</tbody></table>

<h2 id="e-fatura-m-kellefi-sorgulama-checkuser">E-Fatura Mükellefi Sorgulama (CheckUser)</h2>

<ul>
<li>Mükellefin, Gelir İdaresi Başkanlığı sistemine kayıtlı olup olmadığının kontrol edildiği servistir.</li>
<li>Sorgulanan VKN GİB sistemine kayıtlıysa, sistemde tanımlanmış etiket listesi dönülmektedir.</li>
<li>Sorgulanan VKN GİB sistemine kayıtlı değilse liste boş dönülür. <strong>Sonuç boş ise firma mükellef değildir.</strong></li>
</ul>

<p>Servise gönderilmesi gereken parametreler şu şekildedir:</p>

<table><thead>
<tr>
<th>Parametre</th>
<th>Tip</th>
<th>Zorunluluk</th>
<th>Açıklama</th>
</tr>
</thead><tbody>
<tr>
<td><strong>REQUEST_HEADER</strong></td>
<td>ComplexType</td>
<td><strong>Evet</strong></td>
<td>Request Header objesi içerisinde <code class="prettyprint">SESSION_ID</code> ve <code class="prettyprint">APPLICATION_NAME</code> alanı zorunludur.</td>
</tr>
<tr>
<td><strong>USER.IDENTIFIER</strong></td>
<td>String</td>
<td><strong>Evet</strong></td>
<td>Mükellefiyeti sorgulanacak firmanın vergi kimlik numarası</td>
</tr>
<tr>
<td><strong>DOCUMENT_TYPE</strong></td>
<td>String</td>
<td><strong>Evet</strong></td>
<td>Mükelleffiyet kontrol edilecek ürün tipi. E-Fatura için <code class="prettyprint">INVOICE</code>, E-İrsaliye için <code class="prettyprint">DESPATCHADVICE</code> gönderilmelidir.</td>
</tr>
</tbody></table>

<p><br><br>
Servisten dönen parametreler şu şekildedir:</p>

<table><thead>
<tr>
<th>Parametre</th>
<th>Tip</th>
<th>Açıklama</th>
</tr>
</thead><tbody>
<tr>
<td><strong>USER.IDENTIFIER</strong></td>
<td>String</td>
<td>Mükellefe ait VKNsı.</td>
</tr>
<tr>
<td><strong>USER.ALIAS</strong></td>
<td>String</td>
<td>Mükellefe ait GB veya PK etiketi.</td>
</tr>
<tr>
<td><strong>USER.TITLE</strong></td>
<td>String</td>
<td>Firmanın GİB sisteminde tanımlı ünvanı.</td>
</tr>
<tr>
<td><strong>USER.TYPE</strong></td>
<td>String</td>
<td>Firmanın GİB sisteminde tanımlı tipi. <code class="prettyprint">OZEL</code> veya <code class="prettyprint">KAMU</code> olabilir.</td>
</tr>
<tr>
<td><strong>USER.REGISTER_TIME</strong></td>
<td>Date</td>
<td>Firmanın GİB sistemine ilk kayıt olduğu tarih. formatı: 2013-07-01T15:22:11</td>
</tr>
<tr>
<td><strong>USER.UNIT</strong></td>
<td>String</td>
<td>Etiketin tipi. <code class="prettyprint">GB</code> veya <code class="prettyprint">PK</code></td>
</tr>
<tr>
<td><strong>USER.ALIAS_CREATION_TIME</strong></td>
<td>DateTime</td>
<td>Etiketin oluşturulduğu tarih. formatı: 2013-07-01T15:22:11</td>
</tr>
</tbody></table>

          <h1 id="e-fatura-webservisi">E-Fatura Webservisi</h1>

<p>e-Fatura servisi, e-fatura mükellefinin fatura gönderimini ve gelen faturaları kendisi sistemine çekmesini sağlayan webservis uygulamasıdır.</p>

<h2 id="g-b-dok-manlar">GİB Dokümanları</h2>

<table><thead>
<tr>
<th>Doküman</th>
<th>Açıklama</th>
<th>İndir</th>
</tr>
</thead><tbody>
<tr>
<td><strong>UBL-TR Fatura</strong></td>
<td>UBL-TR v1.2 (UBL 2.1 Türkiye Özelleştirmesi) paketinde yer alan fatura belgesinde geçen elemanlara ait XSD, tanımlama, kullanım şekilleri, kardinaliteler hakkında bilgi vermek ve örnek kullanım şekillerini göstermek amacı ile hazırlanmıştır.</td>
<td><a href="/resource/BELGELER/UBL-TR Fatura - V 1.0.pdf"><img src="/images/icon_pdf.png" height="40" width="35"/></a></td>
</tr>
<tr>
<td><strong>UBL-TR Ortak Elemanlar</strong></td>
<td>UBL-TR (UBL 2.1 Türkiye Özelleştirmesi) paketinde yer alan belgelerde geçmesi muhtemel elemanlara ait (ortak elemanlar örneğin: Adres, Parasal Toplamlar, Taraf gibi) XSD, açıklama, kullanım şartları, kardinaliteler hakkında bilgi vermek ve örnek kullanım şekillerini göstermek amacı ile hazırlanmıştır.</td>
<td><a href="/resource/BELGELER/UBL-TR Ortak Elemanlar - V 0.7.pdf"><img src="/images/icon_pdf.png" height="40" width="35"/></a></td>
</tr>
<tr>
<td><strong>UBL-TR Kod Listeleri</strong></td>
<td>UBL-TR kapsamında kullanılan Kodlama Sistemleri ve Kimlik Şemaları hakkında bilgi vermek amacı ile hazırlanmıştır.</td>
<td><a href="/resource/BELGELER/UBL-TR Kod Listeleri - V 1.18.pdf"><img src="/images/icon_pdf.png" height="40" width="35"/></a></td>
</tr>
<tr>
<td><strong>Gümrük İşlemleri Kılavuzu</strong></td>
<td>Elektronik Fatura Uygulamasında yolcu beraberi eşya ihracı ve mal ihracı faturalarını e-fatura sistemine entegre edecek ve uygulamaya ilişkin yazılım geliştireceklerin teknik konularda ihtiyaç duyabilecekleri bilgileri vermek amacıyla hazırlanmıştır.</td>
<td><a href="/resource/GUMRUK/Gumruk_Islemleri_Kilavuzu_Versiyon_1_8.pdf"><img src="/images/icon_pdf.png" height="40" width="35"/></a></td>
</tr>
<tr>
<td><strong>İhracat Faturası Ek Alanlar</strong></td>
<td>İhracat faturalarında eklenmesi zorunlu ve isteğe bağlı alanların açıklamak için hazırlanmıştır.</td>
<td><a href="/resource/GUMRUK/Gumruk_Islemleri_Kilavuzu_Versiyon_1_8.pdf"><img src="/images/icon_pdf.png" height="40" width="35"/></a></td>
</tr>
<tr>
<td><strong>SGK E-Fatura Kılavuzu</strong></td>
<td>Elektronik Fatura Uygulamasında Sosyal Güvenlik Kurumuna (SGK) düzenlenecek  faturaların e-fatura sistemine entegre edecek uygulamaya ilişkin yazılım geliştireceklerin teknik konularda ihtiyaç duyabilecekleri bilgileri vermek amacıyla hazırlanmıştır.</td>
<td><a href="http://www.efatura.gov.tr/dosyalar/kilavuzlar/SGK_e-FATURA_UYGULAMA_KILAVUZU.pdf"><img src="/images/icon_pdf.png" height="40" width="35"/></a></td>
</tr>
</tbody></table>

<h2 id="ubl-fatura-rnekleri">UBL-Fatura Örnekleri</h2>

<p>E-Fatura ve E-Arşiv Fatura sistemi üzerinden düzenlebilecek ve gönderilebilecek fatura senaryoları ve örnek fatura XML dosyası aşağıda listelenmiştir.</p>

<aside class="notice">Listede bulunmayan senaryolar için fatura üretmek için  E-Fatura Portale erişebilirsiniz.</aside>

<table><thead>
<tr>
<th>Fatura Senaryosu</th>
<th>Açıklama</th>
<th>XML</th>
<th>HTML</th>
</tr>
</thead><tbody>
<tr>
<td><strong>Temel Satış Faturası</strong></td>
<td>Alıcısı tarafından elektronik ortamda kabul veya reddedilemeyen fatura tipidir.</td>
<td><a href="/resource/xml/FATURA_2.xml" target="_blank"><img src="/images/icon_xml.png" height="40" width="35"/></a></td>
<td><a href="/resource/xml/FATURA_2.html" target="_blank"><img src="/images/icon_html.png" height="40" width="35"/></a></td>
</tr>
<tr>
<td><strong>Ticari Satış Faturası</strong></td>
<td>Alıcısı tarafından elektronik ortamda kabul veya reddedilebilen fatura tipidir.</td>
<td><a href="/resource/xml/FATURA_1.xml" target="_blank"> <img src="/images/icon_xml.png" height="40" width="35"/></a></td>
<td><a href="/resource/xml/FATURA_1.html" target="_blank"><img src="/images/icon_html.png" height="40" width="35"/></a></td>
</tr>
<tr>
<td><strong>İade Faturası</strong></td>
<td>Alınan bir fatura üzerinde ki yanlış tutar veya eksik bilgi sebebi ile düzenlenen fatura tipidir. <strong>İade faturası TEMELFATURA olarak gönderilmesi zorunludur.</strong></td>
<td><a href="/resource/xml/FATURA_4.xml" target="_blank"> <img src="/images/icon_xml.png" height="40" width="35"/></a></td>
<td><a href="/resource/xml/FATURA_4.html" target="_blank"><img src="/images/icon_html.png" height="40" width="35"/></a></td>
</tr>
<tr>
<td><strong>Farklı KDV Oranlarına Sahip Fatura</strong></td>
<td>Fatura satırında farklı KDV oranlarının bulunduğu fatura örneğidir. Her satırda farklı KDV oranı vardır.</td>
<td><a href="/resource/xml/FATURA_5.xml" target="_blank"> <img src="/images/icon_xml.png" height="40" width="35"/></a></td>
<td><a href="/resource/xml/FATURA_5.html" target="_blank"><img src="/images/icon_html.png" height="40" width="35"/></a></td>
</tr>
<tr>
<td><strong>0 KDV Fatura</strong></td>
<td>Fatura satırında KDV oranı 0 olan satış faturası örneğidir. KDV 0 olduğu durumlarda muafiyet sebebi belirtilmelidir.</td>
<td><a href="/resource/xml/FATURA_6.xml" target="_blank"> <img src="/images/icon_xml.png" height="40" width="35"/></a></td>
<td><a href="/resource/xml/FATURA_6.html" target="_blank"><img src="/images/icon_html.png" height="40" width="35"/></a></td>
</tr>
<tr>
<td><strong>Dövizli Satış Faturası</strong></td>
<td>Fatura para birimi TL dışında farklı bir para birimi ile düzenlenen fatura örneğidir. Faturanın içerisinde tutarlar döviz cinsindendir.  TL karşlıkları XML içerisinde bulunmaz. TL karşılıkları görsel üzerinde tutar ile kur çarpılarak gösterilir.</td>
<td><a href="/resource/xml/FATURA_7.xml" target="_blank"> <img src="/images/icon_xml.png" height="40" width="35"/></a></td>
<td><a href="/resource/xml/FATURA_7.html" target="_blank"><img src="/images/icon_html.png" height="40" width="35"/></a></td>
</tr>
<tr>
<td><strong>Bedelsiz (%100 İskontolu) Satış Faturası</strong></td>
<td>Promosyon, Eşantiyon veya Numune Ürün Teslimlerinde bedelsiz düzenlenen fatura örneğidir. Bu faturalarda KDV 0 hesaplandığı için muafiyet sebebi belirtilmelidir.  Bu faturaların muafiyet kodu 351 olur. Muafiyet sebebi ise müşteri tarafından girilebilir.</td>
<td><a href="/resource/xml/FATURA_10.xml" target="_blank"> <img src="/images/icon_xml.png" height="40" width="35"/></a></td>
<td><a href="/resource/xml/FATURA_10.html" target="_blank"><img src="/images/icon_html.png" height="40" width="35"/></a></td>
</tr>
<tr>
<td><strong>Satırda Çoklu İskontolu Satış Faturası</strong></td>
<td>Bir fatura satırında birden fazla iskonto içeren fatura örneğidir.</td>
<td><a href="/resource/xml/FATURA_9.xml" target="_blank"> <img src="/images/icon_xml.png" height="40" width="35"/></a></td>
<td><a href="/resource/xml/FATURA_9.html" target="_blank"><img src="/images/icon_html.png" height="40" width="35"/></a></td>
</tr>
<tr>
<td><strong>İstisna Faturası</strong></td>
<td>İstisna Faturası</td>
<td><a href="/resource/xml/FATURA_11.xml" target="_blank"> <img src="/images/icon_xml.png" height="40" width="35"/></a></td>
<td><a href="/resource/xml/FATURA_11.html" target="_blank"><img src="/images/icon_html.png" height="40" width="35"/></a></td>
</tr>
<tr>
<td><strong>Özel Mathrah Faturası</strong></td>
<td>Özel Matrah Faturası</td>
<td><a href="/resource/xml/FATURA_12.xml" target="_blank"> <img src="/images/icon_xml.png" height="40" width="35"/></a></td>
<td><a href="/resource/xml/FATURA_12.html" target="_blank"><img src="/images/icon_html.png" height="40" width="35"/></a></td>
</tr>
<tr>
<td><strong>Tevkifat Faturası</strong></td>
<td>Tevkifat Faturası</td>
<td><a href="/resource/xml/FATURA_13.xml" target="_blank"> <img src="/images/icon_xml.png" height="40" width="35"/></a></td>
<td><a href="/resource/xml/FATURA_13.html" target="_blank"><img src="/images/icon_html.png" height="40" width="35"/></a></td>
</tr>
<tr>
<td><strong>İhraç Kayıtlı Fatura</strong></td>
<td>İhraç Kayıtlı Fatura</td>
<td><a href="/resource/xml/FATURA_17.xml" target="_blank"> <img src="/images/icon_xml.png" height="40" width="35"/></a></td>
<td><a href="/resource/xml/FATURA_17.html" target="_blank"><img src="/images/icon_html.png" height="40" width="35"/></a></td>
</tr>
<tr>
<td><strong>İhracat Faturası</strong></td>
<td>İhracat Faturası</td>
<td><a href="/resource/xml/FATURA_18.xml" target="_blank"> <img src="/images/icon_xml.png" height="40" width="35"/></a></td>
<td><a href="/resource/xml/FATURA_18.html" target="_blank"><img src="/images/icon_html.png" height="40" width="35"/></a></td>
</tr>
<tr>
<td><strong>Yolcu Beraberi (Taxfree)</strong></td>
<td>Yolcu Beraberi (Taxfree)</td>
<td><a href="/resource/xml/FATURA_19.xml" target="_blank"> <img src="/images/icon_xml.png" height="40" width="35"/></a></td>
<td><a href="/resource/xml/FATURA_19.html" target="_blank"><img src="/images/icon_html.png" height="40" width="35"/></a></td>
</tr>
<tr>
<td><strong>SGK Faturası</strong></td>
<td>SGK Faturası TEMELFATURA senaryosunda gönderilmek zorundadır.</td>
<td><a href="/resource/xml/FATURA_20.xml" target="_blank"> <img src="/images/icon_xml.png" height="40" width="35"/></a></td>
<td><a href="/resource/xml/FATURA_20.html" target="_blank"><img src="/images/icon_html.png" height="40" width="35"/></a></td>
</tr>
<tr>
<td><strong>Gelir Vergisi(GV) Stopajlı Fatura</strong></td>
<td>Gelir vergisi stopajı uygulanan fatura örneğidir.</td>
<td><a href="/resource/xml/FATURA_14.xml" target="_blank"> <img src="/images/icon_xml.png" height="40" width="35"/></a></td>
<td><a href="/resource/xml/FATURA_14.html" target="_blank"><img src="/images/icon_html.png" height="40" width="35"/></a></td>
</tr>
<tr>
<td><strong>Kurumlar Vergisi(KV) Stopajlı Fatura</strong></td>
<td>Kurumlar vergisi stopajı uygulanan fatura örneğidir.</td>
<td><a href="/resource/xml/FATURA_15.xml" target="_blank"> <img src="/images/icon_xml.png" height="40" width="35"/></a></td>
<td><a href="/resource/xml/FATURA_15.html" target="_blank"><img src="/images/icon_html.png" height="40" width="35"/></a></td>
</tr>
<tr>
<td><strong>Ek Belge İçeren Fatura</strong></td>
<td>Faturanın ekinde belge gönderildiği durumlarda düzenlenecek fatura örneğidir.</td>
<td><a href="/resource/xml/FATURA_16.xml" target="_blank"> <img src="/images/icon_xml.png" height="40" width="35"/></a></td>
<td><a href="/resource/xml/FATURA_16.html" target="_blank"><img src="/images/icon_html.png" height="40" width="35"/></a></td>
</tr>
<tr>
<td><strong>E-Arşiv Fatura - İnternet</strong></td>
<td>Internet üzerine yapılan satış için düzenlenen fatura tipidir. Bu faturalar alıcısına elektronik ortamda iletilmek zorundadır. Bu faturalar diğer satış faturalarından farklı bir seriden gönderilmeldir.</td>
<td><a href= "/resource/xml/FATURA_21.xml" target="_blank"><img src="/images/icon_xml.png" height="40" width="35"/></a></td>
<td><a href="/resource/xml/FATURA_21.html" target="_blank"><img src="/images/icon_html.png" height="40" width="35"/></a></td>
</tr>
<tr>
<td><strong>E-Arşiv Fatura - Normal</strong></td>
<td>Internet üzerine yapılan satış dışında düzenlenen fatura tipidir. Bu faturalar alıcısına elektronik ortamda iletilebileceği gibi kağıt olarakta teslim edilebilir.</td>
<td><a href= "/resource/xml/FATURA_22.xml" target="_blank"><img src="/images/icon_xml.png" height="40" width="35"/></a></td>
<td><a href="/resource/xml/FATURA_22.html" target="_blank"><img src="/images/icon_html.png" height="40" width="35"/></a></td>
</tr>
</tbody></table>

<h2 id="webservice-endpoint-wsdl-url">Webservice Endpoint (WSDL) URL</h2>

<table><thead>
<tr>
<th>Ürün</th>
<th>Endpoint URL</th>
</tr>
</thead><tbody>
<tr>
<td>Kimlik Doğrulama</td>
<td><a href="https://efaturatest.izibiz.com.tr/AuthenticationWS?wsdl">https://efaturatest.izibiz.com.tr/AuthenticationWS?wsdl</a></td>
</tr>
<tr>
<td>E-Fatura Webservis</td>
<td><a href="https://efaturatest.izibiz.com.tr/EFaturaOIB?wsdl">https://efaturatest.izibiz.com.tr/EFaturaOIB?wsdl</a></td>
</tr>
<tr>
<td>E-Arşiv Fatura Webservis</td>
<td><a href="https://efaturatest.izibiz.com.tr/EIArchiveWS/EFaturaArchive?wsdl">https://efaturatest.izibiz.com.tr/EIArchiveWS/EFaturaArchive?wsdl</a></td>
</tr>
<tr>
<td>E-İrsaliye Webservis</td>
<td><a href="https://efaturatest.izibiz.com.tr/EIrsaliyeWS/EIrsaliye?wsdl">https://efaturatest.izibiz.com.tr/EIrsaliyeWS/EIrsaliye?wsdl</a></td>
</tr>
<tr>
<td>E-Müstahsil Webservis</td>
<td><a href="http://efaturatest.izibiz.com.tr/CreditNoteWS/CreditNote?wsdl">http://efaturatest.izibiz.com.tr/CreditNoteWS/CreditNote?wsdl</a></td>
</tr>
<tr>
<td>E-Mutabakat Webservis</td>
<td><a href="http://efaturatest.izibiz.com.tr/Reconciliation?wsdl">http://efaturatest.izibiz.com.tr/Reconciliation?wsdl</a></td>
</tr>
<tr>
<td>E-Serbest Meslek Webservis</td>
<td><a href="https://efaturatest.izibiz.com.tr/SmmWS?wsdl">https://efaturatest.izibiz.com.tr/SmmWS?wsdl</a></td>
</tr>
<tr>
<td>E-ZRapor Webservis</td>
<td><a href="https://efaturatest.izibiz.com.tr/ZReportWS?wsdl">https://efaturatest.izibiz.com.tr/ZReportWS?wsdl</a></td>
</tr>
</tbody></table>

<h3 id="portal-uygulamas">Portal Uygulaması</h3>

<p>Entegrasyon sürecinde Portal uygulamamızı aşağıda ki durumlar için kullanabilirsiniz:</p>

<ul>
<li>Belgelerin durumunu kontrol</li>
<li>Farklı senaryolar için belge düzenleyerek XML içeriğini kontrol</li>
<li>Alıcı firmanın mükellefiyet sorgulaması</li>
</ul>

<p>Test Portal Adresimiz: <a href="https://portaltest.izibiz.com.tr">https://portaltest.izibiz.com.tr</a></p>

<p>Test portali erişim bilgileri için <strong>entegrasyon@izibiz.com.tr</strong> adresi ile iletişime geçebilirsiniz.</p>

<h2 id="test-hesaplar">Test Hesaplar</h2>

<p>Test sürecinde düzenlenen faturaların/irsaliyelerin göndericisi, alıcısı ve etiketler için aşağıda ki bilgiler kullanılmalıdır.</p>

<table><thead>
<tr>
<th>Gönderici VKN</th>
<th>Gönderici Etiket</th>
<th>Alıcı VKN</th>
<th>Alıcı Etiket</th>
</tr>
</thead><tbody>
<tr>
<td>4840847211</td>
<td>urn:mail:defaultgb@izibiz.com.tr</td>
<td>4840847211</td>
<td>urn:mail:defaultpk@izibiz.com.tr</td>
</tr>
</tbody></table>

<h2 id="dikkat-edilecek-hususlar">Dikkat Edilecek Hususlar</h2>

<p>Uygulamanızı tasarlarken aşağıda ki bilgiler faydalı olacaktır:</p>

<ol>
<li><strong>Kimlik Doğrulama (Authentication)</strong> Webservisinde bulunan <strong>Login</strong> servisi ile oturum açarak session id alınacak. Session Id sistemimiz tarafında 8 saate kadar zaman aşımına uğramadığı için kullanıcı giriş yapınca session id alıp bütün kullanım süresinde aynı session id kullanabilirsiniz.</li>
<li><strong>Kimlik Doğrulama (Authentication)</strong> Webservisinde bulunan <strong>GetGibUserList</strong> servisi ile GIB e-fatura mükellef listesini her 2 saatte özel entegratör platformundan çekmeniz gerekmektedir. Güncel listeyi çektikten sonra Cari listenizde ki firmaların e-fatura mükellefi olup olmadığını güncellemelisiniz.</li>
<li>E-Fatura Mükellefi olan firmalara kesilen faturaları UBL-TR formatına dönüştürerek (ekte örnek fatura bulunuyor) İzibiz sunucularına gönderebilirsiniz. Her fatura içerisinde faturanın görüntülenmesini sağlayan XSLT dokümanı olmalıdır.</li>
<li><strong>SendInvoice</strong> metodu ile fatura gönderimi yapılacak. Gönderim esnasında eğer faturanın alıcısına ait birden fazla Posta Kutusu bulunuyorsa ekranda seçilerek gönderilmesi sağlanmalı. Sadece 1 adet PK adresi varsa seçim yapılmadan gönderim sağlanabilir.</li>
<li><strong>GetInvoiceStatus</strong> metodu ile gelen/giden faturaların durumları sorgulanacak. Nihai duruma erişene kadar faturanın durumu özel entegratör sisteminden minumum 4 saatte bir sorgulanmalıdır. <strong>Sık sorgulama yapmayınız.</strong></li>
<li><strong>GetInvoice</strong> metodu ile firmaya gelen faturalar müşteri bilgisayarına aktarılır. İzibiz sistemlerine gelen yeni faturaları almanız gerekmektedir. Servis ile yeni gelen en fazla 100 adet faturayı çekebilirsiniz. Eğer dönen listede 100 adet fatura varsa yeniden getinvoice servisi çağırılarak başka fatura olup olmadığı kontrol edilmelidir. Dönen listede 100den az fatura varsa tekrar sorgulama yapmaya gerek yoktur. Fatura çekme zamanlayıcı ile yapılıyorsa en az 15 dk bir servis çağırılmalıdır.</li>
<li><strong>MarkInvoice</strong> metodu ile başarılı şekilde teslim alınan faturalar izibiz sistemlerinde okundu olarak işaretlenir. Böylece bir sonra ki getinvoice servisi çağrılınca dönülmez.</li>
<li><strong>SendInvoiceResponseWithServerSign</strong> metodu ile gelen ticari bir faturaya kabul veya red yanıtı gönderebilirsiniz.</li>
<li>Gelen bir faturaya 8 gün içerisinde kabul veya red gönderilebilir. <strong>8 günü geçtikten sonra kabul/red yapılması engellenmelidir. Temel faturalar için yanıt gönderilmesi kısıtlanmalıdır.</strong></li>
<li>Ticari bir faturaya elektronik ortamda en fazla 1 adet yanıt gönderilebilir. Bundan dolayı bir faturaya başarıyla yanıt (kabul/red) gönderilmişse farklı bir yanıt gönderilmesi kısıtlanmalıdır.</li>
<li><strong>Kimlik Doğrulama (Authentication)</strong> Webservisinde bulunan <strong>Logout</strong> metodu ile kullanıcı e-fatura programını kapatınca veya sizin belirlediğiniz bir sürede oturumu kapatabilirsiniz.</li>
</ol>

<h2 id="e-fatura-entegrasyon-kontrol-listesi">E-Fatura Entegrasyon Kontrol Listesi</h2>

<table><thead>
<tr>
<th>Durum</th>
<th>Kontrol</th>
</tr>
</thead><tbody>
<tr>
<td><strong>Evet / Hayır</strong></td>
<td>Oturum Açmak için <strong>Kimlik Doğrulama (Authentication)</strong> webservisinde ki <strong>Login</strong> metodu kullanıldı.</td>
</tr>
<tr>
<td><strong>Evet / Hayır</strong></td>
<td>Oturum açıldıktan sonra bütün isteklerde aynı Session ID kullanılıyor. Eğer Aktif session bulunamadı hatası dönülürse yeni oturum açılıyor.</td>
</tr>
<tr>
<td><strong>Evet / Hayır</strong></td>
<td>E-Fatura mükellef listesi çekmek için <strong>Kimlik Doğrulama (Authentication)</strong> webservisinde ki <strong>GetGibUserList</strong> metodu kullanılıyor.</td>
</tr>
<tr>
<td><strong>Evet / Hayır</strong></td>
<td>Gönderilen her istek ile REQUEST_HEADER objesinde ki <code class="prettyprint">SESSION_ID</code> ve <code class="prettyprint">APPLICATION_NAME</code> alanları dolu gönderiliyor.</td>
</tr>
<tr>
<td><strong>Evet / Hayır</strong></td>
<td>Fatura numarası ataması müteselsilliği sağlıyor.</td>
</tr>
<tr>
<td><strong>Evet / Hayır</strong></td>
<td>Her türlü fatura senaryosuna göre fatura <strong>SendInvoice</strong> metodu kullanılarak gönderildi (TEMEL, TICARI, IHRACAT, YOLCUBERABERI,SGK)</td>
</tr>
<tr>
<td><strong>Evet / Hayır</strong></td>
<td>Her türlü fatura tipinden örnek fatura gönderildi. (Satış, Iade, Tevkifat, Özel Matrah vs)</td>
</tr>
<tr>
<td><strong>Evet / Hayır</strong></td>
<td>Özel entegratöre iletilen faturalar için muhasebe paketi/ERP&#39;de değişiklik yapılamıyor. Kayıt kitleniyor.</td>
</tr>
<tr>
<td><strong>Evet / Hayır</strong></td>
<td>Alıcı tarafında hata almış faturalar <strong>aynı fatura numarası ama farklı ETTN</strong> ile tekrar <strong>SendInvoice</strong> servisi kullanılarak gönderilebiliyor.</td>
</tr>
<tr>
<td><strong>Evet / Hayır</strong></td>
<td>7 günden geriye fatura düzenlenemiyor.</td>
</tr>
<tr>
<td><strong>Evet / Hayır</strong></td>
<td><strong>GetInvoice</strong> metodu kullanılarak yeni gelen bütün faturalar içerikleri ile beraber (XML) müşteri ortamına çekiliyor.</td>
</tr>
<tr>
<td><strong>Evet / Hayır</strong></td>
<td>Özel entegratörden fatura çekme özelliği ekranda bir butona değilde zamanlayıcı ile belirli aralıkta otomatik yapılıyorsa bu süre konfiguratif ve en az 15dk olarak belirlendi.</td>
</tr>
<tr>
<td><strong>Evet / Hayır</strong></td>
<td>Özel entegratörden fatura çekme ekranda bir buton ile kullanıcıya bırakıldıysa kullanıcı çok sık butona tıklasa bile 5 dakika da bir yapılıyor.</td>
</tr>
<tr>
<td><strong>Evet / Hayır</strong></td>
<td>Özel entegratörden <strong>GetInvoice</strong> metodu ile çekilen faturaların XMLleri (file sisteme veya veritabanına) kaydediliyor.</td>
</tr>
<tr>
<td><strong>Evet / Hayır</strong></td>
<td>Başarı ile kaydedilen faturalar için <strong>MarkInvoice</strong> kullanılarak alındı mesajı gönderildi.</td>
</tr>
<tr>
<td><strong>Evet / Hayır</strong></td>
<td>Alınan bütün faturalar için toplu alındı mesajı gönderilmek için <strong>GetInvoice</strong> metodu ile dönülen INVOICE listesi <strong>MarkInvoice</strong> metoduna parametre olarak gönderiliyorsa fatura içeriğinin (Base64Binary) bulunduğu <code class="prettyprint">INVOICE.CONTENT</code> alanı boşaltılıyor. Böylece network trafik oluşturulması önleniyor.</td>
</tr>
<tr>
<td><strong>Evet / Hayır</strong></td>
<td>Faturaların durumu zamanlayıcı ile otomatik sorgulanıyorsa bu süre konfiguratif ve en az 4 saat olarak belirlendi.</td>
</tr>
<tr>
<td><strong>Evet / Hayır</strong></td>
<td>Nihai duruma ulaşmış <strong>giden</strong> faturaların (GetInvoiceStatus servisi ile dönülen SUBSTATUS parametresinin değeri <code class="prettyprint">SUCCEED</code> veya <code class="prettyprint">FAILED</code> ise) durumları sorgulanmıyor.</td>
</tr>
<tr>
<td><strong>Evet / Hayır</strong></td>
<td><strong>Gelen</strong> temel faturaların durumları sorgulanmıyor.</td>
</tr>
<tr>
<td><strong>Evet / Hayır</strong></td>
<td><strong>Gelen</strong> ticari faturaların durumları yanıt verildikten sonra sorugulanmaya başlanıyor ve GetInvoiceStatus servisi ile dönülen STATUS parametresinin değeri <code class="prettyprint">SUCCEED</code> veya <code class="prettyprint">FAILED</code> olana kadar sorgulanıyor.</td>
</tr>
<tr>
<td><strong>Evet / Hayır</strong></td>
<td>Alıcı sisteme ulaştıktan sonra üzerinden <strong>8 gün geçmiş</strong> gelen veya giden faturaların durumları sorgulanmıyor.</td>
</tr>
<tr>
<td><strong>Evet / Hayır</strong></td>
<td>Nihai duruma ulaşmamış faturalar için durum sorgulaması <strong>GetInvoiceStatus</strong> metodu ile yapılıyor.</td>
</tr>
<tr>
<td><strong>Evet / Hayır</strong></td>
<td>Durum sorgulaması yapılacak fatura birden fazla ise <strong>GetInvoiceStatus</strong> metodunda <code class="prettyprint">UUID</code> parametresi çoklanarak tek bir istek ile yapılıyor. Yani her fatura için ayrı ayrı durum sorgulaması yapılmıyor.</td>
</tr>
<tr>
<td><strong>Evet / Hayır</strong></td>
<td>İhracat faturaların durumları sorgulanınca GTB numarası vs alınıp müşteriye gösteriliyor.</td>
</tr>
<tr>
<td><strong>Evet / Hayır</strong></td>
<td>Gelen temel fatura senaryosunda ki faturalara kabul veya ret yanıtı gönderilemiyor.</td>
</tr>
<tr>
<td><strong>Evet / Hayır</strong></td>
<td>Gelen ticari fatura senaryosunda ki faturalara kabul veya red yanıtı <strong>SendInvoiceResponseWithServerSign</strong> metodu ile gönderildi.</td>
</tr>
<tr>
<td><strong>Evet / Hayır</strong></td>
<td>Ret edilen ticari faturalar için red sebebi <strong>mutlaka</strong> gönderiliyor.</td>
</tr>
<tr>
<td><strong>Evet / Hayır</strong></td>
<td>Fatura görüntülemek için indirdilen fatura XML içerisinde ki XSLT ile transform edip HTML görüntüsünü oluşturuluyor.</td>
</tr>
<tr>
<td><strong>Evet / Hayır</strong></td>
<td>Kullanıcı uygulamayı kapattığında <strong>Kimlik Doğrulama (Authentication)</strong> webservisinde ki <strong>Logout</strong> metodu kullanarak oturum kapatıldı.</td>
</tr>
</tbody></table>

<h2 id="stemci-client-rnek-projeler">İstemci (client) Örnek Projeler</h2>

<p>E-Fatura entegrasyonu için sunucu taraflı programlama diline uygun farklı istemci(client) örnekleri sunar. Bu istemcilerden programlama yapmak istediğiniz dile uygun olanı seçip test bilgileri ile kullanmaya başlayabilirsiniz.</p>

<p><a href="/resource/client/izibiz-efatura-dotnet-client.zip" target="_blank"><img src="/images/icon_dotnet.png"/></a>
<a href="/resource/client/izibiz-php-client.zip" target="_blank"><img src="/images/icon_php.png"/></a>
<a href="/resource/client/izibiz-efatura-java-client.zip" target="_blank"><img src="/images/icon_java.png"/></a>


<h2 id="fatura-s-n-f-invoicetype-nas-l-retilir">Fatura Sınıfı (InvoiceType) Nasıl Üretilir ?</h2>

<p>.NET üzerinden XSD dosyasından sınıf üretmek için şu adımları uygulayınız:</p>

<ol>
<li>http://www.efatura.gov.tr/dosyalar/kilavuzlar/UBL-TR1.2.1_Paketi.zip adresinden paket indirilir.</li>
<li>İndirilen dosya unzip edilir.</li>
<li>.Net Framework yüklü olan bir bilgisayarda <strong>başlat&gt;Developer Command Prompt</strong> yazılır ve gelen seçenek tıklanarak komut dosyası açılır</li>
<li>2.maddedeki unzip yapılan dizine <strong>cd UNZIP_EDILEN_DIZIN</strong> olarak gidilir.</li>
<li>Gelen ekranda aşağıdaki komutu yapıştırıyoruz.<br>
<strong>xsd /c UBL-Invoice-2.1.xsd UBL-CommonExtensionComponents-2.1.xsd UBL-CommonBasicComponents-2.1.xsd UBL-UnqualifiedDataTypes-2.1.xsd UBL-CoreComponentParameters-2.1.xsd CCTS_CCT_SchemaModule-2.1.xsd UBL-CommonAggregateComponents-2.1.xsd</strong></li>
<li>Bu işlemin sonunda e-Fatura/E-Arşiv fatura oluşturmak için gerekli bütün sınıflar UBL-Invoice-2.1.cs dosyası içerisinde oluşturulacaktır.</li>
<li>Fatura <strong>InvoiceType</strong> sınıfı ile üretilmektedir.</li>
</ol>

<h2 id="ortak-kullan-lan-eleman">Ortak Kullanılan Eleman</h2>

<p>Her webservis isteğinde gönderilmesi beklen ortak elemandır (REQUEST_HEADER)</p>

<table><thead>
<tr>
<th>Parametre</th>
<th>Tip</th>
<th>Zorunluluk</th>
<th>Açıklama</th>
</tr>
</thead><tbody>
<tr>
<td><strong>SESSION_ID</strong></td>
<td>String</td>
<td><strong>Evet</strong></td>
<td>Login Metodunda sistem tarafında gönderilen SESSION_ID bilgisi. Sonraki tüm metod çağrılarında parametre olarak metoda geçmelidir.</td>
</tr>
<tr>
<td><strong>APPLICATION_NAME</strong></td>
<td>String</td>
<td><strong>Evet</strong></td>
<td>Metodu çağıran uygulamanın adı. Mutlaka uygulama adının yazılması gerekmektedir.</td>
</tr>
<tr>
<td><strong>CHANNEL_NAME</strong></td>
<td>String</td>
<td><strong>Evet</strong></td>
<td>Metodun çağrıldığı kanal adı.</td>
</tr>
<tr>
<td><strong>COMPRESSED</strong></td>
<td>String</td>
<td>Hayır</td>
<td>İçerikte taşınan bilginin ZIP formatında sıkıştırılmış mı gönderildiği/talep edildiği bilgisi. Belge gönderim ve belge okuma servislerinde gönderilen değere göre işlem yapılmaktadır.</td>
</tr>
<tr>
<td><strong>CLIENT_TXN_ID</strong></td>
<td>String</td>
<td>Hayır</td>
<td>İstemci uygulama tarafından işlem için üretilen işlem bilgisi (transaction id) varsa istek esnasında gönderilip, sonuçta alabileceğiniz bir değerdir. request/response eşleşmesi yapmak için kullanılabilir.</td>
</tr>
<tr>
<td><strong>INT_PARENT_TXN_ID</strong></td>
<td>String</td>
<td>Hayır</td>
<td>İstemci uygulamasında ana modül entitileri ile ilişkilendirelmek istenen ana transaction ID.</td>
</tr>
<tr>
<td><strong>ACTION_DATE</strong></td>
<td>String</td>
<td>Hayır</td>
<td>Metodun çağrılma tarihi</td>
</tr>
<tr>
<td><strong>CHANGE_INFO</strong></td>
<td>Array</td>
<td>Hayır</td>
<td>Bu eleman ile eğer verilerde bir değişiklik yapılacak ise o değişikliği ait bilgi.</td>
</tr>
<tr>
<td><strong>REASON</strong></td>
<td>String</td>
<td>Hayır</td>
<td>İşlem sebebi. Fatura gönderme, fatura alma vs.</td>
</tr>
<tr>
<td><strong>HOST_NAME</strong></td>
<td>String</td>
<td>Hayır</td>
<td>Metodu çağıran sunucunun host bilgisi.</td>
</tr>
<tr>
<td><strong>SIMULATION_FLAG</strong></td>
<td>String</td>
<td>Hayır</td>
<td>Metod çağrılır ancak arkadaki işlem yapılmaz.</td>
</tr>
</tbody></table>

<h2 id="fatura-g-nderme-sendinvoice">Fatura Gönderme (SendInvoice)</h2>

<ul>
<li>FATURA Entegrasyon Platformu üzerinden 1 yada daha fazla faturayı GIB (Gelir İdaresi Başkanlığı) EFATURA sistemine gönderir.</li>
<li>Bu işlemden sonra gönderilen faturaların durumları GetInvoiceStatus servisi ile kontrol edilmelidir.</li>
<li>Faturanın durumu GIB’de hatalı olduğu zaman bu servis ile faturayı aynı fatura numarası ve aynı ETTN ile tekrar gönderilebilir.</li>
<li>Fatura yüklenirken fatura şema ve şematron kontrolü ve tekillik kontrolünden geçirilir. Fatura XML içerisinde hata varsa sisteme yüklenmez. Fatura XML içerisinde ki sorun düzeltilerek tekrar gönderilmelidir.</li>
</ul>

<p>Servise gönderilmesi gereken parametreler şu şekildedir:</p>

<table><thead>
<tr>
<th>Parametre</th>
<th>Tip</th>
<th>Zorunluluk</th>
<th>Açıklama</th>
</tr>
</thead><tbody>
<tr>
<td><strong>REQUEST_HEADER.SESSION_ID</strong></td>
<td>String</td>
<td><strong>Evet</strong></td>
<td>Request Header objesi içerisinde bulunan SESSION_ID gönderilmelidir.</td>
</tr>
<tr>
<td><strong>REQUEST_HEADER.COMPRESSED</strong></td>
<td>String</td>
<td>Hayır</td>
<td>Binary Fatura içeriği sıkıştırılmış/sıkıştırılmamış bilgisi. Varsayılan değer Y olduğu için gönderilmediği durumda fatura sıkıştırılarak/ziplenerek gönderilmesi beklenmektedir. <strong>Faturayı XML olarak göndermek için mutlaka eleman eklenmeli ve N değeri gönderilmelidir.</strong></td>
</tr>
<tr>
<td><strong>SENDER</strong></td>
<td>String</td>
<td>Hayır</td>
<td>Faturayı gönderen tarafın vergi kimlik numarasını <code class="prettyprint">vkn</code> attribute içerisine, gönderici birim etiketini <code class="prettyprint">alias</code> attribute eklenmelidir. Eğer eleman gönderilmezse oturum açılan kullanıcının bağlı olduğu hesapta ki VKN ve gönderici birim etiketi kullanılacaktır. <strong>Sender elemanı gönderilmesini tavsiye ederiz.</strong></td>
</tr>
<tr>
<td><strong>RECEIVER</strong></td>
<td>String</td>
<td>Hayır</td>
<td>Faturanın alıcı tarafının vergi kimlik numarasını <code class="prettyprint">vkn</code> attribute içerisine, posta kutusu etiketini <code class="prettyprint">alias</code> attribute içerisine eklenmelidir. Eğer eleman gönderilmezse fatura içerisinde ki alıcı taraf (AccountingCustomerParty) içerisinde ki VKN ve o VKN için tanımlanmış herhangi bir posta kutusu etiketi kullanılacaktır. <strong>Receiver elemanı gönderilmesini tavsiye ederiz. Özellikle alıcı tarafından posta kutusu tercihi talep edilmişse bu eleman kullanılmalıdır.</strong></td>
</tr>
<tr>
<td><strong>INVOICE.CONTENT</strong></td>
<td>Array</td>
<td><strong>Evet</strong></td>
<td>Faturanın Base64Binary tipinde XML veya Ziplenmiş içeriği. Bir istek ile çoklu fatura gönderimi yapılabilir. <strong>Birden fazla fatura göndermek için INVOICE elemanı çoklanmalıdır.</strong></td>
</tr>
</tbody></table>

<p><br><br></p>

<p>Servisten dönen parametreler şu şekildedir:</p>

<table><thead>
<tr>
<th>Parametre</th>
<th>Tip</th>
<th>Açıklama</th>
</tr>
</thead><tbody>
<tr>
<td><strong>INT_TXN_ID</strong></td>
<td>String</td>
<td>Sunucuda işlemin gerçekleştirildiği transaction IDsi. Bu ID istemci tarafında kaydedilerek oluşabilecek hatalarda referans olarak destek ekibine iletilebilir.</td>
</tr>
<tr>
<td><strong>RETURN_CODE</strong></td>
<td>String</td>
<td>Başarılı durumlarda <code class="prettyprint">0</code> değeri döner. Başarısız olduğunda WS Fault objesi dönecektir.</td>
</tr>
<tr>
<td><strong>INVOICE_ID</strong></td>
<td>String</td>
<td>Fatura numarası e-arşiv platformunda atanmışsa atanan fatura numarası. Eğer fatura numarası dışarıdan atanmışsa gönderilen faturanın numarası.</td>
</tr>
</tbody></table>

<h2 id="taslak-fatura-y-kleme-loadinvoice">Taslak Fatura Yükleme (LoadInvoice)</h2>

<ul>
<li>FATURA Entegrasyon Platformu üzerinden 1 yada daha fazla faturayı E-Fatura sistemine yükler.</li>
<li>Eğer fatura numarası atanmışsa (16 hane ise) şema ve şematron kontrolünden geçirilir. Fatura numarası atanmamışsa şema ve şematron kontrolü yapılmaz.</li>
<li>Aynı faturanın tekrar yüklenmesine müsade edilir. Farklı kayıt oluşturulmaz. Oluşan kayıt yeni içerik ile güncellenir.</li>
</ul>

<p><br>
Servise gönderilmesi gereken parametreler şu şekildedir:</p>

<table><thead>
<tr>
<th>Parametre</th>
<th>Tip</th>
<th>Zorunluluk</th>
<th>Açıklama</th>
</tr>
</thead><tbody>
<tr>
<td><strong>REQUEST_HEADER</strong></td>
<td>ComplexType</td>
<td><strong>Evet</strong></td>
<td>Request Header objesi içerisinde <code class="prettyprint">SESSION_ID</code> ve <code class="prettyprint">APPLICATION_NAME</code> alanı zorunludur. Fatura sıkıştırılarak/ziplenerek gönderiliyorsa <code class="prettyprint">COMPRESSED</code> alanı gönderilmeyebilir veya <code class="prettyprint">Y</code> olarak gönderilebilir. <strong>Faturayı XML formatında sıkıştırılmadan yüklemek için mutlaka <code class="prettyprint">COMPRESSED</code> eleman eklenmeli ve <code class="prettyprint">N</code> değeri gönderilmelidir.</strong></td>
</tr>
<tr>
<td><strong>INVOICE.CONTENT</strong></td>
<td>Array</td>
<td><strong>Evet</strong></td>
<td>Faturanın Base64Binary olarak encode edilmiş XML veya Ziplenmiş içeriği. Bir istek ile çoklu fatura gönderimi yapılabilir. <strong>Birden fazla fatura göndermek için INVOICE elemanı çoklanmalıdır.</strong></td>
</tr>
</tbody></table>

<p><br><br></p>

<p>Servisten dönen parametreler şu şekildedir:</p>

<table><thead>
<tr>
<th>Parametre</th>
<th>Tip</th>
<th>Açıklama</th>
</tr>
</thead><tbody>
<tr>
<td><strong>TXN_ID</strong></td>
<td>String</td>
<td>Sunucuda işlemin gerçekleştirildiği transaction IDsi. Bu ID istemci tarafında kaydedilerek oluşabilecek hatalarda referans olarak destek ekibine iletilebilir.</td>
</tr>
<tr>
<td><strong>RETURN_CODE</strong></td>
<td>String</td>
<td>Başarılı durumlarda 0 değeri döner. Başarısız olduğunda WS Fault objesi dönecektir.</td>
</tr>
</tbody></table>

<h2 id="e-fatura-okuma-getinvoice">E-Fatura Okuma (GetInvoice)</h2>

<ul>
<li>E-Fatura sisteminden giden imzalı faturaları veya gelen faturaları muhasebe paketine çekmek için kullanılır.</li>
<li>Fatura özet bilgilerini veya fatura özet bilgileri ile beraber XML içeriğini de çekmek için kullanılabilir.</li>
<li>Entegrasyon yapan iş ortaklarımızdan yeni gelen bütün faturaları içerikleri (XML) beraber müşteri ortamına çekilmesini tavsiye ediyoruz.</li>
<li>İçerik ile beraber en fazla 100 fatura çekilebilir.</li>
<li>Fatura özet bilgileri ile en fazla 25000 adet fatura dönülmektedir.</li>
<li>Alıcı tarafından zamanlanmış fatura çekme özelliği eklenecekse en fazla 15 dakika aralığında olmalıdır.</li>
</ul>

<p><br>
Servise gönderilmesi gereken parametreler şu şekildedir:</p>

<table><thead>
<tr>
<th>Parametre</th>
<th>Tip</th>
<th>Zorunluluk</th>
<th>Açıklama</th>
</tr>
</thead><tbody>
<tr>
<td><strong>REQUEST_HEADER</strong></td>
<td>ComplexType</td>
<td><strong>Evet</strong></td>
<td>Request Header objesi içerisinde <code class="prettyprint">SESSION_ID</code> ve <code class="prettyprint">APPLICATION_NAME</code> alanı zorunludur. Faturaları XML formatında sıkıştırılmadan çekmek için mutlaka <code class="prettyprint">COMPRESSED</code> elemanı eklenmeli ve <code class="prettyprint">N</code> değeri gönderilmelidir. Eğer gönderilmezse faturalar sıkıştırılmış/ziplenmiş olarak dönülecektir. Değerler: Y/N</td>
</tr>
<tr>
<td><strong>SEARCH_KEY.LIMIT</strong></td>
<td>String</td>
<td>Hayır</td>
<td>Kaç fatura okunmak istendiği. Eğer eleman gönderilmezse 10 adet fatura, fatura içerikleri (XML) ile beraber en fazla 100 adet fatura, sadece fatura başlıklarını çekildiğindeise en fazla 25.000 adet fatura dönülür.</td>
</tr>
<tr>
<td><strong>SEARCH_KEY.FROM</strong></td>
<td>String</td>
<td>Hayır</td>
<td>Gönderici firma gönderici birim (GB) etiketine göre çekmek için kullanılabilir. Örneğin birden fazla GB etiketi olan bir firmanın sadece muhasebe departmanından gelen faturaları okumak için kullanılabilir. format: urn:mail:muhasebegb@firma.com</td>
</tr>
<tr>
<td><strong>SEARCH_KEY.TO</strong></td>
<td>String</td>
<td>Hayır</td>
<td>Birden fazla Posta Kutusu (PK) etiketi olan bir firmanın sadece bir PK adresine gelen faturaları çekmek için kullanılabilir. Eğer etiket gönderilmez ise kullanıcının yetkisine bağlı olarak bütün faturalar dönülür. format: urn:mail:muhasebepk@firma.com</td>
</tr>
<tr>
<td><strong>SEARCH_KEY.ID</strong></td>
<td>String</td>
<td>Hayır</td>
<td>Fatura numarası ile fatura okumak için kullanılabilir. format: FYA2018000000001</td>
</tr>
<tr>
<td><strong>SEARCH_KEY.UUID</strong></td>
<td>String</td>
<td>Hayır</td>
<td>Evrensel Tekil Tanımlama Numarası (ETTN) ile fatura okumak için kullanılabilir.  GUID formatında</td>
</tr>
<tr>
<td><strong>SEARCH_KEY.START_DATE</strong></td>
<td>String</td>
<td>Hayır</td>
<td>Belirli tarih aralığında fatura çekmek istendiğinde dönem başlangıç tarihi format: YYYY-MM-DD</td>
</tr>
<tr>
<td><strong>SEARCH_KEY.END_DATE</strong></td>
<td>String</td>
<td>Hayır</td>
<td>Belirli tarih aralığında fatura çekmek istendiğinde dönem bitiş tarihi format: YYYY-MM-DD</td>
</tr>
<tr>
<td><strong>SEARCH_KEY.READ_INCLUDED</strong></td>
<td>Boolean</td>
<td>Hayır</td>
<td>Fatura okurken daha önce okunmuş faturaları dönüşe dahil edilip edilmeyeceğini belirler. <code class="prettyprint">true</code> değeri gönderilirse fatura daha önce okunmuş olsa bile yanıta eklenir. Gönderilmezse veya <code class="prettyprint">false</code> gönderilirse sadece yeni gelen faturalar dönülür. Değerler: true/false</td>
</tr>
<tr>
<td><strong>SEARCH_KEY.DRAFT_FLAG</strong></td>
<td>String</td>
<td>Hayır</td>
<td>Taslak faturaları sonuca eklenmesi için kullanılan parametredir. <code class="prettyprint">Y</code> değeri gönderilirse taslak faturalar diğer kriterlere uyan faturalarla beraber sonuca eklenir. Parametre gönderilmezse veya <code class="prettyprint">N</code> gönderilirse taslak faturalar sonuca eklenmez. Değerler: Y/N</td>
</tr>
<tr>
<td><strong>SEARCH_KEY.DIRECTION</strong></td>
<td>String</td>
<td>Hayır</td>
<td>Belge yönü. Gelen veya Giden faturaları çekmek için kullanılabilir. Gelen faturaları çekmek için <code class="prettyprint">IN</code>, giden faturaları çekmek için <code class="prettyprint">OUT</code> değeri gönderilebilir. Varsayılan değer <code class="prettyprint">IN</code> olduğu için eğer parametre gönderilmezse sadece gelen faturalar dönülecektir.  Gönderilebilecek değerler: <code class="prettyprint">IN</code>, <code class="prettyprint">OUT</code></td>
</tr>
<tr>
<td><strong>HEADER_ONLY</strong></td>
<td>String</td>
<td>Hayır</td>
<td>Fatura içerik ile beraber mi yoksa sadece özet bilgisi mi okunmak istenildiğini belirler. Eleman <strong>gönderilmezse</strong> veya <code class="prettyprint">N</code> değeri gönderilirse faturalar XML ile beraber dönülür. <code class="prettyprint">Y</code> değeri gönderilirse faturaların özeti dönülür.  Değerler: Y/N</td>
</tr>
</tbody></table>

<p><br><br></p>

<p>Servisten dönen parametreler şu şekildedir:</p>

<table><thead>
<tr>
<th>Parametre</th>
<th>Tip</th>
<th>Açıklama</th>
</tr>
</thead><tbody>
<tr>
<td><strong>INVOICE</strong></td>
<td>ComplexType</td>
<td>Sorgu kriterine uyan fatura(lar)ın listesi. Fatura numarası <code class="prettyprint">ID</code>, fatura evrensel tekil tanımlama numarası  <code class="prettyprint">UUID</code> ve e-fatura sisteminde tanımlı tekil numara değeri  <code class="prettyprint">LIST_ID</code> attribute içerisinde dönülmektedir.</td>
</tr>
<tr>
<td><strong>INVOICE.HEADER</strong></td>
<td>ComplexType</td>
<td>Faturaya ait özet bilgiler içermektedir.</td>
</tr>
<tr>
<td><strong>HEADER.SENDER</strong></td>
<td>String</td>
<td>Faturayı gönderen firma VKN&#39;si.</td>
</tr>
<tr>
<td><strong>HEADER.RECEIVER</strong></td>
<td>String</td>
<td>Faturayı alan firma VKN&#39;si.</td>
</tr>
<tr>
<td><strong>HEADER.SUPPLIER</strong></td>
<td>String</td>
<td>Faturayı gönderen firma ünvanı.</td>
</tr>
<tr>
<td><strong>HEADER.CUSTOMER</strong></td>
<td>String</td>
<td>Faturayı alan firma ünvanı.</td>
</tr>
<tr>
<td><strong>HEADER.ISSUE_DATE</strong></td>
<td>String</td>
<td>Fatura tarihi.</td>
</tr>
<tr>
<td><strong>HEADER.PAYABLE_AMOUNT</strong></td>
<td>String</td>
<td>Toplam ödenecek tutar.</td>
</tr>
<tr>
<td><strong>HEADER.FROM</strong></td>
<td>String</td>
<td>Faturayı gönderen Gönderici Birim (GB)</td>
</tr>
<tr>
<td><strong>HEADER.TO</strong></td>
<td>String</td>
<td>Faturanın geldiği Posta Kutusu (PK)</td>
</tr>
<tr>
<td><strong>HEADER.PROFILEID</strong></td>
<td>String</td>
<td>Faturanın senaryosu. TEMELFATURA, TICARIFATURA,IHRACATFATURA, YOLCUBERABER değerleri olabilir.</td>
</tr>
<tr>
<td><strong>HEADER.INVOICE_TYPE_CODE</strong></td>
<td>String</td>
<td>Faturanın tipi. SATIS, IADE, ISTISNA, IHRACAT, OZELMATRAH, TEVKIFAT, IHRACKAYITLI değerleri olabilir.</td>
</tr>
<tr>
<td><strong>HEADER.STATUS</strong></td>
<td>String</td>
<td>Faturanın durumu. Detay için Fatura durum sorgulama ekranında bulunan <strong>Fatura Durumları</strong> başlığını inceleyiniz.</td>
</tr>
<tr>
<td><strong>HEADER.STATUS_DESCRIPTION</strong></td>
<td>String</td>
<td>Fatura durum açıklaması. Detay için Fatura durum sorgulama ekranında bulunan <strong>Fatura Durumları</strong> başlığını inceleyiniz.</td>
</tr>
<tr>
<td><strong>HEADER.GIB_STATUS_CODE</strong></td>
<td>String</td>
<td>Faturanın GİB&#39;de ki durum kodu. Detay için Fatura durum sorgulama ekranında bulunan <strong>GİB Durum Kodları</strong> başlığını inceleyiniz.</td>
</tr>
<tr>
<td><strong>HEADER.GIB_STATUS_DESCRIPTION</strong></td>
<td>String</td>
<td>Faturanın GİB&#39;de ki durumunun kodunun açıklaması. Detay için <strong>GİB Durum Kodları</strong> başlığını inceleyiniz.</td>
</tr>
<tr>
<td><strong>HEADER.RESPONSE_CODE</strong></td>
<td>String</td>
<td>Ticari fatura için verilen yanıtı içeren zarfın durum kodu</td>
</tr>
<tr>
<td><strong>HEADER.RESPONSE_DESC</strong></td>
<td>String</td>
<td>Ticari fatura için verilen yanıtı içeren zarfın durum açıklaması</td>
</tr>
<tr>
<td><strong>HEADER.CDATE</strong></td>
<td>String</td>
<td>Faturanın sistemimize ulaştığı tarih</td>
</tr>
<tr>
<td><strong>HEADER.ENVELOPE_IDENTIFIER</strong></td>
<td>String</td>
<td>Faturanın zarf IDsi.</td>
</tr>
<tr>
<td><strong>INVOICE.CONTENT</strong></td>
<td>String</td>
<td>Faturanın içeriği. Eğer <code class="prettyprint">COMPRESSED</code> elemanı <code class="prettyprint">N</code> olarak gönderilmişse XML dosya, <code class="prettyprint">COMPRESSED</code> elemanı gönderilmemiş veya <code class="prettyprint">Y</code> değeri gönderilmişse sıkıştırılmış/ziplenmiş XML dosyası dönülür.</td>
</tr>
</tbody></table>

<h2 id="fatura-g-rsel-okuma-getinvoicewithtype">Fatura Görsel Okuma (GetInvoiceWithType)</h2>

<ul>
<li>E-Fatura sisteminden bulunan bir faturanın görselini çekmek için tasarlanmış servistir.</li>
<li>Faturaların HTML ve PDF görsellerini çekebilirsiniz.</li>
<li>Fatura görseli içerisinde ki XSLT ile yapılacaktır. Eğer fatura içerisinde ki şablonda sorun varsa hata fırlatılacaktır.</li>
<li>İçerik sıkıştırılmış olarak dönülmektedir. İstemciye çektikten sonra unzip edilmelidir.</li>
</ul>

<p><br>
Servise gönderilmesi gereken parametreler şu şekildedir:</p>

<table><thead>
<tr>
<th>Parametre</th>
<th>Tip</th>
<th>Zorunluluk</th>
<th>Açıklama</th>
</tr>
</thead><tbody>
<tr>
<td><strong>REQUEST_HEADER</strong></td>
<td>ComplexType</td>
<td><strong>Evet</strong></td>
<td>Request Header objesi içerisinde <code class="prettyprint">SESSION_ID</code> ve <code class="prettyprint">APPLICATION_NAME</code> alanı zorunludur. <strong>Bu serviste <code class="prettyprint">COMPRESSED</code> elemanı dikkate alınmamaktadır.</strong>   Talep edilen formatta sıkıştırılmış/ziplenmiş olarak dönülecektir. İstemciye çektikten sonra unzip edilmelidir.</td>
</tr>
<tr>
<td><strong>SEARCH_KEY.ID</strong></td>
<td>String</td>
<td>Hayır</td>
<td>Fatura numarası ile fatura okumak için kullanılabilir. örnek FYA2018000000001 <code class="prettyprint">UUID</code> elamanı gönderilmemişse zorunludur.</td>
</tr>
<tr>
<td><strong>SEARCH_KEY.UUID</strong></td>
<td>String</td>
<td>Hayır</td>
<td>Fatura Evrensel Tekil Tanımlama Numarası (ETTN) ile fatura okumak için kullanılabilir. <code class="prettyprint">ID</code> elamanı gönderilmemişse zorunludur.</td>
</tr>
<tr>
<td><strong>SEARCH_KEY.TYPE</strong></td>
<td>String</td>
<td><strong>Evet</strong></td>
<td>Faturanın çekilmek istenilen tipi: PDF, HTML, XML olabilir.</td>
</tr>
<tr>
<td><strong>SEARCH_KEY.DIRECTION</strong></td>
<td>String</td>
<td><strong>Evet</strong></td>
<td>Belge yönü. Gelen veya Giden faturaları çekmek için kullanılabilir. Gelen faturaları çekmek için <code class="prettyprint">IN</code>, giden faturaları çekmek için <code class="prettyprint">OUT</code> değeri gönderilebilir. Varsayılan değer <code class="prettyprint">IN</code> olduğu için eğer parametre gönderilmezse sadece gelen faturalar dönülecektir.  Gönderilebilecek değerler: <code class="prettyprint">IN</code>, <code class="prettyprint">OUT</code></td>
</tr>
<tr>
<td><strong>HEADER_ONLY</strong></td>
<td>String</td>
<td><strong>Evet</strong></td>
<td>Fatura görseli çekmek için <code class="prettyprint">N</code> gönderilmelidir.</td>
</tr>
</tbody></table>

<p><br><br></p>

<p>Servisten dönen parametreler şu şekildedir:</p>

<table><thead>
<tr>
<th>Parametre</th>
<th>Tip</th>
<th>Açıklama</th>
</tr>
</thead><tbody>
<tr>
<td><strong>INVOICE</strong></td>
<td>ComplexType</td>
<td>Sorgu kriterine uyan fatura(lar)ın listesi. Fatura numarası <code class="prettyprint">ID</code>, fatura evrensel tekil tanımlama numarası  <code class="prettyprint">UUID</code> ve e-fatura sisteminde tanımlı tekil numara değeri  <code class="prettyprint">LIST_ID</code> attribute içerisinde dönülmektedir.</td>
</tr>
<tr>
<td><strong>INVOICE.HEADER</strong></td>
<td>ComplexType</td>
<td>Faturaya ait özet bilgiler içermektedir.</td>
</tr>
<tr>
<td><strong>HEADER.SENDER</strong></td>
<td>String</td>
<td>Faturayı gönderen firma VKN&#39;si.</td>
</tr>
<tr>
<td><strong>HEADER.RECEIVER</strong></td>
<td>String</td>
<td>Faturayı alan firma VKN&#39;si.</td>
</tr>
<tr>
<td><strong>HEADER.SUPPLIER</strong></td>
<td>String</td>
<td>Faturayı gönderen firma ünvanı.</td>
</tr>
<tr>
<td><strong>HEADER.CUSTOMER</strong></td>
<td>String</td>
<td>Faturayı alan firma ünvanı.</td>
</tr>
<tr>
<td><strong>HEADER.ISSUE_DATE</strong></td>
<td>String</td>
<td>Fatura tarihi.</td>
</tr>
<tr>
<td><strong>HEADER.PAYABLE_AMOUNT</strong></td>
<td>String</td>
<td>Toplam ödenecek tutar.</td>
</tr>
<tr>
<td><strong>HEADER.FROM</strong></td>
<td>String</td>
<td>Faturayı gönderen Gönderici Birim (GB)</td>
</tr>
<tr>
<td><strong>HEADER.TO</strong></td>
<td>String</td>
<td>Faturanın geldiği Posta Kutusu (PK)</td>
</tr>
<tr>
<td><strong>HEADER.PROFILEID</strong></td>
<td>String</td>
<td>Faturanın senaryosu. TEMELFATURA, TICARIFATURA,IHRACATFATURA, YOLCUBERABER değerleri olabilir.</td>
</tr>
<tr>
<td><strong>HEADER.INVOICE_TYPE_CODE</strong></td>
<td>String</td>
<td>Faturanın tipi. SATIS, IADE, ISTISNA, IHRACAT, OZELMATRAH, TEVKIFAT, IHRACKAYITLI değerleri olabilir.</td>
</tr>
<tr>
<td><strong>HEADER.STATUS</strong></td>
<td>String</td>
<td>Faturanın durumu. Detay için <strong>Fatura Durumları</strong> başlığını inceleyiniz.</td>
</tr>
<tr>
<td><strong>HEADER.STATUS_DESCRIPTION</strong></td>
<td>String</td>
<td>Fatura durum açıklaması. Detay için <strong>Fatura Durumları</strong> başlığını inceleyiniz.</td>
</tr>
<tr>
<td><strong>HEADER.GIB_STATUS_CODE</strong></td>
<td>String</td>
<td>Faturanın GİB&#39;de ki durum kodu. Detay için <strong>GİB Durum Kodları</strong> başlığını inceleyiniz.</td>
</tr>
<tr>
<td><strong>HEADER.GIB_STATUS_DESCRIPTION</strong></td>
<td>String</td>
<td>Faturanın GİB&#39;de ki durumunun kodunun açıklaması. Detay için <strong>GİB Durum Kodları</strong> başlığını inceleyiniz.</td>
</tr>
<tr>
<td><strong>HEADER.RESPONSE_CODE</strong></td>
<td>String</td>
<td>Ticari fatura için verilen yanıtı içeren zarfın durum kodu</td>
</tr>
<tr>
<td><strong>HEADER.RESPONSE_DESC</strong></td>
<td>String</td>
<td>Ticari fatura için verilen yanıtı içeren zarfın durum açıklaması</td>
</tr>
<tr>
<td><strong>HEADER.CDATE</strong></td>
<td>String</td>
<td>Faturanın sistemimize ulaştığı tarih</td>
</tr>
<tr>
<td><strong>HEADER.ENVELOPE_IDENTIFIER</strong></td>
<td>String</td>
<td>Faturanın zarf IDsi.</td>
</tr>
<tr>
<td><strong>INVOICE.CONTENT</strong></td>
<td>Base64Binary</td>
<td>Faturanın talep edilen formatta <strong>(PDF, HTML)</strong> sıkıştırılmış/ziplenmiş dosyası dönülür. <strong>İstemciye çektikten sonra unzip edilmeldir.</strong></td>
</tr>
</tbody></table>

<h2 id="fatura-okundu-aretleme-markinvoice">Fatura Okundu İşaretleme (MarkInvoice)</h2>

<ul>
<li>E-Fatura sisteminde bir veya birden fazla faturayı alındı/alınmadı olarak işaretlemek için geliştirilmiş servistir.</li>
<li>GetInvoice servisi ile müşteri ortamına başarı alınan faturaların tekrar sorgulandığında listede gelmemesi için MarkInvoice servisi ile alındı olarak işaretlenmeli.</li>
</ul>

<p><br>
Servise gönderilmesi gereken parametreler şu şekildedir:</p>

<table><thead>
<tr>
<th>Parametre</th>
<th>Tip</th>
<th>Zorunluluk</th>
<th>Açıklama</th>
</tr>
</thead><tbody>
<tr>
<td><strong>REQUEST_HEADER</strong></td>
<td>ComplexType</td>
<td><strong>Evet</strong></td>
<td>Request Header objesi içerisinde <code class="prettyprint">SESSION_ID</code> ve <code class="prettyprint">APPLICATION_NAME</code> alanı zorunludur.</td>
</tr>
<tr>
<td><strong>MARK.value</strong></td>
<td>String</td>
<td>Hayır</td>
<td>Başarı ile alındıysa <code class="prettyprint">READ</code> gönderilmeli. Daha önce alındı olarak işaretlenen bir faturayı tekrar çekmeden önce <code class="prettyprint">UNREAD</code> olarak gönderilebilir.</td>
</tr>
<tr>
<td><strong>INVOICE.ID</strong></td>
<td>String</td>
<td>Hayır</td>
<td>İşaretlenecek faturanın numarası. Örnek: FYA2018000000001</td>
</tr>
<tr>
<td><strong>INVOICE.UUID</strong></td>
<td>String</td>
<td>Hayır</td>
<td>İşaretlenecek faturanın ETTNsi. GUID formatında olmalı.</td>
</tr>
</tbody></table>

<p><br><br></p>

<p>Servisten dönen parametreler şu şekildedir:</p>

<table><thead>
<tr>
<th>Parametre</th>
<th>Tip</th>
<th>Açıklama</th>
</tr>
</thead><tbody>
<tr>
<td><strong>TXN_ID</strong></td>
<td>String</td>
<td>Sunucuda işlemin gerçekleştirildiği transaction IDsi. Bu ID istemci tarafında kaydedilerek oluşabilecek hatalarda referans olarak destek ekibine iletilebilir.</td>
</tr>
<tr>
<td><strong>RETURN_CODE</strong></td>
<td>String</td>
<td>Başarılı durumlarda <code class="prettyprint">0</code> değeri döner. Başarısız olduğunda WS Fault objesi dönecektir.</td>
</tr>
</tbody></table>

<h2 id="fatura-durum-sorgulama-getinvoicestatus">Fatura Durum Sorgulama (GetInvoiceStatus)</h2>

<ul>
<li>E-Fatura sisteminde bulunan bir veya birden fazla taslak, gelen ve giden faturaların durumunu sorgulamayı sağlayan servistir.</li>
</ul>

<p><br>
Servise gönderilmesi gereken parametreler şu şekildedir:</p>

<table><thead>
<tr>
<th>Parametre</th>
<th>Tip</th>
<th>Zorunluluk</th>
<th>Açıklama</th>
</tr>
</thead><tbody>
<tr>
<td><strong>REQUEST_HEADER</strong></td>
<td>ComplexType</td>
<td><strong>Evet</strong></td>
<td>Request Header objesi içerisinde <code class="prettyprint">SESSION_ID</code> ve <code class="prettyprint">APPLICATION_NAME</code> alanı zorunludur.</td>
</tr>
<tr>
<td><strong>INVOICE.ID</strong></td>
<td>String</td>
<td>Hayır</td>
<td>Durumu sorgulanacak faturanın 16 hane fatura numarası. örnek: FYA2018000000001 <strong>Eğer UUID elemanı gönderilmezse zorunludur.</strong></td>
</tr>
<tr>
<td><strong>INVOICE.UUID</strong></td>
<td>String</td>
<td>Hayır</td>
<td>Durumu sorgulanacak faturanın GUID formatında Evrensel Tekil Tanımlama Numarası. <strong>Eğer ID elemanı gönderilmezse zorunludur.</strong></td>
</tr>
</tbody></table>

<p><br><br></p>

<p>Servisten dönen parametreler şu şekildedir:</p>

<table><thead>
<tr>
<th>Parametre</th>
<th>Tip</th>
<th>Açıklama</th>
</tr>
</thead><tbody>
<tr>
<td><strong>INVOICE_STATUS</strong></td>
<td>ComplexType</td>
<td>Sorgu kriterine uyan fatura(lar)ın listesi. Fatura numarası <code class="prettyprint">ID</code>, fatura evrensel tekil tanımlama numarası  <code class="prettyprint">UUID</code> attribute içerisinde dönülmektedir.</td>
</tr>
<tr>
<td><strong>INVOICE_STATUS.STATUS</strong></td>
<td>String</td>
<td>Faturanın e-fatura sisteminde ki durumu. Detay için <strong>Fatura Durumları</strong> başlığını inceleyiniz.</td>
</tr>
<tr>
<td><strong>INVOICE_STATUS.STATUS_DESCRIPTION</strong></td>
<td>String</td>
<td>Fatura durum açıklaması. Detay için <strong>Fatura Durumları</strong> başlığını inceleyiniz.</td>
</tr>
<tr>
<td><strong>INVOICE_STATUS.GIB_STATUS_CODE</strong></td>
<td>String</td>
<td>Faturanın GİB&#39;de ki durum kodu. Faturanın GİB&#39;de ki durumu e-fatura sistemi tarafından henüz sorgulanmadıysa eleman dönülmez. Detay için <strong>GİB Durum Kodları</strong> başlığını inceleyiniz.</td>
</tr>
<tr>
<td><strong>INVOICE_STATUS.GIB_STATUS_DESCRIPTION</strong></td>
<td>String</td>
<td>Faturanın GİB&#39;de ki durumunun kodunun açıklaması. Faturanın GİB&#39;de ki durumu e-fatura sistemi tarafından henüz sorgulanmadıysa eleman dönülmez. Detay için <strong>GİB Durum Kodları</strong> başlığını inceleyiniz.</td>
</tr>
<tr>
<td><strong>INVOICE_STATUS.RESPONSE_CODE</strong></td>
<td>String</td>
<td>Ticari fatura için verilen yanıtı içeren zarfın durum kodu. Eğer faturanın senaryosu TICARIFATURA değilse eleman dönülmez.</td>
</tr>
<tr>
<td><strong>INVOICE_STATUS.RESPONSE_DESC</strong></td>
<td>String</td>
<td>Ticari fatura için verilen yanıtı içeren zarfın durum açıklaması. Eğer faturanın senaryosu TICARIFATURA değilse eleman dönülmez.</td>
</tr>
<tr>
<td><strong>INVOICE_STATUS.GTB_REFNO</strong></td>
<td>String</td>
<td>Gümrük Sistemine alınan ihracat faturaları için, Gümrük ve Ticaret Bakanlığı tarafından üretilen 23 haneli bir referans numarasıdır.  23 haneli bir referans numarası ile belge tarihi yükümlü tarafından gümrük beyannamesinin 44 no’lu kutusunda “Belge Referans No” ve “Belge Tarihi” alanlarında beyan edilecektir. <strong>İhracat faturası değilse dönülmez.</strong></td>
</tr>
<tr>
<td><strong>INVOICE_STATUS.GTB_GCB_TESCILNO</strong></td>
<td>String</td>
<td>Gümrük İdaresi fiili ihracatı tamamlanan eşyanın kabul uygulama yanıtı ile ilgilisine dönülen Gümrük Çıkış Belgesi (GÇB) tescil numarasıdır. <strong>İhracat faturası değilse dönülmez.</strong></td>
</tr>
<tr>
<td><strong>INVOICE_STATUS.GTB_FIILI_IHRACAT_TARIHI</strong></td>
<td>String</td>
<td>Gümrük İdaresi tarafından fiili ihracatı tamamlanan ihracat faturaları için döndüğü fiili ihraç tarihi bilgisidir.  Gümrük İdaresi bu bilgiyi fiili ihracat (intaç) gerçekleştiğinde dönecektir. Eğer ihracat faturası için bu alan dönülmemişse hala fiili ihracat yapılmamıştır. <strong>İhracat faturası değilse dönülmez.</strong></td>
</tr>
<tr>
<td><strong>INVOICE_STATUS.CDATE</strong></td>
<td>String</td>
<td>Faturanın e-fatura sistemine yüklendiği/ulaştığı tarih</td>
</tr>
<tr>
<td><strong>INVOICE_STATUS.ENVELOPE_IDENTIFIER</strong></td>
<td>String</td>
<td>Faturanın zarf IDsi. Taslak faturalar için eleman dönülmez.</td>
</tr>
</tbody></table>

<h3 id="fatura-durumlar">Fatura Durumları</h3>

<table><thead>
<tr>
<th>AŞAMA</th>
<th>AÇIKLAMA</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">Ara Aşama</code></td>
<td>Faturanın veya uygulama yanıtının alıcısına ulaştırılmak için geçen aşamanın tamamlanmadığı durumdur. Ara Aşamada ki faturalar üzerinde işlem yapılmamalı ve sürecin tamamlanması beklenmelidir.</td>
</tr>
<tr>
<td><code class="prettyprint">Nihai Aşama</code></td>
<td>Faturanın veya uygulama yanıtının alıcısına ulaştırılma süreci tamamlanmıştır. Nihai Aşamada ki faturanın başarılı mı yoksa başarısız mı tamamlandığı kontrol edilerek gerekli aksiyon alınmalıdır. <strong>Nihai Aşama faturanın başarılı olduğu anlamına gelmez.</strong></td>
</tr>
</tbody></table>

<h3 id="gelen-fatura-durumlar">Gelen Fatura Durumları</h3>

<table><thead>
<tr>
<th>STATUS</th>
<th>SUBSTATUS</th>
<th>PORTAL STATUS</th>
<th>Detaylı Açıklama</th>
<th>Aşama Durumu</th>
</tr>
</thead><tbody>
<tr>
<td>RECEIVE</td>
<td>SUCCEED</td>
<td>Fatura Alımı - Başarıyla işlendi</td>
<td>Temel Fatura Alımı Başarılı</td>
<td>Nihai Aşama</td>
</tr>
<tr>
<td>RECEIVE</td>
<td>WAIT_APPLICATION_RESPONSE</td>
<td>Fatura Alımı - Fatura Onayı Bekleniyor</td>
<td>Ticari Faatura Alımı Başarılı</td>
<td>Ara Aşama</td>
</tr>
<tr>
<td>ACCEPT</td>
<td>PROCESSING</td>
<td>Gelen Ticari Fatura Kabul – İşleniyor</td>
<td>Gelen Ticari Fatura Kabul Edilmiştir  ve kabul yanıtı GİB’e gönderilmek üzere işlenmektedir.  Hala GİB’e gönderilmemiştir.</td>
<td>Ara aşama</td>
</tr>
<tr>
<td>ACCEPT</td>
<td>WAIT_GIB_RESPONSE</td>
<td>Gelen Ticari Fatura Kabul – GIB&#39;e Gönderildi</td>
<td>Gelen Ticari Fatura Kabul Edilmiştir  ve kabul yanıtı GIB’e gönderildi.  GIB den onayın alındığına dair sistem yanıtı bekleniyor.</td>
<td>Ara aşama</td>
</tr>
<tr>
<td>ACCEPT</td>
<td>WAIT_SYSTEM_RESPONSE</td>
<td>Gelen Ticari Fatura Kabul – Sistem Yanıtı Bekleniyor</td>
<td>Fatura onayı GIB tarafından alıcısına gönderildi ve alıcı taraftan onayın alındığına dair sistem yanıtı bekleniyor</td>
<td>Ara aşama</td>
</tr>
<tr>
<td>ACCEPT</td>
<td>FAILED</td>
<td>Gelen Ticari Fatura Kabul - Başarısız oldu</td>
<td>Onaylanan Ticari fatura cevabı gönderiminden hata oluştu.  Bu fatura tekrar onaylanabilir.</td>
<td>Nihai Aşama</td>
</tr>
<tr>
<td>ACCEPT</td>
<td>SUCCEED</td>
<td>Gelen Ticari Fatura Kabul - Başarıyla işlendi</td>
<td>Gelen Ticari Fatura Kabul Edilmiştir  ve kabul yanıtı göndericiye başarılı bir şekilde ulaştırılmıştır.</td>
<td>Nihai Aşama</td>
</tr>
<tr>
<td>REJECT</td>
<td>PROCESSING</td>
<td>Gelen Ticari Fatura Red – İşleniyor</td>
<td>Gelen Ticari Fatura Red Edilmiştir  ve red yanıtı GİB’e gönderilmek üzere işlenmektedir.  Hala GİB’e gönderilmemiştir.</td>
<td>Ara aşama</td>
</tr>
<tr>
<td>REJECT</td>
<td>WAIT_GIB_RESPONSE</td>
<td>Gelen Ticari Fatura Red – GIB&#39;e Gönderildi</td>
<td>Gelen Ticari Fatura reddedilmiştir  ve red yanıtı GIB’e gönderildi.  GIB den onayın alındığına dair sistem yanıtı bekleniyor.</td>
<td>Ara aşama</td>
</tr>
<tr>
<td>REJECT</td>
<td>WAIT_SYSTEM_RESPONSE</td>
<td>Gelen Ticari Fatura Red – Sistem Yanıtı Bekleniyor</td>
<td>Fatura onayı GIB tarafından alıcısına gönderildi ve alıcı taraftan onayın alındığına dair sistem yanıtı bekleniyor</td>
<td>Ara aşama</td>
</tr>
<tr>
<td>REJECT</td>
<td>SUCCEED</td>
<td>Gelen Ticari Fatura Red - Başarıyla işlendi</td>
<td>Gelen Ticari Fatura Red Edilmiştir  ve red yanıtı göndericiye başarılı bir şekilde ulaştırılmıştır.</td>
<td>Nihai Aşama</td>
</tr>
<tr>
<td>REJECT</td>
<td>FAILED</td>
<td>Gelen Ticari Fatura Red - Başarısız oldu</td>
<td>Gelen Ticari Fatura Red Edilmiştir  ve red yanıtı GİB’de veya alıcı tarafında oluşan bir sebeple hatalı duruma ulaşmıştır.</td>
<td>Nihai Aşama</td>
</tr>
</tbody></table>

<h3 id="giden-fatura-durumlar">Giden Fatura Durumları</h3>

<table><thead>
<tr>
<th>STATUS</th>
<th>SUBSTATUS</th>
<th>PORTAL STATUS</th>
<th>Detaylı Açıklama</th>
<th>Aşama Durumu</th>
</tr>
</thead><tbody>
<tr>
<td>LOAD</td>
<td>SUCCEED</td>
<td>Fatura Yükleme - Başarılı</td>
<td>Fatura Yükleme Başarılı. Taslak olarak sisteme yüklenmiş faturadır.</td>
<td>Nihai Aşama</td>
</tr>
<tr>
<td>LOAD</td>
<td>FAILED</td>
<td>Fatura Yükleme - Başarısız Oldu</td>
<td>Fatura Yükleme Hatalı</td>
<td>Nihai Aşama</td>
</tr>
<tr>
<td>PACKAGE</td>
<td>FAILED</td>
<td>Fatura Paketleme - Başarısız oldu</td>
<td>Fatura paketleme sırasında hata oluştu.  Sistem tarafından tekrar paketle işlemi yapılarak gönderilecektir.</td>
<td>Ara aşama</td>
</tr>
<tr>
<td>PACKAGE</td>
<td>SUCCEED</td>
<td>Fatura Paketleme - Başarıyla işlendi</td>
<td>Fatura paketleme başarılı</td>
<td>Ara aşama</td>
</tr>
<tr>
<td>SEND</td>
<td>PROCESSING</td>
<td>Fatura Gönderimi - İşleniyor</td>
<td>Fatura Gönderimi Yapılıyor</td>
<td>Ara aşama</td>
</tr>
<tr>
<td>SEND</td>
<td>SUCCEED</td>
<td>Fatura Gönderimi - Başarıyla işlendi</td>
<td>Temel Fatura Gönderimi Başarılı</td>
<td>Nihai Aşama</td>
</tr>
<tr>
<td>SEND</td>
<td>FAILED</td>
<td>Fatura Gönderimi – Başarısız Oldu</td>
<td>Fatura Gönderiminde Hata Alındı</td>
<td>Nihai Aşama</td>
</tr>
<tr>
<td>SEND</td>
<td>WAIT_GIB_RESPONSE</td>
<td>Fatura Gönderimi - GIB&#39;e Gönderildi</td>
<td>Fatura GIB e gönderildi ve GIB den faturanın alındığına dair sistem yanıtı bekleniyor</td>
<td>Ara aşama</td>
</tr>
<tr>
<td>SEND</td>
<td>WAIT_SYSTEM_RESPONSE</td>
<td>Fatura Gönderimi - Sistem Yanıtı Bekleniyor</td>
<td>Fatura GIB tarafından alıcısına gönderildi ve alıcı taraftan faturanın alındığına dair sistem yanıtı bekleniyor</td>
<td>Ara aşama</td>
</tr>
<tr>
<td>SEND</td>
<td>WAIT_APPLICATION_RESPONSE</td>
<td>Fatura Gönderimi - Fatura Onayı Bekleniyor</td>
<td>Ticari Fatura Alıcıdan Cevap Bekliyor</td>
<td>Ara aşama</td>
</tr>
<tr>
<td>ACCEPTED</td>
<td>SUCCEED</td>
<td>Giden Ticari Fatura Kabul - Başarıyla işlendi</td>
<td>Gönderilmiş olan ticari fatura alıcı tarafından kabul edilmiştir ve alıcının kabul yanıtı gönderen tarafa başarılı şekilde ulaşmıştır.</td>
<td>Nihai Aşama</td>
</tr>
<tr>
<td>REJECTED</td>
<td>SUCCEED</td>
<td>Giden Ticari Fatura Red - Başarıyla işlendi</td>
<td>Gönderilmiş olan ticari fatura alıcı tarafından red edilmiştir ve alıcının red yanıtı gönderen tarafa başarılı şekilde ulaşmıştır.</td>
<td>Nihai Aşama</td>
</tr>
</tbody></table>

<h3 id="g-b-durum-kodlar">GİB Durum Kodları</h3>

<table><thead>
<tr>
<th>Kod</th>
<th>Açıklama</th>
<th>Alınacak Aksiyon</th>
</tr>
</thead><tbody>
<tr>
<td>1000</td>
<td>ZARF KUYRUĞA EKLENDİ</td>
<td>Durum kodunun güncellenmesi beklenmelidir.</td>
</tr>
<tr>
<td>1100</td>
<td>ZARF İŞLENİYOR</td>
<td>Durum kodunun güncellenmesi beklenmelidir.</td>
</tr>
<tr>
<td>1110</td>
<td>ZIP DOSYASI DEĞİL</td>
<td>Belge yeniden gönderilmeli</td>
</tr>
<tr>
<td>1111</td>
<td>ZARF ID UZUNLUĞU GEÇERSİZ</td>
<td>Belge yeniden gönderilmeli</td>
</tr>
<tr>
<td>1120</td>
<td>ZARF ARŞİVDEN KOPYALANAMADI</td>
<td>Belge yeniden gönderilmeli</td>
</tr>
<tr>
<td>1130</td>
<td>ZIP AÇILAMADI</td>
<td>Belge yeniden gönderilmeli</td>
</tr>
<tr>
<td>1131</td>
<td>ZIP BİR DOSYA İÇERMELİ</td>
<td>Belge yeniden gönderilmeli</td>
</tr>
<tr>
<td>1132</td>
<td>XML DOSYASI DEĞİL</td>
<td>Belge yeniden gönderilmeli</td>
</tr>
<tr>
<td>1133</td>
<td>ZARF ID VE XML DOSYASININ ADI AYNI OLMALI</td>
<td>Belge yeniden gönderilmeli</td>
</tr>
<tr>
<td>1140</td>
<td>DOKUMAN AYRIŞTIRILAMADI</td>
<td>Belge yeniden gönderilmeli</td>
</tr>
<tr>
<td>1141</td>
<td>ZARF ID YOK</td>
<td>Belge yeniden gönderilmeli</td>
</tr>
<tr>
<td>1142</td>
<td>ZARF ID VE ZIP DOSYASI ADI AYNI OLMALI</td>
<td>Belge yeniden gönderilmeli</td>
</tr>
<tr>
<td>1143</td>
<td>GEÇERSİZ VERSİYON</td>
<td>Belge yeniden gönderilmeli</td>
</tr>
<tr>
<td>1150</td>
<td>SCHEMATRON KONTROL SONUCU HATALI</td>
<td>Belge yeniden gönderilmeli</td>
</tr>
<tr>
<td>1160</td>
<td>XML SEMA KONTROLÜNDEN GEÇEMEDİ</td>
<td>Belge yeniden gönderilmeli</td>
</tr>
<tr>
<td>1161</td>
<td>İMZA SAHİBİ TCKN VKN ALINAMADI</td>
<td>Belge yeniden gönderilmeli</td>
</tr>
<tr>
<td>1162</td>
<td>İMZA KAYDEDİLEMEDİ</td>
<td>Belge yeniden gönderilmeli</td>
</tr>
<tr>
<td>1163</td>
<td>GÖNDERİLEN ZARF SİSTEMDE DAHA ÖNCE KAYITLI OLAN BİR FATURAYI İÇERMEKTEDİR</td>
<td>Belge yeniden gönderilmeli</td>
</tr>
<tr>
<td>1170</td>
<td>YETKİ KONTROL EDİLEMEDİ</td>
<td>Belge yeniden gönderilmeli</td>
</tr>
<tr>
<td>1171</td>
<td>GÖNDERİCİ BİRİM YETKİSİ YOK</td>
<td>Belge yeniden gönderilmeli</td>
</tr>
<tr>
<td>1172</td>
<td>POSTA KUTUSU YETKİSİ YOK</td>
<td>Belge yeniden gönderilmeli</td>
</tr>
<tr>
<td>1175</td>
<td>İMZA YETKİSİ KONTROL EDİLEMEDİ</td>
<td>Belge yeniden gönderilmeli</td>
</tr>
<tr>
<td>1176</td>
<td>İMZA SAHİBİ YETKİSİZ</td>
<td>Belge yeniden gönderilmeli</td>
</tr>
<tr>
<td>1177</td>
<td>GEÇERSİZ İMZA</td>
<td>Belge yeniden gönderilmeli</td>
</tr>
<tr>
<td>1180</td>
<td>ADRES KONTROL EDİLEMEDİ</td>
<td>Belge yeniden gönderilmeli</td>
</tr>
<tr>
<td>1181</td>
<td>ADRES BULUNAMADI</td>
<td>Belge yeniden gönderilmeli</td>
</tr>
<tr>
<td>1182</td>
<td>KULLANICI EKLENEMEDİ</td>
<td>Belge yeniden gönderilmeli</td>
</tr>
<tr>
<td>1183</td>
<td>KULLANICI SİLİNEMEDİ</td>
<td>Belge yeniden gönderilmeli</td>
</tr>
<tr>
<td>1190</td>
<td>SİSTEM YANITI HAZIRLANAMADI</td>
<td>Belge yeniden gönderilmeli</td>
</tr>
<tr>
<td>1195</td>
<td>SİSTEM HATASI</td>
<td>Belge yeniden gönderilmeli</td>
</tr>
<tr>
<td>1200</td>
<td>ZARF BAŞARIYLA İŞLENDİ</td>
<td>Özel entegratörden gönderilen Belgede sorun tespit edilmedi. Sonra ki aşamalara geçilecek.</td>
</tr>
<tr>
<td>1210</td>
<td>DOKUMAN BULUNAN ADRESE GÖNDERİLEMEDİ</td>
<td>GİB’in tekrar gönderme denemesi sonlandıktan sonra, 1215 durum kodu alınır ise belgeler yeniden gönderilmeli</td>
</tr>
<tr>
<td>1215</td>
<td>DOKÜMAN GÖNDERİMİ BAŞARISIZ. TEKRAR GÖNDERME SONLANDI</td>
<td>Belge yeniden gönderilmeli</td>
</tr>
<tr>
<td>1220</td>
<td>HEDEFTEN SİSTEM YANITI GELMEDİ</td>
<td>Bu durum kodundan sonra 1230 HEDEFTEN SİSTEM YANITI BAŞARISIZ GELDİ durum kodu alınır ise Belge yeniden gönderilmelidir.</td>
</tr>
<tr>
<td>1230</td>
<td>HEDEFTEN SİSTEM YANITI BAŞARISIZ GELDİ</td>
<td>Belge yeniden gönderilmeli</td>
</tr>
<tr>
<td>1300</td>
<td>BAŞARIYLA TAMAMLANDI</td>
<td>Başarılı olan Belge aynı numara ile gönderilemez.</td>
</tr>
</tbody></table>

<h2 id="uygulama-yan-t-g-nderme-sendinvoiceresponsewithserversign">Uygulama Yanıtı Gönderme (SendInvoiceResponseWithServerSign)</h2>

<ul>
<li>E-Fatura sisteminde bulunan bir veya birden fazla gelen ticari faturaya uygulama yanıtı göndermeyi sağlayan servistir.</li>
<li>Belgelerinin <strong>imzalanmasını Özel Entegratör&#39;e devretmiş</strong> müşteriler için uygulama yanıtların e-fatura platformunda imzalanarak gönderilmesini sağlamak için hazırlanmıştır.</li>
<li>Bir faturaya en fazla 1 defa yanıt gönderilebilmektedir.</li>
<li>Yanıt gönderilmiş faturalara tekrar yanıt gönderilmesi istemci tarafında kısıtlanmalıdır.</li>
</ul>

<p><br>
Servise gönderilmesi gereken parametreler şu şekildedir:</p>

<table><thead>
<tr>
<th>Parametre</th>
<th>Tip</th>
<th>Zorunluluk</th>
<th>Açıklama</th>
</tr>
</thead><tbody>
<tr>
<td><strong>REQUEST_HEADER</strong></td>
<td>ComplexType</td>
<td><strong>Evet</strong></td>
<td>Request Header objesi içerisinde <code class="prettyprint">SESSION_ID</code> ve <code class="prettyprint">APPLICATION_NAME</code> alanı zorunludur.</td>
</tr>
<tr>
<td><strong>STATUS</strong></td>
<td>String</td>
<td><strong>Evet</strong></td>
<td>Faturaya verilecek yanıt. <code class="prettyprint">KABUL</code> veya <code class="prettyprint">RED</code> değeri alabilir.</td>
</tr>
<tr>
<td><strong>INVOICE</strong></td>
<td>ComplexType</td>
<td><strong>Evet</strong></td>
<td>Yanıt gönderilecek fatura listesi</td>
</tr>
<tr>
<td><strong>DESCRIPTION</strong></td>
<td>String</td>
<td><strong>Evet</strong></td>
<td>Yanıt ile beraber gönderilecek mesaj. Ret edilen faturalar için <code class="prettyprint">Red Sebebi</code> bu alana yazılabilir. <code class="prettyprint">STATUS</code> KABUL ise ve bu alan gönderilmezse <em>Fatura kabul edildi</em>, <code class="prettyprint">STATUS</code> RED ise <strong>Reddedildi</strong> mesajı varsayılan olarak eklenecektir.</td>
</tr>
</tbody></table>

<p>Servisten dönen parametreler şu şekildedir:</p>

<table><thead>
<tr>
<th>Parametre</th>
<th>Tip</th>
<th>Açıklama</th>
</tr>
</thead><tbody>
<tr>
<td><strong>TXN_ID</strong></td>
<td>String</td>
<td>Sunucuda işlemin gerçekleştirildiği transaction IDsi. Bu ID istemci tarafında kaydedilerek oluşabilecek hatalarda referans olarak destek ekibine iletilebilir.</td>
</tr>
<tr>
<td><strong>RETURN_CODE</strong></td>
<td>String</td>
<td>İşlem başarılı ise <code class="prettyprint">0</code> değeri döner. Başarısız olduğunda WS Fault objesi dönecektir.</td>
</tr>
</tbody></table>

<p><br></p>

<h3 id="servisten-d-nebilecek-hatalar">Servisten Dönebilecek Hatalar</h3>

<table><thead>
<tr>
<th>Hata Açıklaması</th>
<th>Açıklama</th>
</tr>
</thead><tbody>
<tr>
<td>Daha önce yanıtlanmış bir fatura için tekrar yanıt gönderilemez! Fatura UUID:xxxxxxx</td>
<td>Bir faturaya en fazla 1 defa yanıt gönderilebilmektedir. <strong>Bundan dolayı yanıt gönderilmiş faturalara tekrar yanıt gönderilmesi istemci tarafında kısıtlanmalıdır.</strong></td>
</tr>
<tr>
<td>Fatura ID : FYA201800000001 sistemde bulunamadı!</td>
<td>E-Fatura sisteminde gelen fatura kutusunda bulunmayan bir faturaya uygulama yanıtı gönderme yapıldığı zaman dönülmektedir. Özellikle birden fazla hesabı olan firmalarda, erişim yetkisi olan bir kullanıcı tarafından istemciye indirilen bir faturaya, faturaya erişim yetkisi olmayan bir kullanıcı tarafından yanıt gönderilince karşılaşılmaktadır.</td>
</tr>
<tr>
<td>Uygulama yanıtı 8 gün geciktiği için cevap gönderilemez</td>
<td>Ticari fatura özel entegratör sistemine ulaştıktan sonra 8 gün içerisinde yanıtlanmalıdır. İstemci 8 günü geçen faturalar için kontrol eklemelidir. 8 günü hesaplamak için GetInvoice servisinde fatura için dönülen CDATE alanına 8 gün eklenebilir.</td>
</tr>
<tr>
<td>Fatura durumu yanıtlama için uygun olmadıgından işlem sonlandı! Fatura UUID:XXX-XXX-, STATUS:XXXXX-XXXXX</td>
<td>Uygulama yanıtı gönderilmiş ve hala süreci tamamlanmamış bir faturaya tekrar yanıt gönderildiğinde dönülen hatadır.</td>
</tr>
</tbody></table>

<p><br><br></p>

<h2 id="uygulama-yan-t-haz-rlama-prepareinvoiceresponse-kullanmay-n-z">Uygulama Yanıtı Hazırlama (PrepareInvoiceResponse) - Kullanmayınız</h2>

<aside class="warning">
Bu servis kullanımı sonlandırılmıştır. Lütfen Uygulama Yanıtı Gönderme (SendInvoiceResponseWithServerSign) başlığını inceleyiniz.
</aside>

<h2 id="uygulama-yan-t-g-nderme-mzal-sendinvoiceresponse">Uygulama Yanıtı Gönderme - İmzalı  (SendInvoiceResponse)</h2>

<aside class="warning">
Bu servis uygulama yanıtını kendi mali mühürü ile hazırlayıp göndermek isteyenler için hazırlanmıştır. Eğer belgelerinizin imzalanmasını Özel Entegratör'e devretmişseniz bu servisi kullanmayınız. Lütfen  Uygulama Yanıtı Gönderme (SendInvoiceResponseWithServerSign) başlığını inceleyiniz.
</aside>

<p><br>
Servise gönderilmesi gereken parametreler şu şekildedir:</p>

<table><thead>
<tr>
<th>Parametre</th>
<th>Tip</th>
<th>Zorunluluk</th>
<th>Açıklama</th>
</tr>
</thead><tbody>
<tr>
<td><strong>REQUEST_HEADER</strong></td>
<td>ComplexType</td>
<td>Evet</td>
<td>Request Header objesi içerisinde <code class="prettyprint">SESSION_ID</code> ve <code class="prettyprint">APPLICATION_NAME</code> alanı zorunludur.</td>
</tr>
<tr>
<td><strong>APPRESPONSE</strong></td>
<td>Base64Binary</td>
<td>Evet</td>
<td>ApplicationResponse formatında hazırlanmış ve imzalanmış uygulama yanıtının Base64Binary encode edilmiş değeri. Uygulama yanıtı hazırlamak için GİB kılavuzunda paylaşılan Uygulama Yanıtı dokümanı inceleyebilirisiniz.</td>
</tr>
</tbody></table>

<p>br&gt;<br></p>

<p>Servisten dönen parametreler şu şekildedir:</p>

<table><thead>
<tr>
<th>Parametre</th>
<th>Tip</th>
<th>Açıklama</th>
</tr>
</thead><tbody>
<tr>
<td><strong>TXN_ID</strong></td>
<td>String</td>
<td>Sunucuda işlemin gerçekleştirildiği transaction IDsi. Bu ID istemci tarafında kaydedilerek oluşabilecek hatalarda referans olarak destek ekibine iletilebilir.</td>
</tr>
<tr>
<td><strong>RETURN_CODE</strong></td>
<td>String</td>
<td>İşlem başarılı ise <code class="prettyprint">0</code> değeri döner. Başarısız olduğunda WS Fault objesi dönecektir.</td>
</tr>
</tbody></table>

<h2 id="zarf-okuma-getenvelope-kullanmay-n-z">Zarf Okuma (GetEnvelope) - Kullanmayınız</h2>

<aside class="warning">
Bu servis kullanımdan kaldırılmıştır. Lütfen GetInvoice servisini kullanınız.
</aside>

<h2 id="zarf-durum-sorgulama-getenvelopestatus-kullanmay-n-z">Zarf Durum Sorgulama (GetEnvelopeStatus) - Kullanmayınız</h2>

<aside class="warning">
Bu servis kullanımdan kaldırılmıştır. Lütfen GetInvoiceStatus servisini kullanınız.
</aside>

<h2 id="zarf-okundu-aretleme-markenvelope-kullanmay-n-z">Zarf Okundu İşaretleme (MarkEnvelope) - Kullanmayınız</h2>

<aside class="warning">
Bu servis kullanımdan kaldırılmıştır. Lütfen MarkInvoice servisini kullanınız.
</aside>

<h2 id="uygulama-yan-t-ekme-getapplicationresponse-kullanmay-n-z">Uygulama Yanıt Çekme (getApplicationResponse) - Kullanmayınız</h2>

<aside class="warning">
Bu servis kullanımdan kaldırılmıştır. Fatura durum sorgulaması yaparak verilen yanıt durumunu öğrenebilirsiniz.
</aside>

<h2 id="oturum-a-ma-login-kullanmay-n-z">Oturum Açma (Login) - Kullanmayınız</h2>

<aside class="warning">E-Fatura webservis içerisinde ki OTURUM AÇMA (Login) metodu Kimlik Doğrulama (Authentication) Webservisine taşınmıştır. Lütfen oturum açmak için Authentication servisini kullanınız.
</aside>

<h2 id="oturum-kapatma-logout-kullanmay-n-z">Oturum Kapatma (Logout) - Kullanmayınız</h2>

<aside class="warning">E-Fatura webservis içerisinde ki OTURUM KAPATMA (Logout) metodu Kimlik Doğrulama (Authentication) Webservisine taşınmıştır. Lütfen oturum kapatmak için Authentication servisini kullanınız.
</aside>

<h2 id="m-kellef-listesi-ekme-getuserlistbinary-kullanmay-n-z">Mükellef Listesi Çekme (GetUserListBinary) - Kullanmayınız</h2>

<aside class="warning">E-Fatura webservis içerisinde ki MÜKELLEF LİSTESİ ÇEKME (GetUserListBinary) metodu Kimlik Doğrulama (Authentication) Webservisine taşınmıştır. Ayrıca servisin ismi GetGibUserList olarak değiştirilmiştir. Lütfen mükellef listesini çekmek için Authentication servisindeki GetGibUserList metodunu kullanınız.
</aside>

<h2 id="m-kellef-listesi-ekme-getuserlist-kullanmay-n-z">Mükellef Listesi Çekme (GetUserList) - Kullanmayınız</h2>

<aside class="warning">
Bu servis e-fatura sistemine kayıtlı bütün mükelleflere ait etiketlerin XML formatında sıkıştırılmadan toplu çekmek için kullanılmıştır. Ancak E-Fatura sistemine kayıtlı mükellef listesinin artmasından dolayı performans sorunu oluşmuştur. Mükellef listesini sıkıştırılmış/ziplenmiş XML olarak dönen GetGibUserList servisi eklenmiştir. Bu servis kullanımı sonlandırılmıştır. Mevcut iş ortaklarımız yeni servise geçince tamamen kapatılacaktır.  Lütfen Kimlik Doğrulama webservisinde ki Mükellef Listesi Çekme (GetGibUserList) başlığını inceleyiniz.
</aside>

          <h1 id="e-ar-iv-fatura-webservisi">E-Arşiv Fatura Webservisi</h1>

<p>E-Fatura mükellefi olmayan firma veya nihai tüketiciye düzenlenen faturaların özel entegratör sistemine gönderilmesi ve raporlamasını sağlayan webservis uygulamasıdır.</p>

<h2 id="g-b-dok-manlar">GİB Dokümanları</h2>

<table><thead>
<tr>
<th>Doküman</th>
<th>Açıklama</th>
<th>İndir</th>
</tr>
</thead><tbody>
<tr>
<td><strong>UBL-TR Fatura</strong></td>
<td>UBL-TR v1.2 (UBL 2.1 Türkiye Özelleştirmesi) paketinde yer alan fatura belgesinde geçen elemanlara ait XSD, tanımlama, kullanım şekilleri, kardinaliteler hakkında bilgi vermek ve örnek kullanım şekillerini göstermek amacı ile hazırlanmıştır.</td>
<td><a href="/resource/BELGELER/UBL-TR Fatura - V 1.0.pdf"><img src="/images/icon_pdf.png" height="40" width="35"/></a></td>
</tr>
<tr>
<td><strong>UBL-TR Ortak Elemanlar</strong></td>
<td>UBL-TR (UBL 2.1 Türkiye Özelleştirmesi) paketinde yer alan belgelerde geçmesi muhtemel elemanlara ait (ortak elemanlar örneğin: Adres, Parasal Toplamlar, Taraf gibi) XSD, açıklama, kullanım şartları, kardinaliteler hakkında bilgi vermek ve örnek kullanım şekillerini göstermek amacı ile hazırlanmıştır.</td>
<td><a href="/resource/BELGELER/UBL-TR Ortak Elemanlar - V 0.7.pdf"><img src="/images/icon_pdf.png" height="40" width="35"/></a></td>
</tr>
<tr>
<td><strong>UBL-TR Kod Listeleri</strong></td>
<td>UBL-TR kapsamında kullanılan Kodlama Sistemleri ve Kimlik Şemaları hakkında bilgi vermek amacı ile hazırlanmıştır.</td>
<td><a href="/resource/BELGELER/UBL-TR Kod Listeleri - V 1.18.pdf"><img src="/images/icon_pdf.png" height="40" width="35"/></a></td>
</tr>
<tr>
<td><strong>Gümrük İşlemleri Kılavuzu</strong></td>
<td>Elektronik Fatura Uygulamasında yolcu beraberi eşya ihracı ve mal ihracı faturalarını e-fatura sistemine entegre edecek ve uygulamaya ilişkin yazılım geliştireceklerin teknik konularda ihtiyaç duyabilecekleri bilgileri vermek amacıyla hazırlanmıştır.</td>
<td><a href="/resource/GUMRUK/Gumruk_Islemleri_Kilavuzu_Versiyon_1_8.pdf"><img src="/images/icon_pdf.png" height="40" width="35"/></a></td>
</tr>
<tr>
<td><strong>İhracat Faturası Ek Alanlar</strong></td>
<td>İhracat faturalarında eklenmesi zorunlu ve isteğe bağlı alanların açıklamak için hazırlanmıştır.</td>
<td><a href="/resource/GUMRUK/Gumruk_Islemleri_Kilavuzu_Versiyon_1_8.pdf"><img src="/images/icon_pdf.png" height="40" width="35"/></a></td>
</tr>
<tr>
<td><strong>SGK E-Fatura Kılavuzu</strong></td>
<td>Elektronik Fatura Uygulamasında Sosyal Güvenlik Kurumuna (SGK) düzenlenecek  faturaların e-fatura sistemine entegre edecek uygulamaya ilişkin yazılım geliştireceklerin teknik konularda ihtiyaç duyabilecekleri bilgileri vermek amacıyla hazırlanmıştır.</td>
<td><a href="http://www.efatura.gov.tr/dosyalar/kilavuzlar/SGK_e-FATURA_UYGULAMA_KILAVUZU.pdf"><img src="/images/icon_pdf.png" height="40" width="35"/></a></td>
</tr>
</tbody></table>

<h2 id="ubl-fatura-rnekleri">UBL-Fatura Örnekleri</h2>

<p>E-Fatura ve E-Arşiv Fatura sistemi üzerinden düzenlebilecek ve gönderilebilecek fatura senaryoları ve örnek fatura XML dosyası aşağıda listelenmiştir.</p>

<aside class="notice">Listede bulunmayan senaryolar için fatura üretmek için  E-Fatura Portale erişebilirsiniz.</aside>

<table><thead>
<tr>
<th>Fatura Senaryosu</th>
<th>Açıklama</th>
<th>XML</th>
<th>HTML</th>
</tr>
</thead><tbody>
<tr>
<td><strong>Temel Satış Faturası</strong></td>
<td>Alıcısı tarafından elektronik ortamda kabul veya reddedilemeyen fatura tipidir.</td>
<td><a href="/resource/xml/FATURA_2.xml" target="_blank"><img src="/images/icon_xml.png" height="40" width="35"/></a></td>
<td><a href="/resource/xml/FATURA_2.html" target="_blank"><img src="/images/icon_html.png" height="40" width="35"/></a></td>
</tr>
<tr>
<td><strong>Ticari Satış Faturası</strong></td>
<td>Alıcısı tarafından elektronik ortamda kabul veya reddedilebilen fatura tipidir.</td>
<td><a href="/resource/xml/FATURA_1.xml" target="_blank"> <img src="/images/icon_xml.png" height="40" width="35"/></a></td>
<td><a href="/resource/xml/FATURA_1.html" target="_blank"><img src="/images/icon_html.png" height="40" width="35"/></a></td>
</tr>
<tr>
<td><strong>İade Faturası</strong></td>
<td>Alınan bir fatura üzerinde ki yanlış tutar veya eksik bilgi sebebi ile düzenlenen fatura tipidir. <strong>İade faturası TEMELFATURA olarak gönderilmesi zorunludur.</strong></td>
<td><a href="/resource/xml/FATURA_4.xml" target="_blank"> <img src="/images/icon_xml.png" height="40" width="35"/></a></td>
<td><a href="/resource/xml/FATURA_4.html" target="_blank"><img src="/images/icon_html.png" height="40" width="35"/></a></td>
</tr>
<tr>
<td><strong>Farklı KDV Oranlarına Sahip Fatura</strong></td>
<td>Fatura satırında farklı KDV oranlarının bulunduğu fatura örneğidir. Her satırda farklı KDV oranı vardır.</td>
<td><a href="/resource/xml/FATURA_5.xml" target="_blank"> <img src="/images/icon_xml.png" height="40" width="35"/></a></td>
<td><a href="/resource/xml/FATURA_5.html" target="_blank"><img src="/images/icon_html.png" height="40" width="35"/></a></td>
</tr>
<tr>
<td><strong>0 KDV Fatura</strong></td>
<td>Fatura satırında KDV oranı 0 olan satış faturası örneğidir. KDV 0 olduğu durumlarda muafiyet sebebi belirtilmelidir.</td>
<td><a href="/resource/xml/FATURA_6.xml" target="_blank"> <img src="/images/icon_xml.png" height="40" width="35"/></a></td>
<td><a href="/resource/xml/FATURA_6.html" target="_blank"><img src="/images/icon_html.png" height="40" width="35"/></a></td>
</tr>
<tr>
<td><strong>Dövizli Satış Faturası</strong></td>
<td>Fatura para birimi TL dışında farklı bir para birimi ile düzenlenen fatura örneğidir. Faturanın içerisinde tutarlar döviz cinsindendir.  TL karşlıkları XML içerisinde bulunmaz. TL karşılıkları görsel üzerinde tutar ile kur çarpılarak gösterilir.</td>
<td><a href="/resource/xml/FATURA_7.xml" target="_blank"> <img src="/images/icon_xml.png" height="40" width="35"/></a></td>
<td><a href="/resource/xml/FATURA_7.html" target="_blank"><img src="/images/icon_html.png" height="40" width="35"/></a></td>
</tr>
<tr>
<td><strong>Bedelsiz (%100 İskontolu) Satış Faturası</strong></td>
<td>Promosyon, Eşantiyon veya Numune Ürün Teslimlerinde bedelsiz düzenlenen fatura örneğidir. Bu faturalarda KDV 0 hesaplandığı için muafiyet sebebi belirtilmelidir.  Bu faturaların muafiyet kodu 351 olur. Muafiyet sebebi ise müşteri tarafından girilebilir.</td>
<td><a href="/resource/xml/FATURA_10.xml" target="_blank"> <img src="/images/icon_xml.png" height="40" width="35"/></a></td>
<td><a href="/resource/xml/FATURA_10.html" target="_blank"><img src="/images/icon_html.png" height="40" width="35"/></a></td>
</tr>
<tr>
<td><strong>Satırda Çoklu İskontolu Satış Faturası</strong></td>
<td>Bir fatura satırında birden fazla iskonto içeren fatura örneğidir.</td>
<td><a href="/resource/xml/FATURA_9.xml" target="_blank"> <img src="/images/icon_xml.png" height="40" width="35"/></a></td>
<td><a href="/resource/xml/FATURA_9.html" target="_blank"><img src="/images/icon_html.png" height="40" width="35"/></a></td>
</tr>
<tr>
<td><strong>İstisna Faturası</strong></td>
<td>İstisna Faturası</td>
<td><a href="/resource/xml/FATURA_11.xml" target="_blank"> <img src="/images/icon_xml.png" height="40" width="35"/></a></td>
<td><a href="/resource/xml/FATURA_11.html" target="_blank"><img src="/images/icon_html.png" height="40" width="35"/></a></td>
</tr>
<tr>
<td><strong>Özel Mathrah Faturası</strong></td>
<td>Özel Matrah Faturası</td>
<td><a href="/resource/xml/FATURA_12.xml" target="_blank"> <img src="/images/icon_xml.png" height="40" width="35"/></a></td>
<td><a href="/resource/xml/FATURA_12.html" target="_blank"><img src="/images/icon_html.png" height="40" width="35"/></a></td>
</tr>
<tr>
<td><strong>Tevkifat Faturası</strong></td>
<td>Tevkifat Faturası</td>
<td><a href="/resource/xml/FATURA_13.xml" target="_blank"> <img src="/images/icon_xml.png" height="40" width="35"/></a></td>
<td><a href="/resource/xml/FATURA_13.html" target="_blank"><img src="/images/icon_html.png" height="40" width="35"/></a></td>
</tr>
<tr>
<td><strong>İhraç Kayıtlı Fatura</strong></td>
<td>İhraç Kayıtlı Fatura</td>
<td><a href="/resource/xml/FATURA_17.xml" target="_blank"> <img src="/images/icon_xml.png" height="40" width="35"/></a></td>
<td><a href="/resource/xml/FATURA_17.html" target="_blank"><img src="/images/icon_html.png" height="40" width="35"/></a></td>
</tr>
<tr>
<td><strong>İhracat Faturası</strong></td>
<td>İhracat Faturası</td>
<td><a href="/resource/xml/FATURA_18.xml" target="_blank"> <img src="/images/icon_xml.png" height="40" width="35"/></a></td>
<td><a href="/resource/xml/FATURA_18.html" target="_blank"><img src="/images/icon_html.png" height="40" width="35"/></a></td>
</tr>
<tr>
<td><strong>Yolcu Beraberi (Taxfree)</strong></td>
<td>Yolcu Beraberi (Taxfree)</td>
<td><a href="/resource/xml/FATURA_19.xml" target="_blank"> <img src="/images/icon_xml.png" height="40" width="35"/></a></td>
<td><a href="/resource/xml/FATURA_19.html" target="_blank"><img src="/images/icon_html.png" height="40" width="35"/></a></td>
</tr>
<tr>
<td><strong>SGK Faturası</strong></td>
<td>SGK Faturası TEMELFATURA senaryosunda gönderilmek zorundadır.</td>
<td><a href="/resource/xml/FATURA_20.xml" target="_blank"> <img src="/images/icon_xml.png" height="40" width="35"/></a></td>
<td><a href="/resource/xml/FATURA_20.html" target="_blank"><img src="/images/icon_html.png" height="40" width="35"/></a></td>
</tr>
<tr>
<td><strong>Gelir Vergisi(GV) Stopajlı Fatura</strong></td>
<td>Gelir vergisi stopajı uygulanan fatura örneğidir.</td>
<td><a href="/resource/xml/FATURA_14.xml" target="_blank"> <img src="/images/icon_xml.png" height="40" width="35"/></a></td>
<td><a href="/resource/xml/FATURA_14.html" target="_blank"><img src="/images/icon_html.png" height="40" width="35"/></a></td>
</tr>
<tr>
<td><strong>Kurumlar Vergisi(KV) Stopajlı Fatura</strong></td>
<td>Kurumlar vergisi stopajı uygulanan fatura örneğidir.</td>
<td><a href="/resource/xml/FATURA_15.xml" target="_blank"> <img src="/images/icon_xml.png" height="40" width="35"/></a></td>
<td><a href="/resource/xml/FATURA_15.html" target="_blank"><img src="/images/icon_html.png" height="40" width="35"/></a></td>
</tr>
<tr>
<td><strong>Ek Belge İçeren Fatura</strong></td>
<td>Faturanın ekinde belge gönderildiği durumlarda düzenlenecek fatura örneğidir.</td>
<td><a href="/resource/xml/FATURA_16.xml" target="_blank"> <img src="/images/icon_xml.png" height="40" width="35"/></a></td>
<td><a href="/resource/xml/FATURA_16.html" target="_blank"><img src="/images/icon_html.png" height="40" width="35"/></a></td>
</tr>
<tr>
<td><strong>E-Arşiv Fatura - İnternet</strong></td>
<td>Internet üzerine yapılan satış için düzenlenen fatura tipidir. Bu faturalar alıcısına elektronik ortamda iletilmek zorundadır. Bu faturalar diğer satış faturalarından farklı bir seriden gönderilmeldir.</td>
<td><a href= "/resource/xml/FATURA_21.xml" target="_blank"><img src="/images/icon_xml.png" height="40" width="35"/></a></td>
<td><a href="/resource/xml/FATURA_21.html" target="_blank"><img src="/images/icon_html.png" height="40" width="35"/></a></td>
</tr>
<tr>
<td><strong>E-Arşiv Fatura - Normal</strong></td>
<td>Internet üzerine yapılan satış dışında düzenlenen fatura tipidir. Bu faturalar alıcısına elektronik ortamda iletilebileceği gibi kağıt olarakta teslim edilebilir.</td>
<td><a href= "/resource/xml/FATURA_22.xml" target="_blank"><img src="/images/icon_xml.png" height="40" width="35"/></a></td>
<td><a href="/resource/xml/FATURA_22.html" target="_blank"><img src="/images/icon_html.png" height="40" width="35"/></a></td>
</tr>
</tbody></table>

<h2 id="webservice-endpoint-wsdl-url">Webservice Endpoint (WSDL) URL</h2>

<table><thead>
<tr>
<th>Ürün</th>
<th>Endpoint URL</th>
</tr>
</thead><tbody>
<tr>
<td>Kimlik Doğrulama</td>
<td><a href="https://efaturatest.izibiz.com.tr/AuthenticationWS?wsdl">https://efaturatest.izibiz.com.tr/AuthenticationWS?wsdl</a></td>
</tr>
<tr>
<td>E-Fatura Webservis</td>
<td><a href="https://efaturatest.izibiz.com.tr/EFaturaOIB?wsdl">https://efaturatest.izibiz.com.tr/EFaturaOIB?wsdl</a></td>
</tr>
<tr>
<td>E-Arşiv Fatura Webservis</td>
<td><a href="https://efaturatest.izibiz.com.tr/EIArchiveWS/EFaturaArchive?wsdl">https://efaturatest.izibiz.com.tr/EIArchiveWS/EFaturaArchive?wsdl</a></td>
</tr>
<tr>
<td>E-İrsaliye Webservis</td>
<td><a href="https://efaturatest.izibiz.com.tr/EIrsaliyeWS/EIrsaliye?wsdl">https://efaturatest.izibiz.com.tr/EIrsaliyeWS/EIrsaliye?wsdl</a></td>
</tr>
<tr>
<td>E-Müstahsil Webservis</td>
<td><a href="http://efaturatest.izibiz.com.tr/CreditNoteWS/CreditNote?wsdl">http://efaturatest.izibiz.com.tr/CreditNoteWS/CreditNote?wsdl</a></td>
</tr>
<tr>
<td>E-Mutabakat Webservis</td>
<td><a href="http://efaturatest.izibiz.com.tr/Reconciliation?wsdl">http://efaturatest.izibiz.com.tr/Reconciliation?wsdl</a></td>
</tr>
<tr>
<td>E-Serbest Meslek Webservis</td>
<td><a href="https://efaturatest.izibiz.com.tr/SmmWS?wsdl">https://efaturatest.izibiz.com.tr/SmmWS?wsdl</a></td>
</tr>
<tr>
<td>E-ZRapor Webservis</td>
<td><a href="https://efaturatest.izibiz.com.tr/ZReportWS?wsdl">https://efaturatest.izibiz.com.tr/ZReportWS?wsdl</a></td>
</tr>
</tbody></table>

<h3 id="portal-uygulamas">Portal Uygulaması</h3>

<p>Entegrasyon sürecinde Portal uygulamamızı aşağıda ki durumlar için kullanabilirsiniz:</p>

<ul>
<li>Belgelerin durumunu kontrol</li>
<li>Farklı senaryolar için belge düzenleyerek XML içeriğini kontrol</li>
<li>Alıcı firmanın mükellefiyet sorgulaması</li>
</ul>

<p>Test Portal Adresimiz: <a href="https://portaltest.izibiz.com.tr">https://portaltest.izibiz.com.tr</a></p>

<p>Test portali erişim bilgileri için <strong>entegrasyon@izibiz.com.tr</strong> adresi ile iletişime geçebilirsiniz.</p>

<h2 id="dikkat-edilecek-hususlar">Dikkat Edilecek Hususlar</h2>

<p>Uygulamanızı tasarlarken aşağıda ki bilgiler faydalı olacaktır:</p>

<ul>
<li><strong>Kimlik Doğrulama (Authentication)</strong> Webservisinde bulunan <strong>Login</strong> servisi ile giriş yaparak session id alınacak. Session Id sistemimiz tarafında 8 saate kadar zaman aşımına uğramadığı için kullanıcı giriş yapınca session id alıp bütün kullanım süresinde aynı session id kullanabilirsiniz.</li>
<li><strong>WriteToArchieveExtended</strong> servisi ile UBL formatlı e-arşiv faturası gönderilir.</li>
<li><strong>ReadFromArchive</strong> servisi ile fatura istenilen formatta (XML, PDF, HTML) okunabilir.</li>
<li><strong>CancelEArchiveInvoice</strong> servisi ile hata tespiti veya müşterinin malı iade etmesi sebebi ile iptal edilen faturaları GIBe bildirilmek üzere gönderilir.</li>
<li><strong>GetEArchiveInvoiceStatus</strong> servisi ile özel entegratör sistemine yüklemiş e-Arşiv faturasanın durumu, e-posta durumu ve raporlanma durumunu sorgulayabilirsiniz.</li>
<li><strong>GetEArchiveReport</strong> servisi ile GİBe raporlanan e-arşiv raporlarını dönemlik olarak çekebilirsiniz.</li>
<li><strong>ReadEArchiveReport</strong> serivisi ile GİBe gönderilen rapor detayını sorgulayabilirsiniz.</li>
<li><strong>GetEmailEarchiveInvoice</strong> servisi ile özel entegratör sistemine daha önce yüklenen e-arşiv faturasının tekrardan e-posta olarak gönderilmesini tetikleyebilirsiniz.</li>
<li>E-Fatura ve E-Arşiv faturaları farklı seri ile düzenlenmelidir.</li>
<li>İnternet üzerinden yapılan satışlar için düzenlenen E-Arşiv faturaları ile diğer satışlardan (E-Fatura veya E-Arşiv) farklı serilerden düzenlenmesi zorunludur.</li>
<li>UBL-TR olarak hazırlanan E-Arşiv faturaların ProfileId alanı <code class="prettyprint">EARSIVFATURA</code> olarak yazılmalıdır. Bu alan eğer sizin tarafınızda farklı bir değer belirtilmiş ise sistem bu alan otomatik olarak “EARSIVFATURA” yazacaktır.</li>
<li>E-Arşiv faturalarda faturanın düzenlenme zamanı(IssueTime) zorunludur.</li>
<li>E-Arşiv faturalarda AdditionalDocumentReference alanında DocumentTypeCode ve DocumentType alanları zorunlu alandır.</li>
<li>İnternet üzerinden yapılan satış için düzenlenen faturalar için Ödeme Şekli (PaymentMeans) ve Kargo bilgileri (Delivery) zorunludur.</li>
</ul>

<h2 id="e-ar-iv-entegrasyon-testleri">E-Arşiv Entegrasyon Testleri</h2>

<table><thead>
<tr>
<th>Test</th>
<th>Test Açıklama</th>
</tr>
</thead><tbody>
<tr>
<td>Oturum Açma</td>
<td></td>
</tr>
<tr>
<td>Nihai Tüketiciye Fatura Gönderme</td>
<td></td>
</tr>
<tr>
<td>Firmaya Fatura Gönderme</td>
<td></td>
</tr>
<tr>
<td>Satış Faturası Gönderme</td>
<td></td>
</tr>
<tr>
<td>İade Faturası Gönderme</td>
<td></td>
</tr>
<tr>
<td>Tevkifatlı Fatura Gönderme</td>
<td></td>
</tr>
<tr>
<td>Alıcısına Kağıt Ortamda Teslim Edilecek Fatura Gönderme</td>
<td></td>
</tr>
<tr>
<td>Alıcısına Kağıt Ortamda Teslim Edilecek ve Ayrıca Elektronik Ortamda İletilecek Fatura Gönderme</td>
<td></td>
</tr>
<tr>
<td>Alıcısına Elektronik Ortamda İletilecek Fatura Gönderme</td>
<td></td>
</tr>
<tr>
<td>İnternet Üzerinden Yapılan Satış İçin Fatura Gönderme</td>
<td></td>
</tr>
<tr>
<td>İrsaliyeli Fatura Gönderme</td>
<td></td>
</tr>
<tr>
<td>Raporlanmadan Önce Fatura İptal Etme</td>
<td></td>
</tr>
<tr>
<td>Raporlandıktan Sonra Fatura İptal Etme</td>
<td></td>
</tr>
<tr>
<td>Hatalı Düzenlenmiş Faturayı Tekrar Yüklemek Üzere İptal Etme</td>
<td></td>
</tr>
<tr>
<td>Faturayı Tekrar E-Posta Olarak İletme Talebi Gönderme</td>
<td></td>
</tr>
<tr>
<td>İmzalı Fatura Çekme</td>
<td></td>
</tr>
<tr>
<td>Fatura Görselini Çekme</td>
<td></td>
</tr>
<tr>
<td>Bir Faturanın Durumunu Sorgulama</td>
<td></td>
</tr>
<tr>
<td>Birden Fazla Faturanın Durumunu Sorgulama</td>
<td></td>
</tr>
<tr>
<td>Rapor Listesi Çekme</td>
<td></td>
</tr>
<tr>
<td>Rapor İçeriği Çekme</td>
<td></td>
</tr>
</tbody></table>

<h2 id="stmeci-client-rnek-projeler">İstmeci (client) Örnek Projeler</h2>

<p>E-Arşiv entegrasyonu için sunucu taraflı programlama diline uygun farklı istemci(client) örnekleri sunar. Bu istemcilerden programlama yapmak istediğiniz dile uygun olanı seçip sandbox(test) bilgileri ile kullanmaya başlayabilirsiniz.</p>

<p><a href="/resource/client/izibiz-earsiv-dotnet-client.zip" target="_blank"><img src="/images/icon_dotnet.png"/></a>
<a href="/resource/client/izibiz-php-client.zip" target="_blank"><img src="/images/icon_php.png"/></a>
<a href="/resource/client/izibiz-earsiv-java-client.zip" target="_blank"><img src="/images/icon_java.png"/></a></p>

<h2 id="hata-sonu-nesnesi">Hata Sonuç Nesnesi</h2>

<p>Webservis metodunda hata oluşması durumunda response objesi içerisinde <code class="prettyprint">ERROR_TYPE</code> tipinde sonuç dönülecektir.</p>

<p>Servisten dönen hata sonuç nesnesi şu şekildedir:</p>

<table><thead>
<tr>
<th>Parametre</th>
<th>Tip</th>
<th>Açıklama</th>
</tr>
</thead><tbody>
<tr>
<td><strong>ERROR_TYPE.INTL_TXN_ID</strong></td>
<td>String</td>
<td>Sunucuda işlemin gerçekleştirildiği transaction IDsi. Bu ID istemci tarafında kaydedilerek oluşabilecek hatalarda referans olarak destek ekibine iletilebilir.</td>
</tr>
<tr>
<td><strong>ERROR_TYPE.ERROR_CODE</strong></td>
<td>String</td>
<td>Başarısız işlemlerde <code class="prettyprint">-1</code> değeri döner.</td>
</tr>
<tr>
<td><strong>ERROR_TYPE.ERROR_SHORT_DESC</strong></td>
<td>String</td>
<td>Hatanın kısa açıklaması.</td>
</tr>
</tbody></table>

<h2 id="ortak-kullan-lan-eleman">Ortak Kullanılan Eleman</h2>

<p>Her webservis isteğinde gönderilmesi beklen ortak elemandır (REQUEST_HEADER)</p>

<table><thead>
<tr>
<th>Parametre</th>
<th>Tip</th>
<th>Zorunluluk</th>
<th>Açıklama</th>
</tr>
</thead><tbody>
<tr>
<td><strong>SESSION_ID</strong></td>
<td>String</td>
<td><strong>Evet</strong></td>
<td>Login Metodunda sistem tarafında gönderilen SESSION_ID bilgisi. Sonraki tüm metod çağrılarında parametre olarak metoda geçmelidir.</td>
</tr>
<tr>
<td><strong>APPLICATION_NAME</strong></td>
<td>String</td>
<td><strong>Evet</strong></td>
<td>Metodu çağıran uygulamanın adı. Mutlaka uygulama adının yazılması gerekmektedir.</td>
</tr>
<tr>
<td><strong>CHANNEL_NAME</strong></td>
<td>String</td>
<td><strong>Evet</strong></td>
<td>Metodun çağrıldığı kanal adı.</td>
</tr>
<tr>
<td><strong>COMPRESSED</strong></td>
<td>String</td>
<td>Hayır</td>
<td>İçerikte taşınan bilginin ZIP formatında sıkıştırılmış mı gönderildiği/talep edildiği bilgisi. Belge gönderim ve belge okuma servislerinde gönderilen değere göre işlem yapılmaktadır.</td>
</tr>
<tr>
<td><strong>CLIENT_TXN_ID</strong></td>
<td>String</td>
<td>Hayır</td>
<td>İstemci uygulama tarafından işlem için üretilen işlem bilgisi (transaction id) varsa istek esnasında gönderilip, sonuçta alabileceğiniz bir değerdir. request/response eşleşmesi yapmak için kullanılabilir.</td>
</tr>
<tr>
<td><strong>INT_PARENT_TXN_ID</strong></td>
<td>String</td>
<td>Hayır</td>
<td>İstemci uygulamasında ana modül entitileri ile ilişkilendirelmek istenen ana transaction ID.</td>
</tr>
<tr>
<td><strong>ACTION_DATE</strong></td>
<td>String</td>
<td>Hayır</td>
<td>Metodun çağrılma tarihi</td>
</tr>
<tr>
<td><strong>CHANGE_INFO</strong></td>
<td>Array</td>
<td>Hayır</td>
<td>Bu eleman ile eğer verilerde bir değişiklik yapılacak ise o değişikliği ait bilgi.</td>
</tr>
<tr>
<td><strong>REASON</strong></td>
<td>String</td>
<td>Hayır</td>
<td>İşlem sebebi. Fatura gönderme, fatura alma vs.</td>
</tr>
<tr>
<td><strong>HOST_NAME</strong></td>
<td>String</td>
<td>Hayır</td>
<td>Metodu çağıran sunucunun host bilgisi.</td>
</tr>
<tr>
<td><strong>SIMULATION_FLAG</strong></td>
<td>String</td>
<td>Hayır</td>
<td>Metod çağrılır ancak arkadaki işlem yapılmaz.</td>
</tr>
</tbody></table>

<h2 id="e-ar-iv-fatura-g-nderme-writetoarchieve-kullanmay-n-z">E-Arşiv Fatura Gönderme (WriteToArchieve) - Kullanmayınız</h2>

<aside class="warning">
Bu servis kullanımı sonlandırılmıştır. Lütfen E-Arşiv fatura göndermek için bir sonra ki başlık olan E-Arşiv Fatura Gönderme (WriteToArchieveExtended) başlığını inceleyiniz.
</aside>

<h2 id="e-ar-iv-fatura-g-nderme-writetoarchieveextended">E-Arşiv Fatura Gönderme (WriteToArchieveExtended)</h2>

<ul>
<li>E-Fatura mükellefi olmayan firmalara veya nihai tüketicilere düzenlenen faturaların özel entegratör sistemine gönderilmesini sağlayan servistir.</li>
<li>Bir istek içerisinde birden fazla fatura göndermek için <strong>ArchiveInvoiceExtendedContent</strong> elemanı çoklanmalıdır.</li>
<li>Internet üzerinde yapılan satış için düzenlenen faturalarında e-arşiv tipi <code class="prettyprint">INTERNET</code> olmak zorundadır. Diğer faturalar için <code class="prettyprint">NORMAL</code> olacaktır.</li>
<li>Eğer E-Arşiv sisteminde müşterinin e-posta gönderme hizmeti yoksa ve e-posta gönderme seçeneği seçilmişse işlem hata alacaktır. Bu durumda özel entegratör ile iletişime geçerek e-posta gönderim hizmetini aktiflemesi talep edilmelidir. Eğer e-posta gönderimi farklı kanallardan yapılacaksa e-posta gönderim parametresini <code class="prettyprint">N</code> olarak gönderiniz.</li>
</ul>

<p><br>
Servise gönderilmesi gereken parametreler şu şekildedir:</p>

<table><thead>
<tr>
<th>Parametre</th>
<th>Tip</th>
<th>Zorunluluk</th>
<th>Açıklama</th>
</tr>
</thead><tbody>
<tr>
<td><strong>REQUEST_HEADER</strong></td>
<td>ComplexType</td>
<td><strong>Evet</strong></td>
<td>Request Header objesi içerisinde <code class="prettyprint">SESSION_ID</code> ve <code class="prettyprint">APPLICATION_NAME</code> alanı zorunludur. Faturaları XML formatında sıkıştırılmadan çekmek için mutlaka <code class="prettyprint">COMPRESSED</code> elemanı eklenmeli ve <code class="prettyprint">N</code> değeri gönderilmelidir. Eğer gönderilmezse faturalar sıkıştırılmış/ziplenmiş olarak dönülecektir.</td>
</tr>
<tr>
<td><strong>INVOICE_PROPERTIES.EARSIV_FLAG</strong></td>
<td>String</td>
<td><strong>Evet</strong></td>
<td>E-Arşiv fatura için <code class="prettyprint">Y</code> olmalıdır.</td>
</tr>
<tr>
<td><strong>INVOICE_PROPERTIES.EARSIV_PROPERTIES</strong></td>
<td>ComplexType</td>
<td>Evet</td>
<td>E-Arşiv faturaları için kullanılabilecek parametreler</td>
</tr>
<tr>
<td><strong>EARSIV_PROPERTIES.EARSIV_TYPE</strong></td>
<td>String</td>
<td><strong>Evet</strong></td>
<td>Gönderilen e-arşiv faturasının tipi: <code class="prettyprint">NORMAL</code> veya <code class="prettyprint">INTERNET</code> değerleri olabilir. Internet üzerinde yapılan satış için düzenlenen faturalarında e-arşiv tipi <code class="prettyprint">INTERNET</code> olmak zorundadır. Diğerleri fatura tipleri için <code class="prettyprint">NORMAL</code> olacaktır.</td>
</tr>
<tr>
<td><strong>EARSIV_PROPERTIES.EARSIV_EMAIL_FLAG</strong></td>
<td>String</td>
<td>Hayır</td>
<td>E-Arşiv faturasının alıcı tarafa e-posta olarak gönderilmek isteniyorsa <code class="prettyprint">Y</code> değeri gönderilmelidir. Varsayılan değer <code class="prettyprint">N</code> dir. DİKKAT: Eğer E-Arşiv sisteminde müşterinin e-posta gönderme hizmeti yoksa <code class="prettyprint">Y</code> değeri gönderilince hata alacaktır. Bu durumda özel entegratör ile iletişime geçerek e-posta gönderim hizmetini aktiflemesi talep edilmelidir.</td>
</tr>
<tr>
<td><strong>EARSIV_PROPERTIES.EARSIV_EMAIL</strong></td>
<td>String</td>
<td>Hayır</td>
<td>E-Arşiv faturasının iletileceği e-posta adresi. E-Posta formatında olmalıdır.  <code class="prettyprint">EARSIV_EMAIL_FLAG= Y</code> olarak gönderilmişse bu alan zorunludur. DİKKAT: Eğer <code class="prettyprint">EARSIV_EMAIL_FLAG</code> gönderilmemiş veya <code class="prettyprint">N</code> olarak gönderilmişse bu alanda ki değer veritabanına kaydedilecek ama e-posta gönderilmeyecektir.</td>
</tr>
<tr>
<td><strong>EARSIV_PROPERTIES.SUB_STATUS</strong></td>
<td>String</td>
<td><strong>Evet</strong></td>
<td>E-Arşiv faturası için <code class="prettyprint">NEW</code> değeri gönderilmelidir.</td>
</tr>
<tr>
<td><strong>EARSIV_PROPERTIES.SERI</strong></td>
<td>String</td>
<td>Hayır</td>
<td>Fatura numara atamasının E-Arşiv platformu üzerinde yapılması istenildiği durumlarda hangi seri ile numara atanacağını belirleyen alandır. Maksimum 3 hane alfanumerik değer içermelidir.  Gönderilecek seri önce portal ekranları kullanılarak e-arşiv sisteminde tanımlanmalıdır. Tanımlanmayan seri gönderildiğinde hata dönülecektir.</td>
</tr>
<tr>
<td><strong>EARSIV_PROPERTIES.ARCH_INVOICE_ID</strong></td>
<td>String</td>
<td>Hayır</td>
<td><strong>Kullanmayınız</strong></td>
</tr>
<tr>
<td><strong>EARSIV_PROPERTIES.EARCHIVE_TEST_FLAG</strong></td>
<td>String</td>
<td>Hayır</td>
<td><strong>Kullanmayınız</strong></td>
</tr>
<tr>
<td><strong>INVOICE_PROPERTIES.PDF_PROPERTIES</strong></td>
<td>ComplexType</td>
<td>Hayır</td>
<td>E-Arşiv faturalara UBL-TR XML yanında üretilen PDF dosyasını da göndermek için kullanılacak parametredir.</td>
</tr>
<tr>
<td><strong>INVOICE_PROPERTIES.ARCHIVE_NOTE</strong></td>
<td>String</td>
<td>Hayır</td>
<td>E-Arşiv faturalara not eklenebilecek parametredir.</td>
</tr>
<tr>
<td><strong>INVOICE_PROPERTIES.INVOICE_CONTENT</strong></td>
<td>Base64Binary</td>
<td><strong>Evet</strong></td>
<td>Faturanın UBL-TR formatında ki dosyasının Base64Binary tipinde sıkıştırılmış/ziplenmiş içeriği.</td>
</tr>
</tbody></table>

<h2 id="deme-ekilleri">Ödeme Şekilleri</h2>

<p>e-Arşiv ve e-Fatura ödeme paymentmeans tag’ini fatura içerisinde kullanıyorsanız bu alanın örnek kod’ları aşağıdaki gibidir.</p>

<table><thead>
<tr>
<th>KOD</th>
<th>AÇIKLAMASI</th>
</tr>
</thead><tbody>
<tr>
<td>48</td>
<td>KREDIKARTI/BANKAKARTI</td>
</tr>
<tr>
<td>46</td>
<td>EFT/HAVALE</td>
</tr>
<tr>
<td>10</td>
<td>KAPIDAODEME</td>
</tr>
<tr>
<td>1</td>
<td>Diğerleri</td>
</tr>
</tbody></table>

<p>Diğer kodlar için aşağıdaki referanslardan yararlanabilirsiniz.
* Referans 1: http://www.unece.org/trade/untdid/d11a/tred/tred4461.htm
** Referans 2: https://www.stylusstudio.com/edifact/D01C/4461.htm</p>

<h2 id="e-ar-iv-fatura-okuma-readfromarchive">E-Arşiv Fatura Okuma (ReadFromArchive)</h2>

<p>Özel entegratör sistemine gönderilen e-arşiv faturalarının farklı formatlarda (XML,HTML,PDF) okumasını sağlayan servistir.</p>

<p><br>
Servise gönderilmesi gereken parametreler şu şekildedir:</p>

<table><thead>
<tr>
<th>Parametre</th>
<th>Tip</th>
<th>Zorunluluk</th>
<th>Açıklama</th>
</tr>
</thead><tbody>
<tr>
<td><strong>REQUEST_HEADER</strong></td>
<td>ComplexType</td>
<td><strong>Evet</strong></td>
<td>Request Header objesi içerisinde <code class="prettyprint">SESSION_ID</code> ve <code class="prettyprint">APPLICATION_NAME</code> alanı zorunludur. Faturaları XML formatında sıkıştırılmadan çekmek için mutlaka <code class="prettyprint">COMPRESSED</code> elemanı eklenmeli ve <code class="prettyprint">N</code> değeri gönderilmelidir. Eğer gönderilmezse faturalar sıkıştırılmış/ziplenmiş olarak dönülecektir.</td>
</tr>
<tr>
<td><strong>INVOICE_ID</strong></td>
<td>String</td>
<td><strong>Evet</strong></td>
<td>Evrensel Tekil Tanımlama Numarası (ETTN) ile fatura okumak için kullanılabilir.  GUID formatında</td>
</tr>
<tr>
<td><strong>PORTAL_DIRECTION</strong></td>
<td>String</td>
<td><strong>Evet</strong></td>
<td><code class="prettyprint">OUT</code> değeri gönderilecek.</td>
</tr>
<tr>
<td><strong>EXTERNAL_ID</strong></td>
<td>String</td>
<td>Hayır</td>
<td><strong>Kullanmayınız</strong></td>
</tr>
<tr>
<td><strong>PROFILE</strong></td>
<td>String</td>
<td>Evet</td>
<td>faturayı almak istediğini formattır. PDF, HTML, XML değeri alabilir. XML değeri gönderilmezse faturanın imzalı UBL-TR XML dosyası dönülecektir.</td>
</tr>
</tbody></table>

<p><br><br></p>

<p>Servisten dönen parametreler şu şekildedir:</p>

<table><thead>
<tr>
<th>Parametre</th>
<th>Tip</th>
<th>Açıklama</th>
</tr>
</thead><tbody>
<tr>
<td><strong>INVOICE</strong></td>
<td>Base64Binary</td>
<td>Faturanın talep edilen formatta ki içeriği. Eğer <code class="prettyprint">COMPRESSED</code> elemanı <code class="prettyprint">N</code> olarak gönderilmişse sıkıştırılmamış, <code class="prettyprint">COMPRESSED</code> elemanı gönderilmemiş veya <code class="prettyprint">Y</code> değeri gönderilmişse sıkıştırılmış/ziplenmiş olarak dönülür. Sonuç alındıktan sonra ilgili formatta işlem yapılabilir.</td>
</tr>
<tr>
<td><strong>REQUEST_RETURN.INTL_TXN_ID</strong></td>
<td>String</td>
<td>Sunucuda işlemin gerçekleştirildiği transaction IDsi. Bu ID istemci tarafında kaydedilerek oluşabilecek hatalarda referans olarak destek ekibine iletilebilir.</td>
</tr>
<tr>
<td><strong>REQUEST_RETURN.RETURN_CODE</strong></td>
<td>String</td>
<td>Başarılı durumlarda <code class="prettyprint">0</code> değeri döner. Başarısız olduğunda request return objesi dönülmez.</td>
</tr>
</tbody></table>

<p><br>
Servisten Dönebilecek Hatalar</p>

<table><thead>
<tr>
<th>Hata Açıklaması</th>
<th>Açıklama</th>
</tr>
</thead><tbody>
<tr>
<td>Fatura okunurken hata oluştu..Okumaya çalıştığınız UUID: xxxxxxx ile fatura bulunmadı&hellip;</td>
<td>webservis isteğinde zorunlu olan bir veya birden fazla parametre eksik gönderilmiştir.</td>
</tr>
</tbody></table>

<h2 id="e-ar-iv-durum-sorgulama-getearchivestatus">E-Arşiv Durum Sorgulama (GetEArchiveStatus)</h2>

<p>Özel entegratör platformuna gönderilen bir veya birden çok faturanın durumunu sorgulamayı sağlayan servistir.</p>

<p><br>
Servise gönderilmesi gereken parametreler şu şekildedir:</p>

<table><thead>
<tr>
<th>Parametre</th>
<th>Tip</th>
<th>Zorunluluk</th>
<th>Açıklama</th>
</tr>
</thead><tbody>
<tr>
<td><strong>REQUEST_HEADER</strong></td>
<td>ComplexType</td>
<td><strong>Evet</strong></td>
<td>Request Header objesi içerisinde <code class="prettyprint">SESSION_ID</code> ve <code class="prettyprint">APPLICATION_NAME</code> alanı zorunludur.</td>
</tr>
<tr>
<td><strong>UUID</strong></td>
<td>String</td>
<td><strong>Evet</strong></td>
<td>Durumu sorgulanacak faturanın Evrensel Tekil Tanımlama Numarası (ETTN). GUID formatında. <strong>Birden fazla faturanın durumunu sorgulamak için bu parametre çoklanır.</strong></td>
</tr>
</tbody></table>

<p><br><br></p>

<p>Servisten dönen parametreler şu şekildedir:</p>

<table><thead>
<tr>
<th>Parametre</th>
<th>Tip</th>
<th>Açıklama</th>
</tr>
</thead><tbody>
<tr>
<td><strong>INVOICE.HEADER</strong></td>
<td>ComplexType</td>
<td>Kritere uyan faturaların durumlarınını içeren objedir.</td>
</tr>
<tr>
<td><strong>HEADER.INVOICE_ID</strong></td>
<td>String</td>
<td>Fatura numarası</td>
</tr>
<tr>
<td><strong>HEADER.UUID</strong></td>
<td>String</td>
<td>Faturanın Evrensel Tekil Tanımlama Numarası (ETTN)</td>
</tr>
<tr>
<td><strong>HEADER.PROFILE</strong></td>
<td>String</td>
<td>Faturanın senaryosu (<code class="prettyprint">EARSIVFATURA</code>)</td>
</tr>
<tr>
<td><strong>HEADER.INVOICE_DATE</strong></td>
<td>String</td>
<td>Fatura tarihi</td>
</tr>
<tr>
<td><strong>HEADER.STATUS</strong></td>
<td>String</td>
<td>Fatura durumu kodu. <strong>Lütfen E-Arşiv Durum başlığını inceleyiniz.</strong></td>
</tr>
<tr>
<td><strong>HEADER.STATUS_DESC</strong></td>
<td>String</td>
<td>Faturanın durum açıklaması <strong>Lütfen E-Arşiv Durum başlığını inceleyiniz.</strong></td>
</tr>
<tr>
<td><strong>HEADER.EMAIL_STATUS</strong></td>
<td>String</td>
<td>E-Posta gönderim durum kodu. <strong>Lütfen E-Arşiv E-Posta Durum başlığını inceleyiniz.</strong></td>
</tr>
<tr>
<td><strong>HEADER.EMAIL_STATUS_DESC</strong></td>
<td>String</td>
<td>E-Posta gönderim durum açıklaması. <strong>Lütfen E-Arşiv E-Posta Durum başlığını inceleyiniz.</strong></td>
</tr>
<tr>
<td><strong>HEADER.REPORT_ID</strong></td>
<td>String</td>
<td>Faturanın GİB&#39;e gönderilen rapor numarası. Raporlanmamış faturalarda parametre dönülmez.</td>
</tr>
<tr>
<td><strong>HEADER.WEB_KEY</strong></td>
<td>String</td>
<td>Fatura alıcısının e-arşiv platformu üzerinden ulaşabileceği URL.</td>
</tr>
<tr>
<td><strong>REQUEST_RETURN.INTL_TXN_ID</strong></td>
<td>String</td>
<td>Sunucuda işlemin gerçekleştirildiği transaction IDsi. Bu ID istemci tarafında kaydedilerek oluşabilecek hatalarda referans olarak destek ekibine iletilebilir.</td>
</tr>
<tr>
<td><strong>REQUEST_RETURN.RETURN_CODE</strong></td>
<td>String</td>
<td>Başarılı durumlarda <code class="prettyprint">0</code> değeri döner. Başarısız olduğunda request return objesi dönülmez.</td>
</tr>
</tbody></table>

<h3 id="e-ar-iv-durumlar">E-Arşiv Durumları</h3>

<table><thead>
<tr>
<th>Durum Kodu</th>
<th>Durum Açıklaması</th>
</tr>
</thead><tbody>
<tr>
<td>100</td>
<td>KUYRUĞA EKLENDİ</td>
</tr>
<tr>
<td>105</td>
<td>TASLAK OLARAK EKLENDİ</td>
</tr>
<tr>
<td>110</td>
<td>İŞLENİYOR</td>
</tr>
<tr>
<td>115</td>
<td>İŞLENİYOR</td>
</tr>
<tr>
<td>120</td>
<td>İŞLENDİ</td>
</tr>
<tr>
<td>130</td>
<td>RAPORLANDI</td>
</tr>
<tr>
<td>200</td>
<td>FATURA ID BULUNAMADI</td>
</tr>
</tbody></table>

<h3 id="e-ar-iv-e-posta-g-nderim-durumlar">E-Arşiv E-Posta Gönderim Durumları</h3>

<table><thead>
<tr>
<th>Durum Kodu</th>
<th>Durum Açıklaması</th>
</tr>
</thead><tbody>
<tr>
<td>100</td>
<td>HENÜZ İŞLENMEDİ</td>
</tr>
<tr>
<td>110</td>
<td>İŞLENİYOR</td>
</tr>
<tr>
<td>120</td>
<td>İŞLENDİ</td>
</tr>
<tr>
<td>130</td>
<td>E-MAIL GÖNDERİM SONLANDI</td>
</tr>
</tbody></table>

<h2 id="e-ar-iv-fatura-ptal-cancelearchiveinvoice">E-Arşiv Fatura İptal (CancelEArchiveInvoice)</h2>

<ul>
<li>Özel entegratör platformuna gönderildikten veya GİB&#39;e raporlandıktan sonra eksik veya hata tespit edilen veya müşteri tarafından iade edilen belgenin GIB&#39;e iptal fatura durumunda raporlanmasını sağlayan servistir.</li>
<li>GİB&#39;e raporlamadan tespit edilmiş bir hata sebebi ile hiç raporlanmamasını istenildiği durumlarda belge numarası farklı bir faturaya atanarak gönderilebilir.</li>
<li>İptal edilen değil ama silinen fatura müteselsilliği bozmamak için tekrar yüklenmelidir.</li>
</ul>

<p><br>
Servise gönderilmesi gereken parametreler şu şekildedir:</p>

<table><thead>
<tr>
<th>Parametre</th>
<th>Tip</th>
<th>Zorunluluk</th>
<th>Açıklama</th>
</tr>
</thead><tbody>
<tr>
<td><strong>REQUEST_HEADER</strong></td>
<td>ComplexType</td>
<td><strong>Evet</strong></td>
<td>Request Header objesi içerisinde <code class="prettyprint">SESSION_ID</code> ve <code class="prettyprint">APPLICATION_NAME</code> alanı zorunludur.</td>
</tr>
<tr>
<td><strong>INVOICE_ID</strong></td>
<td>String</td>
<td>Hayır</td>
<td>İptal edilecek faturanın numarası. FYA201800000001 formatında</td>
</tr>
<tr>
<td><strong>INVOICE_UUID</strong></td>
<td>String</td>
<td><strong>Evet</strong></td>
<td>İptal edilecek faturanın Evrensel Tekil Tanımlama Numarası (ETTN). GUID formatında</td>
</tr>
<tr>
<td><strong>UPLOAD_FLAG</strong></td>
<td>String</td>
<td>Hayır</td>
<td>E-Arşiv platformunda bulunmayan bir faturayı iptal etmek için <code class="prettyprint">Y</code> degeri gönderilmesi ve <code class="prettyprint">İptal Tarihi</code>, <code class="prettyprint">Toplam Tutar</code> ve <code class="prettyprint">Fatura Tarihi</code> parametrelerinin doldurulması gerekir.</td>
</tr>
<tr>
<td><strong>EARSIV_CANCEL_EMAIL</strong></td>
<td>String</td>
<td>Hayır</td>
<td>İptal edilecek e-arşiv faturasının alıcısına e-posta olarak bildirimi için kullanılacak parametre. Birden fazla e-posta adresini virgül <code class="prettyprint">,</code> ile ayırarak gönderebilirsiniz.  E-Posta formatında olmalıdır. (adsoyad@domain.com)</td>
</tr>
<tr>
<td><strong>DELETE_FLAG</strong></td>
<td>String</td>
<td>Hayır</td>
<td>Sisteme yüklenmiş ama raporlanmamış bir e-Arşiv faturasını hiç raporlamamak için kullanılan parametredir.  <code class="prettyprint">Y</code> değeri gönderilirse fatura GİB&#39;e hiç bir türlü raporlanmayacaktır. <strong>Silinen fatura müteselsilliği bozmamak için tekrar yüklenmelidir.</strong></td>
</tr>
<tr>
<td><strong>IPTAL_TARIHI</strong></td>
<td>String</td>
<td>Hayır</td>
<td>E-Arşiv platformunda bulunmayan bir faturanın iptal isteğinde gönderilecek. Faturanın iptal tarihi.</td>
</tr>
<tr>
<td><strong>TOPLAM_TUTAR</strong></td>
<td>String</td>
<td>Hayır</td>
<td>iptal edilen faturanın ödenecek tutarı.  E-Arşiv platformunda bulunmayan bir faturayı iptal ederken gönderilmelidir.</td>
</tr>
<tr>
<td><strong>INVOICE_CONTENT</strong></td>
<td>String</td>
<td>Hayır</td>
<td><strong>Kullanmayınız</strong></td>
</tr>
</tbody></table>

<p><br><br></p>

<p>Servisten dönen parametreler şu şekildedir:</p>

<table><thead>
<tr>
<th>Parametre</th>
<th>Tip</th>
<th>Açıklama</th>
</tr>
</thead><tbody>
<tr>
<td><strong>INTL_TXN_ID</strong></td>
<td>String</td>
<td>Sunucuda işlemin gerçekleştirildiği transaction IDsi. Bu ID istemci tarafında kaydedilerek oluşabilecek hatalarda referans olarak destek ekibine iletilebilir.</td>
</tr>
<tr>
<td><strong>RETURN_CODE</strong></td>
<td>String</td>
<td>Başarılı durumlarda <code class="prettyprint">0</code> değeri döner.</td>
</tr>
</tbody></table>

<h2 id="e-ar-iv-faturas-n-e-posta-olarak-tekrar-g-nderme-getemailearchiveinvoice">E-Arşiv Faturasını E-Posta Olarak Tekrar Gönderme (GetEmailEarchiveInvoice)</h2>

<ul>
<li>E-Arşiv faturasını yükledikten sonra e-posta olarak aynı veya farklı e-postalara tekrar gönderilmesini sağlayan servistir.</li>
<li>Birden fazla e-postaya göndermek için virgül (,) ile ayırarak gönderilmelidir.</li>
</ul>

<p><br>
Servise gönderilmesi gereken parametreler şu şekildedir:</p>

<table><thead>
<tr>
<th>Parametre</th>
<th>Tip</th>
<th>Zorunluluk</th>
<th>Açıklama</th>
</tr>
</thead><tbody>
<tr>
<td><strong>REQUEST_HEADER</strong></td>
<td>ComplexType</td>
<td><strong>Evet</strong></td>
<td>Request Header objesi içerisinde <code class="prettyprint">SESSION_ID</code> ve <code class="prettyprint">APPLICATION_NAME</code> alanı zorunludur.</td>
</tr>
<tr>
<td><strong>FATURA_UUID</strong></td>
<td>String</td>
<td><strong>Evet</strong></td>
<td>E-Posta olarak iletilecek faturanın Evrensel Tekil Tanımlama Numarası (ETTN). GUID formatında.</td>
</tr>
<tr>
<td><strong>FATURA_ID</strong></td>
<td>String</td>
<td>Hayır</td>
<td><strong>Kullanılmamaktadır</strong></td>
</tr>
<tr>
<td><strong>EMAIL</strong></td>
<td>String</td>
<td><strong>Evet</strong></td>
<td>E-Arşiv faturasının iletileceği e-posta adresi. E-Posta formatında olmalıdır. Birden fazla e-postaya göndermek için virgül (,) ile ayırarak gönderilmelidir.</td>
</tr>
</tbody></table>

<p><br><br></p>

<p>Servisten dönen parametreler şu şekildedir:</p>

<table><thead>
<tr>
<th>Parametre</th>
<th>Tip</th>
<th>Açıklama</th>
</tr>
</thead><tbody>
<tr>
<td><strong>REQUEST_RETURN.INTL_TXN_ID</strong></td>
<td>String</td>
<td>Sunucuda işlemin gerçekleştirildiği transaction IDsi. Bu ID istemci tarafında kaydedilerek oluşabilecek hatalarda referans olarak destek ekibine iletilebilir.</td>
</tr>
<tr>
<td><strong>REQUEST_RETURN.RETURN_CODE</strong></td>
<td>String</td>
<td>Başarılı durumlarda <code class="prettyprint">0</code> değeri döner. Başarısız olduğunda request return objesi dönülmez.</td>
</tr>
</tbody></table>

<h3 id="e-ar-iv-durumlar">E-Arşiv Durumları</h3>

<table><thead>
<tr>
<th>Durum Kodu</th>
<th>Durum Açıklaması</th>
</tr>
</thead><tbody>
<tr>
<td>100</td>
<td>KUYRUĞA EKLENDİ</td>
</tr>
<tr>
<td>105</td>
<td>TASLAK OLARAK EKLENDİ</td>
</tr>
<tr>
<td>110</td>
<td>İŞLENİYOR</td>
</tr>
<tr>
<td>115</td>
<td>İŞLENİYOR</td>
</tr>
<tr>
<td>120</td>
<td>İŞLENDİ</td>
</tr>
<tr>
<td>130</td>
<td>RAPORLANDI</td>
</tr>
<tr>
<td>200</td>
<td>FATURA ID BULUNAMADI</td>
</tr>
</tbody></table>

<h3 id="e-ar-iv-e-posta-g-nderim-durumlar">E-Arşiv E-Posta Gönderim Durumları</h3>

<table><thead>
<tr>
<th>Durum Kodu</th>
<th>Durum Açıklaması</th>
</tr>
</thead><tbody>
<tr>
<td>100</td>
<td>HENÜZ İŞLENMEDİ</td>
</tr>
<tr>
<td>110</td>
<td>İŞLENİYOR</td>
</tr>
<tr>
<td>120</td>
<td>İŞLENDİ</td>
</tr>
<tr>
<td>130</td>
<td>E-MAIL GÖNDERİM SONLANDI</td>
</tr>
</tbody></table>

<h2 id="e-ar-iv-rapor-listesini-ekme-getearchivereport">E-Arşiv Rapor Listesini Çekme (GetEArchiveReport)</h2>

<p>Özel entegratör platformunda mükellefe ait oluşturulan bir döneme ait rapor listesini çekmek için kullanılır. Bu servis sadece rapor listesini döndecektir. Servisin döndüğü raporlara ait içerikleri almak için <strong>ReadEArchiveReport</strong> servisi kullanılabilir.</p>

<p><br>
Servise gönderilmesi gereken parametreler şu şekildedir:</p>

<table><thead>
<tr>
<th>Parametre</th>
<th>Tip</th>
<th>Zorunluluk</th>
<th>Açıklama</th>
</tr>
</thead><tbody>
<tr>
<td><strong>REQUEST_HEADER</strong></td>
<td>ComplexType</td>
<td><strong>Evet</strong></td>
<td>Request Header objesi içerisinde <code class="prettyprint">SESSION_ID</code> ve <code class="prettyprint">APPLICATION_NAME</code> alanı zorunludur.</td>
</tr>
<tr>
<td><strong>REPORT_PERIOD</strong></td>
<td>String</td>
<td><strong>Evet</strong></td>
<td>Rapor listesinin alınmak istenilen dönem bilgisi. Örnek: Mayıs 2018 dönemi için 201805</td>
</tr>
<tr>
<td><strong>REPORT_STATUS_FLAG</strong></td>
<td>String</td>
<td>Hayır</td>
<td>Rapor durumunun sonuca eklenmesi isteniyorsa <code class="prettyprint">Y</code>, değilse <code class="prettyprint">N</code> değeri  gönderilmelidir.</td>
</tr>
</tbody></table>

<p><br><br></p>

<p>Servisten dönen parametreler şu şekildedir:</p>

<table><thead>
<tr>
<th>Parametre</th>
<th>Tip</th>
<th>Açıklama</th>
</tr>
</thead><tbody>
<tr>
<td><strong>REPORT</strong></td>
<td>ComplexType</td>
<td>Dönem için oluşturulan raporların listesi. Birden fazla rapor varsa REPORT objesi çoklu olur.</td>
</tr>
<tr>
<td><strong>REPORT.REPORT_NO</strong></td>
<td>String</td>
<td>Raporun numarası GUID formatında</td>
</tr>
<tr>
<td><strong>REPORT.STATUS</strong></td>
<td>String</td>
<td>Raporun durumu. İşlenmiş rapor durumu <code class="prettyprint">SUCCEED</code> olur.</td>
</tr>
<tr>
<td><strong>REQUEST_RETURN.INTL_TXN_ID</strong></td>
<td>String</td>
<td>Sunucuda işlemin gerçekleştirildiği transaction IDsi. Bu ID istemci tarafında kaydedilerek oluşabilecek hatalarda referans olarak destek ekibine iletilebilir.</td>
</tr>
<tr>
<td><strong>REQUEST_RETURN.RETURN_CODE</strong></td>
<td>String</td>
<td>Başarılı durumlarda <code class="prettyprint">0</code> değeri döner. Başarısız olduğunda request return objesi dönülmez.</td>
</tr>
</tbody></table>

<h2 id="e-ar-iv-rapor-ekme-readearchivereport">E-Arşiv Rapor Çekme (ReadEArchiveReport)</h2>

<p>Mükellef için GİB&#39;e gönderilen raporun imzalı XML dosyasını okumayı sağlayan servistir.</p>

<p><br>
Servise gönderilmesi gereken parametreler şu şekildedir:</p>

<table><thead>
<tr>
<th>Parametre</th>
<th>Tip</th>
<th>Zorunluluk</th>
<th>Açıklama</th>
</tr>
</thead><tbody>
<tr>
<td><strong>REQUEST_HEADER</strong></td>
<td>ComplexType</td>
<td><strong>Evet</strong></td>
<td>Request Header objesi içerisinde <code class="prettyprint">SESSION_ID</code> ve <code class="prettyprint">APPLICATION_NAME</code> alanı zorunludur.</td>
</tr>
<tr>
<td><strong>RAPOR_ID</strong></td>
<td>String</td>
<td><strong>Evet</strong></td>
<td>Detay/içeriği çekilecek raporun IDsi. Rapor IDsine <strong>GetEArchiveReport</strong> servisini kullanarak erişebilirsiniz.</td>
</tr>
</tbody></table>

<p><br><br></p>

<p>Servisten dönen parametreler şu şekildedir:</p>

<table><thead>
<tr>
<th>Parametre</th>
<th>Tip</th>
<th>Açıklama</th>
</tr>
</thead><tbody>
<tr>
<td><strong>EARCHIVEREPORT</strong></td>
<td>Base64Binary</td>
<td>GİB&#39;e gönderilen raporun imzalı XML dosyasının sıkıştırılmış/ziplenmiş ve Base64 encode edilmiş değeri.</td>
</tr>
<tr>
<td><strong>REQUEST_RETURN.INTL_TXN_ID</strong></td>
<td>String</td>
<td>Sunucuda işlemin gerçekleştirildiği transaction IDsi. Bu ID istemci tarafında kaydedilerek oluşabilecek hatalarda referans olarak destek ekibine iletilebilir.</td>
</tr>
<tr>
<td><strong>REQUEST_RETURN.RETURN_CODE</strong></td>
<td>String</td>
<td>Başarılı durumlarda <code class="prettyprint">0</code> değeri döner. Başarısız olduğunda request return objesi dönülmez.</td>
</tr>
</tbody></table>

          <h1 id="e-rsaliye-webservisi">E-İrsaliye Webservisi</h1>

<p>e-Arşiv servisi, e-arşiv mükellefinin fatura gönderimini sağlayan webservis uygulamasıdır.
<h2 id="g-b-dok-manlar">GİB Dokümanları</h2></p>

<table><thead>
<tr>
<th>Doküman</th>
<th>Açıklama</th>
<th>İndir</th>
</tr>
</thead><tbody>
<tr>
<td><strong>UBL-TR İrsaliye</strong></td>
<td>UBL-TR v1.2 (UBL 2.1 Türkiye Özelleştirmesi) paketinde yer alan sevk irsaliyesi belgesinde geçen elemanlara ait XSD, tanımlama, kullanım şekilleri, kardinaliteler hakkında bilgi vermek ve örnek kullanım şekillerini göstermek amacı ile hazırlanmıştır.</td>
<td><a href="/resource/BELGELER/UBL-TR irsaliye - V 1.0.pdf"><img src="/images/icon_pdf.png" height="40" width="35"/></a></td>
</tr>
<tr>
<td><strong>UBL-TR İrsaliye Yanıtı</strong></td>
<td>UBL-TR v1.2 (UBL 2.1 Türkiye Özelleştirmesi) paketinde yer alan irsaliye Yanıtı belgesinde geçen elemanlara ait XSD, tanımlama, kullanım şekilleri, kardinaliteler hakkında bilgi vermek ve örnek kullanım şekillerini göstermek amacı ile hazırlanmıştır.</td>
<td><a href="/resource/BELGELER/UBL-TR irsaliye Yaniti - V 1.0.pdf"><img src="/images/icon_pdf.png" height="40" width="35"/></a></td>
</tr>
<tr>
<td><strong>UBL-TR Ortak Elemanlar</strong></td>
<td>UBL-TR (UBL 2.1 Türkiye Özelleştirmesi) paketinde yer alan belgelerde geçmesi muhtemel elemanlara ait (ortak elemanlar örneğin: Adres, Parasal Toplamlar, Taraf gibi) XSD, açıklama, kullanım şartları, kardinaliteler hakkında bilgi vermek ve örnek kullanım şekillerini göstermek amacı ile hazırlanmıştır.</td>
<td><a href="/resource/BELGELER/UBL-TR Ortak Elemanlar - V 0.7.pdf"><img src="/images/icon_pdf.png" height="40" width="35"/></a></td>
</tr>
<tr>
<td><strong>UBL-TR Kod Listeleri</strong></td>
<td>UBL-TR kapsamında kullanılan Kodlama Sistemleri ve Kimlik Şemaları hakkında bilgi vermek amacı ile hazırlanmıştır.</td>
<td><a href="/resource/BELGELER/UBL-TR Kod Listeleri - V 1.18.pdf"><img src="/images/icon_pdf.png" height="40" width="35"/></a></td>
</tr>
</tbody></table>

<h2 id="ubl-rsaliye-senaryolar">UBL-İrsaliye Senaryoları</h2>

<p>E-İrsaliye sistemi üzerinden düzenlebilecek ve gönderilebilecek e-irsaliye senaryoları ve örnek  XML dosyaları aşağıda listelenmiştir.</p>

<table><thead>
<tr>
<th>Senaryosu</th>
<th>Açıklama</th>
<th>XML</th>
</tr>
</thead><tbody>
<tr>
<td><strong>Temel e-İrsaliye</strong></td>
<td>Malların sevkiyatını sağlayan taraf e-İrsaliyeyi Malları teslim alan tarafa gönderir.</td>
<td><a href="/resource/xml/irsaliye_temel_ornek.xml" target = "_blank" > <img src = "/images/icon_xml.png" height="40" width="35"/></a></td>
</tr>
<tr>
<td><strong>Kısmi Gönderim İçeren e-İrsaliye</strong></td>
<td>Malların sevkiyatını sağlayan taraf sipariş edilen malların bir kısmını gönderdiği durumlarda düzenlediği senaryodur.</td>
<td><a href="/resource/xml/irsaliye_kismi_ornek.xml" target="_blank"> <img src="/images/icon_xml.png" height="40" width="35"/></a></td>
</tr>
<tr>
<td><strong>Farklı Tarafların Bulunduğu e-İrsaliye</strong></td>
<td>Malların Sevkiyatını Sağlayan, Malları Teslim Alan, Malların Satın Alımını Sağlayan, Malları Satan ve Tüm sürecin başlamasını Sağlayan Alıcı tarafın bulunduğu e-İrsaliye Senaryosudur.</td>
<td><a href="/resource/xml/irsaliye_farklitaraf_ornek.xml" target="_blank"> <img src="/images/icon_xml.png" height="40" width="35"/></a></td>
</tr>
</tbody></table>

<h2 id="ubl-rsaliye-yan-t-senaryolar">UBL-İrsaliye Yanıt Senaryoları</h2>

<p>E-İrsaliye sistemi üzerinden gönderilebilecek e-irsaliye yanıt senaryoları ve örnek  XML dosyaları aşağıda listelenmiştir.</p>

<table><thead>
<tr>
<th>Senaryosu</th>
<th>Açıklama</th>
<th>XML</th>
</tr>
</thead><tbody>
<tr>
<td><strong>Bütün Sevkiyatı Kabul Eden e-İrsaliye Yanıtı</strong></td>
<td>Malların teslim alan tarafın bütün malları kabul ettiğini bildiren e-İrsaliye yanıt senaryosudur.</td>
<td><a href="/resource/xml/irsaliyeyanit_kabul_ornek.xml" target = "_blank"> <img src = "/images/icon_xml.png" height="40" width="35"/></a></td>
</tr>
<tr>
<td><strong>Şikayet İçeren e-İrsaliye Yanıtı</strong></td>
<td>e-İrsaliye&#39;deki tüm ürünler malları alan taraf tarafından kabul edilmiştir. Fakat mallar geç gönderildiği için şikayette bulunduğu e-İrsaliye yanıt senaryosudur.</td>
<td><a href="/resource/xml/irsaliyeyanit_sikayet_ornek.xml" target="_blank"> <img src="/images/icon_xml.png" height="40" width="35"/></a></td>
</tr>
<tr>
<td><strong>Hasarlı Ürünleri Bildiren e-İrsaliye Yanıtı</strong></td>
<td>Malları teslim alan tarafın gelen e-İrsaliye&#39;deki malların ilk iki kaleminde hasarlı ürünler bulunduğunu bildiren e-İrsaliye senaryosudur.</td>
<td><a href="/resource/xml/irsaliyeyanit_hasarli_ornek.xml" target="_blank"> <img src="/images/icon_xml.png" height="40" width="35"/></a></td>
</tr>
<tr>
<td><strong>Fazla/Eksik Ürünlerin Bildirilmesine Dair e-İrsaliye Yanıtı</strong></td>
<td>Malları teslim alan tarafın fazla ürünlerin iadesine ve eksik ürünlerin bildirilmesine dair düzenlediği e-İrsaliye yanıt senaryosudur.</td>
<td><a href="/resource/xml/irsaliyeyanit_fazlaeksik_ornek.xml" target="_blank"> <img src="/images/icon_xml.png" height="40" width="35"/></a></td>
</tr>
</tbody></table>

<h2 id="webservice-endpoint-wsdl-url">Webservice Endpoint (WSDL) URL</h2>

<table><thead>
<tr>
<th>Ürün</th>
<th>Endpoint URL</th>
</tr>
</thead><tbody>
<tr>
<td>Kimlik Doğrulama</td>
<td><a href="https://efaturatest.izibiz.com.tr/AuthenticationWS?wsdl">https://efaturatest.izibiz.com.tr/AuthenticationWS?wsdl</a></td>
</tr>
<tr>
<td>E-Fatura Webservis</td>
<td><a href="https://efaturatest.izibiz.com.tr/EFaturaOIB?wsdl">https://efaturatest.izibiz.com.tr/EFaturaOIB?wsdl</a></td>
</tr>
<tr>
<td>E-Arşiv Fatura Webservis</td>
<td><a href="https://efaturatest.izibiz.com.tr/EIArchiveWS/EFaturaArchive?wsdl">https://efaturatest.izibiz.com.tr/EIArchiveWS/EFaturaArchive?wsdl</a></td>
</tr>
<tr>
<td>E-İrsaliye Webservis</td>
<td><a href="https://efaturatest.izibiz.com.tr/EIrsaliyeWS/EIrsaliye?wsdl">https://efaturatest.izibiz.com.tr/EIrsaliyeWS/EIrsaliye?wsdl</a></td>
</tr>
<tr>
<td>E-Müstahsil Webservis</td>
<td><a href="http://efaturatest.izibiz.com.tr/CreditNoteWS/CreditNote?wsdl">http://efaturatest.izibiz.com.tr/CreditNoteWS/CreditNote?wsdl</a></td>
</tr>
<tr>
<td>E-Mutabakat Webservis</td>
<td><a href="http://efaturatest.izibiz.com.tr/Reconciliation?wsdl">http://efaturatest.izibiz.com.tr/Reconciliation?wsdl</a></td>
</tr>
<tr>
<td>E-Serbest Meslek Webservis</td>
<td><a href="https://efaturatest.izibiz.com.tr/SmmWS?wsdl">https://efaturatest.izibiz.com.tr/SmmWS?wsdl</a></td>
</tr>
<tr>
<td>E-ZRapor Webservis</td>
<td><a href="https://efaturatest.izibiz.com.tr/ZReportWS?wsdl">https://efaturatest.izibiz.com.tr/ZReportWS?wsdl</a></td>
</tr>
</tbody></table>

<h3 id="portal-uygulamas">Portal Uygulaması</h3>

<p>Entegrasyon sürecinde Portal uygulamamızı aşağıda ki durumlar için kullanabilirsiniz:</p>

<ul>
<li>Belgelerin durumunu kontrol</li>
<li>Farklı senaryolar için belge düzenleyerek XML içeriğini kontrol</li>
<li>Alıcı firmanın mükellefiyet sorgulaması</li>
</ul>

<p>Test Portal Adresimiz: <a href="https://portaltest.izibiz.com.tr">https://portaltest.izibiz.com.tr</a></p>

<p>Test portali erişim bilgileri için <strong>entegrasyon@izibiz.com.tr</strong> adresi ile iletişime geçebilirsiniz.</p>

<h2 id="test-hesaplar">Test Hesaplar</h2>

<p>Test sürecinde düzenlenen faturaların/irsaliyelerin göndericisi, alıcısı ve etiketler için aşağıda ki bilgiler kullanılmalıdır.</p>

<table><thead>
<tr>
<th>Gönderici VKN</th>
<th>Gönderici Etiket</th>
<th>Alıcı VKN</th>
<th>Alıcı Etiket</th>
</tr>
</thead><tbody>
<tr>
<td>4840847211</td>
<td>urn:mail:defaultgb@izibiz.com.tr</td>
<td>4840847211</td>
<td>urn:mail:defaultpk@izibiz.com.tr</td>
</tr>
</tbody></table>

<h2 id="dikkat-edilecek-hususlar">Dikkat Edilecek Hususlar</h2>

<p>E-İrsaliye uygulamanızı tasarlarken aşağıda ki bilgiler faydalı olacaktır:</p>

<ol>
<li><p><strong>Kimlik Doğrulama (Authentication)</strong> Webservisinde bulunan <strong>Login</strong> metodu ile oturum açarak session id alınacaktır. Session Id sistemimiz tarafında 8 saate kadar zaman aşımına uğramadığı için kullanıcı giriş yapınca session id alıp bütün kullanım süresinde aynı session id kullanabilirsiniz.</p></li>
<li><p><strong>Kimlik Doğrulama (Authentication)</strong> Webservisinde bulunan <strong>GetGibUserList</strong> metodu ile GIB e-irsaliye mükellef listesini her 2 saatte entegrasyon sunucularından çekmenizi tavsiye ederiz. Güncel listeyi çektikten sonra Cari listenizde ki firmaların e-irsaliye mükellefi olup olmadığını güncellemelisiniz.</p></li>
<li><p>E-İrsaliy Mükellefi olan firmalara düzenlenen irsaliyeleleri UBL-TR İrsaliye formatına dönüştürerek gönderilmelidir. Her e-irsaliye içerisinde görüntülenmesini sağlayan XSLT dokümanı olmalıdır.</p></li>
<li><p><strong>SendDespatchAdvice</strong> metodu ile irsaliye gönderimi yapılacak. Gönderim esnasında eğer alıcı mükellefe ait birden fazla Posta Kutusu bulunuyorsa ekranda seçilerek gönderilmesi sağlanmalı. Sadece 1 adet PK adresi varsa seçim yapılmadan gönderim sağlanabilir.</p></li>
<li><p><strong>GetDespatchAdviceStatus</strong> metodu ile gelen/giden irsaliyelerin durumları sorgulanacak. Nihai duruma erişene kadar belgenin durumu entegrasyon sunucularından minumum 4 saatte bir sorgulanmalıdır. <strong>Sık sorgulama yapmayınız.</strong></p></li>
<li><p><strong>GetDespatchAdvice</strong> metodu ile firmaya gelen irsaliyeleri müşteri bilgisayarına aktarılır. Sisteme gelen yeni irsaliyeleri almanız gerekmektedir. Servis ile yeni gelen en fazla 100 adet belgeyi çekebilirsiniz. Eğer dönen listede 100 adet kayıt varsa yeniden <strong>GetDespatchAdvice</strong> servisi çağırılarak başka belge olup olmadığı kontrol edilmelidir. Dönen listede 100den az kayıt varsa tekrar sorgulama yapmaya gerek yoktur.</p></li>
<li><p><strong>MarkDespatchAdvice</strong> metodu ile başarılı şekilde teslim alınan irsaliyeler eirsaliye sisteminde okundu olarak işaretlenir. Böylece bir sonra ki <strong>GetDespatchAdvice</strong> servisi çağrılınca aynı kayıt dönülmez.</p></li>
<li><p><strong>Logout</strong> metodu ile kullanıcı e-fatura programını kapatınca veya sizin belirlediğiniz bir sürede oturumu
kapatabilirsiniz.</p></li>
</ol>

<h2 id="entegrasyon-test-senaryolar">Entegrasyon Test Senaryoları</h2>

<h2 id="hata-sonu-nesnesi">Hata Sonuç Nesnesi</h2>

<p>Webservis metodunda hata oluşması durumunda response objesi içerisinde <code class="prettyprint">ERROR_TYPE</code> tipinde sonuç dönülecektir.</p>

<p>Servisten dönen hata sonuç nesnesi şu şekildedir:</p>

<table><thead>
<tr>
<th>Parametre</th>
<th>Tip</th>
<th>Açıklama</th>
</tr>
</thead><tbody>
<tr>
<td><strong>ERROR_TYPE.INTL_TXN_ID</strong></td>
<td>String</td>
<td>Sunucuda işlemin gerçekleştirildiği transaction IDsi. Bu ID istemci tarafında kaydedilerek oluşabilecek hatalarda referans olarak destek ekibine iletilebilir.</td>
</tr>
<tr>
<td><strong>ERROR_TYPE.ERROR_CODE</strong></td>
<td>String</td>
<td>Başarısız işlemlerde <code class="prettyprint">-1</code> değeri döner.</td>
</tr>
<tr>
<td><strong>ERROR_TYPE.ERROR_SHORT_DESC</strong></td>
<td>String</td>
<td>Hatanın kısa açıklaması.</td>
</tr>
</tbody></table>

<h2 id="hata-kodlar">Hata Kodları</h2>

<table><thead>
<tr>
<th>Hata Kodu</th>
<th>Açıklama</th>
</tr>
</thead><tbody>
<tr>
<td>-1</td>
<td>Sistem Hatası</td>
</tr>
<tr>
<td>10001</td>
<td>İşlem Başarısız Oldu</td>
</tr>
<tr>
<td>10002</td>
<td>Oturum Oluşturulamadı</td>
</tr>
<tr>
<td>10003</td>
<td>İrsaliye Şematrondan Geçemedi</td>
</tr>
<tr>
<td>10004</td>
<td>Geçersiz Oturum</td>
</tr>
<tr>
<td>10005</td>
<td>Hesabınız belirtilen ürün göndermek için aktif degildir</td>
</tr>
<tr>
<td>10006</td>
<td>Yetkiniz bulunmamaktadır</td>
</tr>
<tr>
<td>10007</td>
<td>Zip dosya içermelidir</td>
</tr>
<tr>
<td>10008</td>
<td>Kayıt Bulunamamıştır.</td>
</tr>
<tr>
<td>10009</td>
<td>İrsaliye UUID/ID daha önce gönderilmiş bir İrsaliye ile Eşleşmektedir!</td>
</tr>
<tr>
<td>10010</td>
<td>Zarf boyut sınırını aştı</td>
</tr>
<tr>
<td>10011</td>
<td>Gönderilen istek  aynı dökuman bulunmaktadır.</td>
</tr>
<tr>
<td>10012</td>
<td>Kullanıcı aktif degil</td>
</tr>
<tr>
<td>10013</td>
<td>Gönderilen istek geçersizdir.</td>
</tr>
<tr>
<td>10014</td>
<td>Geçersiz İmza.</td>
</tr>
<tr>
<td>10015</td>
<td>Gönderilen istek sistemde mevcut değildir</td>
</tr>
<tr>
<td>10016</td>
<td>Müşteri sistemde aktif degildir.</td>
</tr>
<tr>
<td>10017</td>
<td>Yetkisiz erişim tepit edildi!</td>
</tr>
</tbody></table>

<h2 id="ortak-kullan-lan-eleman">Ortak Kullanılan Eleman</h2>

<p>Her webservis isteğinde gönderilmesi beklen ortak elemandır (REQUEST_HEADER)</p>

<table><thead>
<tr>
<th>Parametre</th>
<th>Tip</th>
<th>Zorunluluk</th>
<th>Açıklama</th>
</tr>
</thead><tbody>
<tr>
<td><strong>SESSION_ID</strong></td>
<td>String</td>
<td><strong>Evet</strong></td>
<td>Login Metodunda sistem tarafında gönderilen SESSION_ID bilgisi. Sonraki tüm metod çağrılarında parametre olarak metoda geçmelidir.</td>
</tr>
<tr>
<td><strong>APPLICATION_NAME</strong></td>
<td>String</td>
<td><strong>Evet</strong></td>
<td>Metodu çağıran uygulamanın adı. Mutlaka uygulama adının yazılması gerekmektedir.</td>
</tr>
<tr>
<td><strong>CHANNEL_NAME</strong></td>
<td>String</td>
<td><strong>Evet</strong></td>
<td>Metodun çağrıldığı kanal adı.</td>
</tr>
<tr>
<td><strong>COMPRESSED</strong></td>
<td>String</td>
<td>Hayır</td>
<td>İçerikte taşınan bilginin ZIP formatında sıkıştırılmış mı gönderildiği/talep edildiği bilgisi. Belge gönderim ve belge okuma servislerinde gönderilen değere göre işlem yapılmaktadır.</td>
</tr>
<tr>
<td><strong>CLIENT_TXN_ID</strong></td>
<td>String</td>
<td>Hayır</td>
<td>İstemci uygulama tarafından işlem için üretilen işlem bilgisi (transaction id) varsa istek esnasında gönderilip, sonuçta alabileceğiniz bir değerdir. request/response eşleşmesi yapmak için kullanılabilir.</td>
</tr>
<tr>
<td><strong>INT_PARENT_TXN_ID</strong></td>
<td>String</td>
<td>Hayır</td>
<td>İstemci uygulamasında ana modül entitileri ile ilişkilendirelmek istenen ana transaction ID.</td>
</tr>
<tr>
<td><strong>ACTION_DATE</strong></td>
<td>String</td>
<td>Hayır</td>
<td>Metodun çağrılma tarihi</td>
</tr>
<tr>
<td><strong>CHANGE_INFO</strong></td>
<td>Array</td>
<td>Hayır</td>
<td>Bu eleman ile eğer verilerde bir değişiklik yapılacak ise o değişikliği ait bilgi.</td>
</tr>
<tr>
<td><strong>REASON</strong></td>
<td>String</td>
<td>Hayır</td>
<td>İşlem sebebi. Fatura gönderme, fatura alma vs.</td>
</tr>
<tr>
<td><strong>HOST_NAME</strong></td>
<td>String</td>
<td>Hayır</td>
<td>Metodu çağıran sunucunun host bilgisi.</td>
</tr>
<tr>
<td><strong>SIMULATION_FLAG</strong></td>
<td>String</td>
<td>Hayır</td>
<td>Metod çağrılır ancak arkadaki işlem yapılmaz.</td>
</tr>
</tbody></table>

<h2 id="taslak-rsaliye-y-kleme-loaddespatchadvice">Taslak İrsaliye Yükleme (LoadDespatchAdvice)</h2>

<ul>
<li>Özel entegratör platformu üzerinden 1 yada daha fazla irsaliyeyi sisteme yükler.</li>
<li>Eğer irsaliye numarası atanmışsa (16 hane ise) şema ve şematron kontrolünden geçirilir. İrsaliye numarası atanmamışsa şema ve şematron kontrolü yapılmaz.</li>
<li>Aynı İrsaliye tekrar taslaklara yüklenmesine müsade edilir. Farklı kayıt oluşturulmaz. Oluşan kayıt yeni içerik ile güncellenir.</li>
</ul>

<p><br>
Servise gönderilmesi gereken parametreler şu şekildedir:</p>

<table><thead>
<tr>
<th>Parametre</th>
<th>Tip</th>
<th>Zorunluluk</th>
<th>Açıklama</th>
</tr>
</thead><tbody>
<tr>
<td><strong>REQUEST_HEADER</strong></td>
<td>ComplexType</td>
<td><strong>Evet</strong></td>
<td>Request Header objesi içerisinde <code class="prettyprint">SESSION_ID</code> ve <code class="prettyprint">APPLICATION_NAME</code> alanı zorunludur. İrsaliye sıkıştırılarak/ziplenerek gönderiliyorsa <code class="prettyprint">COMPRESSED</code> alanı gönderilmeyebilir veya <code class="prettyprint">Y</code> olarak gönderilebilir. <strong>XML formatında sıkıştırılmadan yüklemek için mutlaka <code class="prettyprint">COMPRESSED</code> eleman eklenmeli ve <code class="prettyprint">N</code> değeri gönderilmelidir.</strong></td>
</tr>
<tr>
<td><strong>DESPATCHADVICE</strong></td>
<td>ComplexType</td>
<td><strong>Evet</strong></td>
<td>İrsaliye numarasını <code class="prettyprint">ID</code> attribute içerisine, Evrensel tekil tanımlama numarasını (ETTN) <code class="prettyprint">UUID</code> attribute eklenmelidir.</td>
</tr>
<tr>
<td><strong>DESPATCHADVICE.CONTENT</strong></td>
<td>Base64Binary</td>
<td>Evet</td>
<td>İrsaliyenin Base64Binary olarak encode edilmiş XML veya Ziplenmiş içeriği. Bir istek ile çoklu XML gönderimi yapılabilir. <strong>Birden fazla irsaliye göndermek için DESPATCHADVICE elemanı çoklanmalıdır.</strong></td>
</tr>
</tbody></table>

<p><br><br></p>

<p>Servisten dönen parametreler şu şekildedir:</p>

<table><thead>
<tr>
<th>Parametre</th>
<th>Tip</th>
<th>Açıklama</th>
</tr>
</thead><tbody>
<tr>
<td><strong>REQUEST_RETURN.INTL_TXN_ID</strong></td>
<td>String</td>
<td>Sunucuda işlemin gerçekleştirildiği transaction IDsi. Bu ID istemci tarafında kaydedilerek oluşabilecek hatalarda referans olarak destek ekibine iletilebilir.</td>
</tr>
<tr>
<td><strong>REQUEST_RETURN.RETURN_CODE</strong></td>
<td>String</td>
<td>Başarılı durumlarda <code class="prettyprint">0</code> değeri döner. Başarısız olduğunda request return objesi dönülmez.</td>
</tr>
<tr>
<td><strong>REQUEST_RETURN.CLIENT_TXN_ID</strong></td>
<td>String</td>
<td>İstek ile istemci tarafından işlem IDsi gönderilmişse sonuç ile beraber dönülür.</td>
</tr>
</tbody></table>

<h2 id="e-rsaliye-g-nderme-senddespatchadvice">E-İrsaliye Gönderme (SendDespatchAdvice)</h2>

<ul>
<li>E-İrsaliye Platformu üzerinden 1 ya da daha fazla e-irsaliyeyi GIB (Gelir İdaresi Başkanlığı) E-İrsaliye
sistemine gönderir.</li>
<li>E-İrsaliye gönderim esnasında hatalı duruma geçen irsaliyeler bu servis ile tekrar gönderilebilir.</li>
<li>Bir alıcıya birden fazla irsaliye gönderilebilir.</li>
</ul>

<p><br>
Servise gönderilmesi gereken parametreler şu şekildedir:</p>

<table><thead>
<tr>
<th>Parametre</th>
<th>Tip</th>
<th>Zorunluluk</th>
<th>Açıklama</th>
</tr>
</thead><tbody>
<tr>
<td><strong>REQUEST_HEADER</strong></td>
<td>ComplexType</td>
<td><strong>Evet</strong></td>
<td>Request Header objesi içerisinde <code class="prettyprint">SESSION_ID</code> ve <code class="prettyprint">APPLICATION_NAME</code> alanı zorunludur. İrsaliye sıkıştırılarak/ziplenerek gönderiliyorsa <code class="prettyprint">COMPRESSED</code> alanı gönderilmeyebilir veya <code class="prettyprint">Y</code> olarak gönderilebilir. <strong>XML formatında sıkıştırılmadan yüklemek için mutlaka <code class="prettyprint">COMPRESSED</code> eleman eklenmeli ve <code class="prettyprint">N</code> değeri gönderilmelidir.</strong></td>
</tr>
<tr>
<td><strong>SENDER</strong></td>
<td>String</td>
<td>Hayır</td>
<td>İrsaliye gönderen tarafın vergi kimlik numarasını <code class="prettyprint">vkn</code> attribute içerisine, gönderici birim etiketini <code class="prettyprint">alias</code> attribute eklenmelidir. Eğer eleman gönderilmezse oturum açılan kullanıcının bağlı olduğu hesapta ki VKN ve gönderici birim etiketi kullanılacaktır. <strong>Sender elemanı gönderilmesini tavsiye ederiz.</strong></td>
</tr>
<tr>
<td><strong>RECEIVER</strong></td>
<td>String</td>
<td>Hayır</td>
<td>İrsaliye alan tarafının vergi kimlik numarasını <code class="prettyprint">vkn</code> attribute içerisine, posta kutusu etiketini <code class="prettyprint">alias</code> attribute içerisine eklenmelidir. Eğer eleman gönderilmezse fatura içerisinde ki alıcı taraf (AccountingCustomerParty) içerisinde ki VKN ve o VKN için tanımlanmış herhangi bir posta kutusu etiketi kullanılacaktır. <strong>Receiver elemanı gönderilmesini tavsiye ederiz. Özellikle alıcı tarafından posta kutusu tercihi talep edilmişse bu eleman kullanılmalıdır.</strong></td>
</tr>
<tr>
<td><strong>DESPATCHADVICE.CONTENT</strong></td>
<td>Base64Binary</td>
<td><strong>Evet</strong></td>
<td>İrsaliyenin Base64Binary olarak encode edilmiş XML veya Ziplenmiş içeriği. Bir istek ile çoklu XML gönderimi yapılabilir. <strong>Birden fazla irsaliye göndermek için DESPATCHADVICE elemanı çoklanmalıdır.</strong></td>
</tr>
</tbody></table>

<p><br><br></p>

<p>Servisten dönen parametreler şu şekildedir:</p>

<table><thead>
<tr>
<th>Parametre</th>
<th>Tip</th>
<th>Açıklama</th>
</tr>
</thead><tbody>
<tr>
<td><strong>REQUEST_RETURN.INTL_TXN_ID</strong></td>
<td>String</td>
<td>Sunucuda işlemin gerçekleştirildiği transaction IDsi. Bu ID istemci tarafında kaydedilerek oluşabilecek hatalarda referans olarak destek ekibine iletilebilir.</td>
</tr>
<tr>
<td><strong>REQUEST_RETURN.RETURN_CODE</strong></td>
<td>String</td>
<td>Başarılı durumlarda <code class="prettyprint">0</code> değeri döner. Başarısız olduğunda request return objesi dönülmez.</td>
</tr>
<tr>
<td><strong>REQUEST_RETURN.CLIENT_TXN_ID</strong></td>
<td>String</td>
<td>İstek ile istemci tarafından işlem IDsi gönderilmişse sonuç ile beraber dönülür.</td>
</tr>
</tbody></table>

<h2 id="e-rsaliye-okuma-getdespatchadvice">E-İrsaliye Okuma (GetDespatchAdvice)</h2>

<ul>
<li>E-İrsaliye sisteminden giden imzalı irsaliye veya gelen irsaliyeyi ERP/muhasebe paketine çekmek için kullanılır.</li>
<li>İrsaliye özet bilgilerini veya irsaliye özet bilgileri ile beraber XML içeriğini de çekmek için kullanılabilir.</li>
<li>Entegrasyon yapan iş ortaklarımızdan yeni gelen bütün irsaliye içerikleri (XML) beraber müşteri ortamına çekilmesini tavsiye ediyoruz.</li>
<li>İçerik ile beraber en fazla 100 fatura çekilebilir.</li>
<li>Fatura özet bilgileri ile en fazla 25000 adet fatura dönülmektedir.</li>
<li>Alıcı tarafından zamanlanmış fatura çekme özelliği eklenecekse en fazla 15 dakika aralığında olmalıdır.</li>
</ul>

<p><br>
Servise gönderilmesi gereken parametreler şu şekildedir:</p>

<table><thead>
<tr>
<th>Parametre</th>
<th>Tip</th>
<th>Zorunluluk</th>
<th>Açıklama</th>
</tr>
</thead><tbody>
<tr>
<td><strong>REQUEST_HEADER</strong></td>
<td>ComplexType</td>
<td><strong>Evet</strong></td>
<td>Request Header objesi içerisinde <code class="prettyprint">SESSION_ID</code> ve <code class="prettyprint">APPLICATION_NAME</code> alanı zorunludur. Faturaları XML formatında sıkıştırılmadan çekmek için mutlaka <code class="prettyprint">COMPRESSED</code> elemanı eklenmeli ve <code class="prettyprint">N</code> değeri gönderilmelidir. Eğer gönderilmezse faturalar sıkıştırılmış/ziplenmiş olarak dönülecektir.</td>
</tr>
<tr>
<td><strong>SEARCH_KEY.LIMIT</strong></td>
<td>String</td>
<td>Hayır</td>
<td>Kaç kayıt okunmak istendiği. Eğer eleman gönderilmezse 10 adet, içerikleri (XML) ile beraber en fazla 100 adet, sadece özet/başlıklarını çekildiğinde ise en fazla 25.000 adet kayıt dönülür.</td>
</tr>
<tr>
<td><strong>SEARCH_KEY.FROM</strong></td>
<td>String</td>
<td>Hayır</td>
<td>Gönderici firma gönderici birim (GB) etiketine göre çekmek için kullanılabilir. Örneğin birden fazla GB etiketi olan bir firmanın sadece muhasebe departmanından gelen belgeleri okumak için kullanılabilir. örnek: urn:mail:muhasebegb@firma.com</td>
</tr>
<tr>
<td><strong>SEARCH_KEY.TO</strong></td>
<td>String</td>
<td>Hayır</td>
<td>Birden fazla Posta Kutusu (PK) etiketi olan bir firmanın sadece bir PK adresine gelen belgeleri çekmek için kullanılabilir. Eğer etiket gönderilmez ise kullanıcının yetkisine bağlı olarak bütün irsaliyeler dönülür. urn:mail:muhasebepk@firma.com</td>
</tr>
<tr>
<td><strong>SEARCH_KEY.ID</strong></td>
<td>String</td>
<td>Hayır</td>
<td>İrsaliye numarası ile okumak için kullanılabilir. örnek: FYA2018000000001</td>
</tr>
<tr>
<td><strong>SEARCH_KEY.UUID</strong></td>
<td>String</td>
<td>Hayır</td>
<td>Evrensel Tekil Tanımlama Numarası (ETTN) ile okumak için kullanılabilir.  GUID formatında</td>
</tr>
<tr>
<td><strong>SEARCH_KEY.START_DATE</strong></td>
<td>String</td>
<td>Hayır</td>
<td>Belirli tarih aralığında ki irsaliyeleri çekmek istendiğinde dönem başlangıç tarihi. format: YYYY-MM-DD</td>
</tr>
<tr>
<td><strong>SEARCH_KEY.END_DATE</strong></td>
<td>String</td>
<td>Hayır</td>
<td>Belirli tarih aralığında ki irsaliyeleri çekmek istendiğinde dönem bitiş tarihi format: YYYY-MM-DD</td>
</tr>
<tr>
<td><strong>SEARCH_KEY.READ_INCLUDED</strong></td>
<td>String</td>
<td>Hayır</td>
<td>Daha önce okunmuş irsaliyeleri dönüşe dahil edilip edilmeyeceğini belirleyen parametredir. <code class="prettyprint">Y</code> değeri gönderilirse daha önce okunmuş olsa bile yanıta eklenir. Gönderilmezse veya <code class="prettyprint">N</code> gönderilirse sadece yeni gelen irsaliyeler dönülür. Gönderilebilecek değerler: Y/N</td>
</tr>
<tr>
<td><strong>SEARCH_KEY.DIRECTION</strong></td>
<td>String</td>
<td>Hayır</td>
<td>Belge yönü. Gelen veya Giden irsaliyeleri çekmek için kullanılabilir. Gelen irsaliyeleleri çekmek için <code class="prettyprint">IN</code>, giden irsaliyeleleri çekmek için <code class="prettyprint">OUT</code> değeri gönderilebilir. Varsayılan değer <code class="prettyprint">IN</code> olduğu için eğer parametre gönderilmezse sadece gelen irsaliyeler dönülecektir.  Gönderilebilecek değerler: <code class="prettyprint">IN</code>, <code class="prettyprint">OUT</code></td>
</tr>
<tr>
<td><strong>SEARCH_KEY.SENDER</strong></td>
<td>String</td>
<td>Hayır</td>
<td>Sadece bir firmadan gelen irsaliyeleri çekmek için göndericinin VKNsi.</td>
</tr>
<tr>
<td><strong>SEARCH_KEY.RECEIVER</strong></td>
<td>String</td>
<td>Hayır</td>
<td>Alıcı firma VKNsi.</td>
</tr>
<tr>
<td><strong>HEADER_ONLY</strong></td>
<td>String</td>
<td>Hayır</td>
<td>Sadece özet değerler mi yoksa içerik ile beraber mi okunmak istenildiğini belirleyen parametredir. Eleman <strong>gönderilmezse</strong> veya <code class="prettyprint">N</code> değeri gönderilirse irsaliyeler XML ile beraber dönülür. <code class="prettyprint">Y</code> değeri gönderilirse irsaliyelerin özeti dönülür.  Gönderilebilecek değerler: Y/N</td>
</tr>
</tbody></table>

<p><br><br></p>

<p>Servisten dönen parametreler şu şekildedir:</p>

<table><thead>
<tr>
<th>Parametre</th>
<th>Tip</th>
<th>Açıklama</th>
</tr>
</thead><tbody>
<tr>
<td><strong>DESPATCHADVICE</strong></td>
<td>ComplexType</td>
<td>Sorgu kriterine uyan irsaliyelerin listesi. İrsaliye numarası <code class="prettyprint">ID</code>, evrensel tekil tanımlama numarası  <code class="prettyprint">UUID</code> ve e-irsaliye sisteminde tanımlı tekil numara değeri  <code class="prettyprint">LIST_ID</code> attribute içerisinde dönülmektedir.</td>
</tr>
<tr>
<td><strong>DESPATCHADVICE.HEADER</strong></td>
<td>ComplexType</td>
<td>İrsaliyeye ait özet bilgiler içermektedir.</td>
</tr>
<tr>
<td><strong>HEADER.SENDER</strong></td>
<td>String</td>
<td>Belgeyi gönderen firma VKN&#39;si.</td>
</tr>
<tr>
<td><strong>HEADER.RECEIVER</strong></td>
<td>String</td>
<td>Belgeyi alan firma VKN&#39;si.</td>
</tr>
<tr>
<td><strong>HEADER.SUPPLIER</strong></td>
<td>String</td>
<td>Belgeyi gönderen firma ünvanı.</td>
</tr>
<tr>
<td><strong>HEADER.CUSTOMER</strong></td>
<td>String</td>
<td>Belgeyi alan firma ünvanı.</td>
</tr>
<tr>
<td><strong>HEADER.ISSUE_DATE</strong></td>
<td>String</td>
<td>Belge tarihi.</td>
</tr>
<tr>
<td><strong>HEADER.PAYABLE_AMOUNT</strong></td>
<td>String</td>
<td>Toplam ödenecek tutar.</td>
</tr>
<tr>
<td><strong>HEADER.FROM</strong></td>
<td>String</td>
<td>Belgeyi gönderen Gönderici Birim (GB)</td>
</tr>
<tr>
<td><strong>HEADER.TO</strong></td>
<td>String</td>
<td>Belgenin gönderildiği Posta Kutusu (PK)</td>
</tr>
<tr>
<td><strong>HEADER.PROFILEID</strong></td>
<td>String</td>
<td>Belge senaryosu. <code class="prettyprint">TEMELIRSALIYE</code> değeri olabilir.</td>
</tr>
<tr>
<td><strong>HEADER.INVOICE_TYPE_CODE</strong></td>
<td>String</td>
<td>Belgenin tipi. <code class="prettyprint">SEVK</code> değeri olabilir.</td>
</tr>
<tr>
<td><strong>HEADER.STATUS</strong></td>
<td>String</td>
<td>Belgenin durumu. Detay için <strong>E-İrsaliye Durumları</strong> başlığını inceleyiniz.</td>
</tr>
<tr>
<td><strong>HEADER.STATUS_DESCRIPTION</strong></td>
<td>String</td>
<td>Belge durum açıklaması. Detay için <strong>E-İrsaliye Durumları</strong> başlığını inceleyiniz.</td>
</tr>
<tr>
<td><strong>HEADER.GIB_STATUS_CODE</strong></td>
<td>String</td>
<td>Belgenin GİB&#39;de ki durum kodu. Detay için <strong>GİB Durum Kodları</strong> başlığını inceleyiniz.</td>
</tr>
<tr>
<td><strong>HEADER.GIB_STATUS_DESCRIPTION</strong></td>
<td>String</td>
<td>Belgenin GİB&#39;de ki durum kodunun açıklaması. Detay için <strong>GİB Durum Kodları</strong> başlığını inceleyiniz.</td>
</tr>
<tr>
<td><strong>HEADER.CDATE</strong></td>
<td>String</td>
<td>Belgenin sisteme ulaştığı tarih</td>
</tr>
<tr>
<td><strong>HEADER.ENVELOPE_IDENTIFIER</strong></td>
<td>String</td>
<td>Belgenin zarf IDsi.</td>
</tr>
<tr>
<td><strong>DESPATCHADVICE_CONTENT</strong></td>
<td>Base64Binary</td>
<td>Belgenin içeriği. Eğer <code class="prettyprint">COMPRESSED</code> parametresi <code class="prettyprint">N</code> olarak gönderilmişse XML dosya, <code class="prettyprint">COMPRESSED</code> elemanı gönderilmemiş veya <code class="prettyprint">Y</code> değeri gönderilmişse sıkıştırılmış/ziplenmiş XML dosyası dönülür.</td>
</tr>
</tbody></table>

<h2 id="e-rsaliye-durum-sorgulama-getdespatchadvicestatus">E-İrsaliye Durum Sorgulama (GetDespatchAdviceStatus)</h2>

<ul>
<li>Entegrasyon platformunda bulunan bir veya birden fazla taslak, gelen ve giden irsaliyenin durumunu sorgulamayı sağlayan servistir.</li>
<li>Birden fazla belge durumu sorgulamak için <code class="prettyprint">DESPATCHADVICEINFO</code> parametresi çoklanabilir.</li>
</ul>

<p>Servise gönderilmesi gereken parametreler şu şekildedir:</p>

<table><thead>
<tr>
<th>Parametre</th>
<th>Tip</th>
<th>Zorunluluk</th>
<th>Açıklama</th>
</tr>
</thead><tbody>
<tr>
<td><strong>REQUEST_HEADER</strong></td>
<td>ComplexType</td>
<td><strong>Evet</strong></td>
<td>Request Header objesi içerisinde <code class="prettyprint">SESSION_ID</code> ve <code class="prettyprint">APPLICATION_NAME</code> alanı zorunludur.</td>
</tr>
<tr>
<td><strong>DESPATCHADVICEINFO</strong></td>
<td>String</td>
<td><strong>Evet</strong></td>
<td>Sorgulanacak belge numarası <code class="prettyprint">ID</code> attribute içerisine, Evrensel Tekil Tanımlama Numarası (ETTN) ise <code class="prettyprint">UUID</code> attribute eklenmelidir. <code class="prettyprint">DIRECTION</code> attribute kullanılmamaktadır.</td>
</tr>
</tbody></table>

<p>Servisten dönen parametreler şu şekildedir:</p>

<table><thead>
<tr>
<th>Parametre</th>
<th>Tip</th>
<th>Açıklama</th>
</tr>
</thead><tbody>
<tr>
<td><strong>DESPATCHADVICE</strong></td>
<td>ComplexType</td>
<td>Sorgu kriterine uyan irsaliyelerin listesi. İrsaliye numarası <code class="prettyprint">ID</code>, evrensel tekil tanımlama numarası  <code class="prettyprint">UUID</code> ve e-irsaliye sisteminde tanımlı tekil numara değeri  <code class="prettyprint">LIST_ID</code> attribute içerisinde dönülmektedir.</td>
</tr>
<tr>
<td><strong>DESPATCHADVICE.DESPATCHADVICEHEADER</strong></td>
<td>ComplexType</td>
<td>İrsaliyeye ait özet bilgiler içermektedir.</td>
</tr>
<tr>
<td><strong>DESPATCHADVICEHEADER.ID</strong></td>
<td>String</td>
<td>Belgenin numarası.</td>
</tr>
<tr>
<td><strong>DESPATCHADVICEHEADER.UUID</strong></td>
<td>String</td>
<td>Belgenin evrensel tekil tanımlama numarası.</td>
</tr>
<tr>
<td><strong>DESPATCHADVICEHEADER.PROFILEID</strong></td>
<td>String</td>
<td>Belge senaryosu. <code class="prettyprint">TEMELIRSALIYE</code> değeri olabilir.</td>
</tr>
<tr>
<td><strong>DESPATCHADVICEHEADER.TYPE_CODE</strong></td>
<td>String</td>
<td>Belgenin tipi. <code class="prettyprint">SEVK</code> değeri olabilir.</td>
</tr>
<tr>
<td><strong>DESPATCHADVICEHEADER.SENDER</strong></td>
<td>String</td>
<td>Belgeyi gönderen firmanın VKNsi <code class="prettyprint">VKN</code> attribute içerisinde, firma ünvanı ise <code class="prettyprint">IDENTIFIER</code> attribute içerisinde dönülmektedir.</td>
</tr>
<tr>
<td><strong>DESPATCHADVICEHEADER.RECEIVER</strong></td>
<td>String</td>
<td>Belgeyi alan firmanın VKNsi <code class="prettyprint">VKN</code> attribute içerisinde, firma ünvanı ise <code class="prettyprint">IDENTIFIER</code> attribute içerisinde dönülmektedir.</td>
</tr>
<tr>
<td><strong>DESPATCHADVICEHEADER.ISSUE_DATE</strong></td>
<td>Date</td>
<td>Belge tarihi.</td>
</tr>
<tr>
<td><strong>DESPATCHADVICEHEADER.ISSUE_TIME</strong></td>
<td>String</td>
<td>Belge düzenleme zamanı.</td>
</tr>
<tr>
<td><strong>DESPATCHADVICEHEADER.ACTUAL_SHIPMENT_DATE</strong></td>
<td>Date</td>
<td>Fiili sevk tarihi.</td>
</tr>
<tr>
<td><strong>DESPATCHADVICEHEADER.ACTUAL_SHIPMENT_TIME</strong></td>
<td>String</td>
<td>Fiili sevk zamanı.</td>
</tr>
<tr>
<td><strong>DESPATCHADVICEHEADER.DIRECTION</strong></td>
<td>String</td>
<td>Belge yönü. Gelen irsaliye için <code class="prettyprint">IN</code>, giden irsaliye için <code class="prettyprint">OUT</code> değeri dönülür.</td>
</tr>
<tr>
<td><strong>DESPATCHADVICEHEADER.STATUS</strong></td>
<td>String</td>
<td>Belgenin durumu. Lütfen bu alanı kullanarak karar vermeyin. Karar vermek için <code class="prettyprint">STATUS_CODE</code> alanını kullanınız.</td>
</tr>
<tr>
<td><strong>DESPATCHADVICEHEADER.STATUS_CODE</strong></td>
<td>String</td>
<td>Belgenin durum kodu. Detay için <strong>İrsaliye Durumları</strong> başlığını inceleyiniz.</td>
</tr>
<tr>
<td><strong>DESPATCHADVICEHEADER.STATUS_DESCRIPTION</strong></td>
<td>String</td>
<td>Belgenin durum açıklaması. Detay için <strong>İrsaliye Durumları</strong> başlığını inceleyiniz.</td>
</tr>
<tr>
<td><strong>DESPATCHADVICEHEADER.GIB_STATUS_CODE</strong></td>
<td>int</td>
<td>Belgenin GİB&#39;de ki durum kodu. Detay için <strong>GİB Durum Kodları</strong> başlığını inceleyiniz.</td>
</tr>
<tr>
<td><strong>DESPATCHADVICEHEADER.GIB_STATUS_DESCRIPTION</strong></td>
<td>String</td>
<td>Belgenin GİB&#39;de ki durum kodunun açıklaması. Detay için <strong>GİB Durum Kodları</strong> başlığını inceleyiniz.</td>
</tr>
<tr>
<td><strong>DESPATCHADVICEHEADER.CDATE</strong></td>
<td>DateTime</td>
<td>Belgenin sisteme ulaştığı/yüklendiği tarih</td>
</tr>
<tr>
<td><strong>DESPATCHADVICEHEADER.ENVELOPE_IDENTIFIER</strong></td>
<td>String</td>
<td>Belgenin zarf IDsi.</td>
</tr>
</tbody></table>

<h3 id="e-rsaliye-durumlar">E-İrsaliye Durumları</h3>

<table><thead>
<tr>
<th>Durum</th>
<th>Kod</th>
<th>Detaylı Açıklama</th>
</tr>
</thead><tbody>
<tr>
<td>DURUM_HENUZ_GUNCELLENMEDI</td>
<td>100</td>
<td>DURUM HENÜZ GÜNCELLENMEDİ</td>
</tr>
<tr>
<td>LOAD_SUCCEED</td>
<td>101</td>
<td>KUYRUĞA EKLENDİ</td>
</tr>
<tr>
<td>LOAD_PROCESSİNG</td>
<td>102</td>
<td>TASLAK İŞLENİYOR</td>
</tr>
<tr>
<td>PACKAGE_PROCESSING</td>
<td>103</td>
<td>PAKETLENİYOR</td>
</tr>
<tr>
<td>PACKAGE_SUCCEED</td>
<td>104</td>
<td>PAKETLENDİ</td>
</tr>
<tr>
<td>PACKAGE_FAILED</td>
<td>105</td>
<td>PAKETLEME_HATASI</td>
</tr>
<tr>
<td>SIGN_PROCESSING</td>
<td>106</td>
<td>İMZALANIYOR</td>
</tr>
<tr>
<td>SIGN_FAILED</td>
<td>106</td>
<td>İMZALANIYOR</td>
</tr>
<tr>
<td>SIGN_SUCCEED</td>
<td>107</td>
<td>İMZALANDI</td>
</tr>
<tr>
<td>RECEIVE_SUCCEED</td>
<td>133</td>
<td>BAŞARIYLA ALINDI</td>
</tr>
<tr>
<td>SEND_TIMEOUT</td>
<td>134</td>
<td>GÖNDERME İŞLEMİ SİSTEM TARAFINDAN  TEKRAR DENENECEKTİR</td>
</tr>
<tr>
<td>RECEIVE_TIMEOUT</td>
<td>134</td>
<td>GÖNDERME İŞLEMİ SİSTEM TARAFINDAN  TEKRAR DENENECEKTİR</td>
</tr>
<tr>
<td>SEND_PROCESSING</td>
<td>135</td>
<td>GÖNDERİLİYOR</td>
</tr>
<tr>
<td>SEND_FAILED</td>
<td>136</td>
<td>GÖNDERME İŞLEMİ BAŞARISIZ</td>
</tr>
<tr>
<td>SEND_SUCCEED</td>
<td>137</td>
<td>GÖNDERME İŞLEMİ BAŞARILI</td>
</tr>
</tbody></table>

<h3 id="g-b-durum-kodlar">GİB Durum Kodları</h3>

<table><thead>
<tr>
<th>Kod</th>
<th>Açıklama</th>
<th>Alınacak Aksiyon</th>
</tr>
</thead><tbody>
<tr>
<td>1000</td>
<td>ZARF KUYRUĞA EKLENDİ</td>
<td>Durum kodunun güncellenmesi beklenmelidir.</td>
</tr>
<tr>
<td>1100</td>
<td>ZARF İŞLENİYOR</td>
<td>Durum kodunun güncellenmesi beklenmelidir.</td>
</tr>
<tr>
<td>1110</td>
<td>ZIP DOSYASI DEĞİL</td>
<td>Belge yeniden gönderilmeli</td>
</tr>
<tr>
<td>1111</td>
<td>ZARF ID UZUNLUĞU GEÇERSİZ</td>
<td>Belge yeniden gönderilmeli</td>
</tr>
<tr>
<td>1120</td>
<td>ZARF ARŞİVDEN KOPYALANAMADI</td>
<td>Belge yeniden gönderilmeli</td>
</tr>
<tr>
<td>1130</td>
<td>ZIP AÇILAMADI</td>
<td>Belge yeniden gönderilmeli</td>
</tr>
<tr>
<td>1131</td>
<td>ZIP BİR DOSYA İÇERMELİ</td>
<td>Belge yeniden gönderilmeli</td>
</tr>
<tr>
<td>1132</td>
<td>XML DOSYASI DEĞİL</td>
<td>Belge yeniden gönderilmeli</td>
</tr>
<tr>
<td>1133</td>
<td>ZARF ID VE XML DOSYASININ ADI AYNI OLMALI</td>
<td>Belge yeniden gönderilmeli</td>
</tr>
<tr>
<td>1140</td>
<td>DOKUMAN AYRIŞTIRILAMADI</td>
<td>Belge yeniden gönderilmeli</td>
</tr>
<tr>
<td>1141</td>
<td>ZARF ID YOK</td>
<td>Belge yeniden gönderilmeli</td>
</tr>
<tr>
<td>1142</td>
<td>ZARF ID VE ZIP DOSYASI ADI AYNI OLMALI</td>
<td>Belge yeniden gönderilmeli</td>
</tr>
<tr>
<td>1143</td>
<td>GEÇERSİZ VERSİYON</td>
<td>Belge yeniden gönderilmeli</td>
</tr>
<tr>
<td>1150</td>
<td>SCHEMATRON KONTROL SONUCU HATALI</td>
<td>Belge yeniden gönderilmeli</td>
</tr>
<tr>
<td>1160</td>
<td>XML SEMA KONTROLÜNDEN GEÇEMEDİ</td>
<td>Belge yeniden gönderilmeli</td>
</tr>
<tr>
<td>1161</td>
<td>İMZA SAHİBİ TCKN VKN ALINAMADI</td>
<td>Belge yeniden gönderilmeli</td>
</tr>
<tr>
<td>1162</td>
<td>İMZA KAYDEDİLEMEDİ</td>
<td>Belge yeniden gönderilmeli</td>
</tr>
<tr>
<td>1163</td>
<td>GÖNDERİLEN ZARF SİSTEMDE DAHA ÖNCE KAYITLI OLAN BİR FATURAYI İÇERMEKTEDİR</td>
<td>Belge yeniden gönderilmeli</td>
</tr>
<tr>
<td>1170</td>
<td>YETKİ KONTROL EDİLEMEDİ</td>
<td>Belge yeniden gönderilmeli</td>
</tr>
<tr>
<td>1171</td>
<td>GÖNDERİCİ BİRİM YETKİSİ YOK</td>
<td>Belge yeniden gönderilmeli</td>
</tr>
<tr>
<td>1172</td>
<td>POSTA KUTUSU YETKİSİ YOK</td>
<td>Belge yeniden gönderilmeli</td>
</tr>
<tr>
<td>1175</td>
<td>İMZA YETKİSİ KONTROL EDİLEMEDİ</td>
<td>Belge yeniden gönderilmeli</td>
</tr>
<tr>
<td>1176</td>
<td>İMZA SAHİBİ YETKİSİZ</td>
<td>Belge yeniden gönderilmeli</td>
</tr>
<tr>
<td>1177</td>
<td>GEÇERSİZ İMZA</td>
<td>Belge yeniden gönderilmeli</td>
</tr>
<tr>
<td>1180</td>
<td>ADRES KONTROL EDİLEMEDİ</td>
<td>Belge yeniden gönderilmeli</td>
</tr>
<tr>
<td>1181</td>
<td>ADRES BULUNAMADI</td>
<td>Belge yeniden gönderilmeli</td>
</tr>
<tr>
<td>1182</td>
<td>KULLANICI EKLENEMEDİ</td>
<td>Belge yeniden gönderilmeli</td>
</tr>
<tr>
<td>1183</td>
<td>KULLANICI SİLİNEMEDİ</td>
<td>Belge yeniden gönderilmeli</td>
</tr>
<tr>
<td>1190</td>
<td>SİSTEM YANITI HAZIRLANAMADI</td>
<td>Belge yeniden gönderilmeli</td>
</tr>
<tr>
<td>1195</td>
<td>SİSTEM HATASI</td>
<td>Belge yeniden gönderilmeli</td>
</tr>
<tr>
<td>1200</td>
<td>ZARF BAŞARIYLA İŞLENDİ</td>
<td>Özel entegratörden gönderilen Belgede sorun tespit edilmedi. Sonra ki aşamalara geçilecek.</td>
</tr>
<tr>
<td>1210</td>
<td>DOKUMAN BULUNAN ADRESE GÖNDERİLEMEDİ</td>
<td>GİB’in tekrar gönderme denemesi sonlandıktan sonra, 1215 durum kodu alınır ise belgeler yeniden gönderilmeli</td>
</tr>
<tr>
<td>1215</td>
<td>DOKÜMAN GÖNDERİMİ BAŞARISIZ. TEKRAR GÖNDERME SONLANDI</td>
<td>Belge yeniden gönderilmeli</td>
</tr>
<tr>
<td>1220</td>
<td>HEDEFTEN SİSTEM YANITI GELMEDİ</td>
<td>Bu durum kodundan sonra 1230 HEDEFTEN SİSTEM YANITI BAŞARISIZ GELDİ durum kodu alınır ise Belge yeniden gönderilmelidir.</td>
</tr>
<tr>
<td>1230</td>
<td>HEDEFTEN SİSTEM YANITI BAŞARISIZ GELDİ</td>
<td>Belge yeniden gönderilmeli</td>
</tr>
<tr>
<td>1300</td>
<td>BAŞARIYLA TAMAMLANDI</td>
<td>Başarılı olan Belge aynı numara ile gönderilemez.</td>
</tr>
</tbody></table>

          <h1 id="e-mustahsil-webservisi">E-Mustahsil Webservisi</h1>

<p>e-Müstahsil Makbuzu (e-MM) Uygulaması, müstahsil makbuzunun Gelir İdaresi Başkanlığı tarafından belirlenen standartlara uygun olarak elektronik ortamda oluşturulması, hem kağıt hem de elektronik ortamda muhafazası ve ibrazı ile elektronik ortamda raporlamasını kapsayan uygulamadır.</p>

<h2 id="g-b-dok-manlar">GİB Dokümanları</h2>

<table><thead>
<tr>
<th>Doküman</th>
<th>Açıklama</th>
<th>İndir</th>
</tr>
</thead><tbody>
<tr>
<td><strong>UBL-TR Müstahsil Makbuzu</strong></td>
<td>UBL-TR v1.2 (UBL 2.1 Türkiye Özelleştirmesi) paketinde yer alan müstahsil makbuzu  belgesinde geçen elemanlara ait XSD, tanımlama, kullanım şekilleri, kardinaliteler hakkında bilgi vermek ve örnek kullanım şekillerini göstermek amacı ile hazırlanmıştır.</td>
<td><a href="http://www.efatura.gov.tr/dosyalar/kilavuzlar/UBL-TR_Mustahsil_Makbuzu-V_1.0.pdf"><img src="/images/icon_pdf.png" height="40" width="35"/></a></td>
</tr>
<tr>
<td><strong>UBL-TR Ortak Elemanlar</strong></td>
<td>UBL-TR (UBL 2.1 Türkiye Özelleştirmesi) paketinde yer alan belgelerde geçmesi muhtemel elemanlara ait (ortak elemanlar örneğin: Adres, Parasal Toplamlar, Taraf gibi) XSD, açıklama, kullanım şartları, kardinaliteler hakkında bilgi vermek ve örnek kullanım şekillerini göstermek amacı ile hazırlanmıştır.</td>
<td><a href="/resource/BELGELER/UBL-TR Ortak Elemanlar - V 0.7.pdf"><img src="/images/icon_pdf.png" height="40" width="35"/></a></td>
</tr>
<tr>
<td><strong>UBL-TR Kod Listeleri</strong></td>
<td>UBL-TR kapsamında kullanılan Kodlama Sistemleri ve Kimlik Şemaları hakkında bilgi vermek amacı ile hazırlanmıştır.</td>
<td><a href="/resource/BELGELER/UBL-TR Kod Listeleri - V 1.18.pdf"><img src="/images/icon_pdf.png" height="40" width="35"/></a></td>
</tr>
</tbody></table>

<h2 id="ubl-mustahsil-makbuzu-senaryolar">UBL-Mustahsil Makbuzu Senaryoları</h2>

<p>E-Müstahsil Makbuzu sistemi üzerinden düzenlenebilecek ve gönderilebilecek e-müstahsil makbuzu senaryoları ve örnek  XML dosyaları aşağıda listelenmiştir.</p>

<table><thead>
<tr>
<th>Senaryosu</th>
<th>Açıklama</th>
<th>XML</th>
</tr>
</thead><tbody>
<tr>
<td><strong>Vergisiz Müstahsil Makbuzu</strong></td>
<td>En temel müstahsil makbuzu senaryosudur. İçerisinde hiç bir vergi (merafonu, borsa tescil, sgk prim kesintisi) bulunmamaktadır.</td>
<td><a href="/resource/xml/mustahsil_vergisiz.xml" target = "_blank" > <img src = "/images/icon_xml.png" height="40" width="35"/></a></td>
</tr>
<tr>
<td><strong>Mera Fonu Vergisi İçeren Müstahsil Makbuzu</strong></td>
<td>Mera Fonu Vergisi içeren müstahsil makbuzu senaryodur.</td>
<td><a href="/resource/xml/mustahsil_merafonu.xml" target="_blank"> <img src="/images/icon_xml.png" height="40" width="35"/></a></td>
</tr>
<tr>
<td><strong>Borsa Tescil İçeren Müstahsil Makbuzu</strong></td>
<td>Üreticiden borsa tescili bulunan ürün alımında düzenlenen müstahsil makbuzu senaryosudur.</td>
<td><a href="/resource/xml/mustahsil_borsatescil.xml" target="_blank"> <img src="/images/icon_xml.png" height="40" width="35"/></a></td>
</tr>
<tr>
<td><strong>SGK Prim (Bağkur) Kesintisi İçeren Müstahsil Makbuzu</strong></td>
<td>SGK Prim kesinitisi yapıldığı durumlarda düzenlenen müstahsil makbuzu senaryosudur.</td>
<td><a href="/resource/xml/mustahsil_bagkur.xml" target="_blank"> <img src="/images/icon_xml.png" height="40" width="35"/></a></td>
</tr>
</tbody></table>

<h2 id="webservice-endpoint-wsdl-url">Webservice Endpoint (WSDL) URL</h2>

<table><thead>
<tr>
<th>Ürün</th>
<th>Endpoint URL</th>
</tr>
</thead><tbody>
<tr>
<td>Kimlik Doğrulama</td>
<td><a href="https://efaturatest.izibiz.com.tr/AuthenticationWS?wsdl">https://efaturatest.izibiz.com.tr/AuthenticationWS?wsdl</a></td>
</tr>
<tr>
<td>E-Fatura Webservis</td>
<td><a href="https://efaturatest.izibiz.com.tr/EFaturaOIB?wsdl">https://efaturatest.izibiz.com.tr/EFaturaOIB?wsdl</a></td>
</tr>
<tr>
<td>E-Arşiv Fatura Webservis</td>
<td><a href="https://efaturatest.izibiz.com.tr/EIArchiveWS/EFaturaArchive?wsdl">https://efaturatest.izibiz.com.tr/EIArchiveWS/EFaturaArchive?wsdl</a></td>
</tr>
<tr>
<td>E-İrsaliye Webservis</td>
<td><a href="https://efaturatest.izibiz.com.tr/EIrsaliyeWS/EIrsaliye?wsdl">https://efaturatest.izibiz.com.tr/EIrsaliyeWS/EIrsaliye?wsdl</a></td>
</tr>
<tr>
<td>E-Müstahsil Webservis</td>
<td><a href="http://efaturatest.izibiz.com.tr/CreditNoteWS/CreditNote?wsdl">http://efaturatest.izibiz.com.tr/CreditNoteWS/CreditNote?wsdl</a></td>
</tr>
<tr>
<td>E-Mutabakat Webservis</td>
<td><a href="http://efaturatest.izibiz.com.tr/Reconciliation?wsdl">http://efaturatest.izibiz.com.tr/Reconciliation?wsdl</a></td>
</tr>
<tr>
<td>E-Serbest Meslek Webservis</td>
<td><a href="https://efaturatest.izibiz.com.tr/SmmWS?wsdl">https://efaturatest.izibiz.com.tr/SmmWS?wsdl</a></td>
</tr>
<tr>
<td>E-ZRapor Webservis</td>
<td><a href="https://efaturatest.izibiz.com.tr/ZReportWS?wsdl">https://efaturatest.izibiz.com.tr/ZReportWS?wsdl</a></td>
</tr>
</tbody></table>

<h3 id="portal-uygulamas">Portal Uygulaması</h3>

<p>Entegrasyon sürecinde Portal uygulamamızı aşağıda ki durumlar için kullanabilirsiniz:</p>

<ul>
<li>Belgelerin durumunu kontrol</li>
<li>Farklı senaryolar için belge düzenleyerek XML içeriğini kontrol</li>
<li>Alıcı firmanın mükellefiyet sorgulaması</li>
</ul>

<p>Test Portal Adresimiz: <a href="https://portaltest.izibiz.com.tr">https://portaltest.izibiz.com.tr</a></p>

<p>Test portali erişim bilgileri için <strong>entegrasyon@izibiz.com.tr</strong> adresi ile iletişime geçebilirsiniz.</p>

<h2 id="test-hesaplar">Test Hesaplar</h2>

<p>Test hesabı talep etmek için <strong>entegrasyon@izibiz.com.tr</strong> adresi ile iletişime geçebilirsiniz.
E-Müstahsil test sürecinde düzenlenen belgelerin gönderici VKNsi 4840847211 olmalıdır.</p>

<h2 id="dikkat-edilecek-hususlar">Dikkat Edilecek Hususlar</h2>

<p>E-Müstahsil uygulamanızı geliştirken aşağıda ki bilgiler faydalı olacaktır:</p>

<ol>
<li><strong>Kimlik Doğrulama (Authentication)</strong> Webservisinde bulunan <strong>Login</strong> metodu ile oturum açarak session id alınacaktır. Session Id sistemimiz tarafında 8 saate kadar zaman aşımına uğramadığı için kullanıcı giriş yapınca session id alıp bütün kullanım süresinde aynı session id kullanabilirsiniz.</li>
<li>Müstahsil makbuzu belgeleri UBL-TR CreditNote formatına dönüştürerek gönderilmelidir. Her dosya içerisinde görüntülenmesini sağlayan XSLT dokümanı olmalıdır.</li>
<li><strong>SendCreditNote</strong> metodu ile müstahsil makbuzu gönderimi yapılmaktadır.</li>
<li><strong>GetCreditNoteStatus</strong> metodu ile entegrasyon sunucularına yüklenen belgelerin durumları sorgulanacak. <strong>Sık sorgulama yapmayınız.</strong></li>
<li><strong>ReadCreditNote</strong> metodu ile yüklenen belgenin imzalı XML, PDF ve HTML formatında tekrar müşteri bilgisayarına çekmek için kullanılabilir.</li>
<li><strong>CancelCreditNote</strong> metodu ile eksik/hatalı oluşturulmuş veya müşteri tarafından iptal/iade edilmiş belgeleri GİB&#39;e iptal olarak raporlanmasını veya tamamen iptal edilerek hiç raporlanmamasını sağlayabilirsiniz.</li>
<li><strong>Kimlik Doğrulama (Authentication)</strong> Webservisinde bulunan  <strong>Logout</strong> metodu ile kullanıcı e-fatura programını kapatınca veya sizin belirlediğiniz bir sürede oturumu
kapatabilirsiniz.</li>
</ol>

<h2 id="stemci-client-rnek-projeler">İstemci (client) Örnek Projeler</h2>

<p>Yakında eklenecektir.</p>

<h2 id="m-stahsil-makbuz-s-n-f-creditnotetype-nas-l-retilir">Müstahsil Makbuz Sınıfı (CreditNoteType) Nasıl Üretilir ?</h2>

<ul>
<li>Müstahsil makubuzu GİB tarafından belirlenen UBL-TR CreditNote belgesi ile ürütilmekte ve saklanmaktadır.</li>
<li>GİB teknik kılavuzları içerisinde belgeye ait XML Schema Definition (XSD) dosyası bulunmaktadır.</li>
<li>Hazırlanan belgeler XSDye uygun olmalıdır.</li>
<li>Geliştirme ortamına bağlı olarak XSD dosyalarından sınıflar türütülerek belgeler oluşturulabilir.</li>
</ul>

<h3 id="net-ortam">.NET Ortamı</h3>

<p>.NET üzerinden XSD dosyasından sınıf üretmek için şu adımları uygulayınız:</p>

<ol>
<li>http://www.efatura.gov.tr/dosyalar/kilavuzlar/UBL-TR1.2.1_Paketi.zip adresinden paket indirilir.</li>
<li>İndirilen dosya unzip edilir.</li>
<li>.Net Framework yüklü olan bir bilgisayarda <strong>başlat&gt;Developer Command Prompt</strong> yazılır ve gelen seçenek tıklanarak komut dosyası açılır.</li>
<li>2.maddedeki unzip yapılan dizine <strong>cd UBLTR_1.2.1_Paketi/xsdrt/maindoc/</strong> olarak gidilir.</li>
<li>Gelen ekranda aşağıdaki komutu çalıştırılır.<br>
<strong>xsd /c UBL-CreditNote-2.1.xsd UBL-CommonExtensionComponents-2.1.xsd UBL-CommonBasicComponents-2.1.xsd UBL-UnqualifiedDataTypes-2.1.xsd UBL-CoreComponentParameters-2.1.xsd CCTS_CCT_SchemaModule-2.1.xsd UBL-CommonAggregateComponents-2.1.xsd</strong></li>
<li>Bu işlemin sonunda müstahsil makbuzu oluşturmak için gerekli bütün sınıflar UBL-CreditNote-2.1.cs dosyası içerisinde oluşturulacaktır.</li>
<li>Müstahsil <strong>CreditNoteType</strong> sınıfı ile üretilmektedir.</li>
</ol>

<h2 id="ortak-kullan-lan-eleman">Ortak Kullanılan Eleman</h2>

<p>Her webservis isteğinde gönderilmesi beklen ortak elemandır (REQUEST_HEADER)</p>

<table><thead>
<tr>
<th>Parametre</th>
<th>Tip</th>
<th>Zorunluluk</th>
<th>Açıklama</th>
</tr>
</thead><tbody>
<tr>
<td><strong>SESSION_ID</strong></td>
<td>String</td>
<td><strong>Evet</strong></td>
<td>Login Metodunda sistem tarafında gönderilen SESSION_ID bilgisi. Sonraki tüm metod çağrılarında parametre olarak metoda geçmelidir.</td>
</tr>
<tr>
<td><strong>APPLICATION_NAME</strong></td>
<td>String</td>
<td><strong>Evet</strong></td>
<td>Metodu çağıran uygulamanın adı. Mutlaka uygulama adının yazılması gerekmektedir.</td>
</tr>
<tr>
<td><strong>CHANNEL_NAME</strong></td>
<td>String</td>
<td><strong>Evet</strong></td>
<td>Metodun çağrıldığı kanal adı.</td>
</tr>
<tr>
<td><strong>COMPRESSED</strong></td>
<td>String</td>
<td>Hayır</td>
<td>İçerikte taşınan bilginin ZIP formatında sıkıştırılmış mı gönderildiği/talep edildiği bilgisi. Belge gönderim ve belge okuma servislerinde gönderilen değere göre işlem yapılmaktadır.</td>
</tr>
<tr>
<td><strong>CLIENT_TXN_ID</strong></td>
<td>String</td>
<td>Hayır</td>
<td>İstemci uygulama tarafından işlem için üretilen işlem bilgisi (transaction id) varsa istek esnasında gönderilip, sonuçta alabileceğiniz bir değerdir. request/response eşleşmesi yapmak için kullanılabilir.</td>
</tr>
<tr>
<td><strong>INT_PARENT_TXN_ID</strong></td>
<td>String</td>
<td>Hayır</td>
<td>İstemci uygulamasında ana modül entitileri ile ilişkilendirelmek istenen ana transaction ID.</td>
</tr>
<tr>
<td><strong>ACTION_DATE</strong></td>
<td>String</td>
<td>Hayır</td>
<td>Metodun çağrılma tarihi</td>
</tr>
<tr>
<td><strong>CHANGE_INFO</strong></td>
<td>Array</td>
<td>Hayır</td>
<td>Bu eleman ile eğer verilerde bir değişiklik yapılacak ise o değişikliği ait bilgi.</td>
</tr>
<tr>
<td><strong>REASON</strong></td>
<td>String</td>
<td>Hayır</td>
<td>İşlem sebebi. Fatura gönderme, fatura alma vs.</td>
</tr>
<tr>
<td><strong>HOST_NAME</strong></td>
<td>String</td>
<td>Hayır</td>
<td>Metodu çağıran sunucunun host bilgisi.</td>
</tr>
<tr>
<td><strong>SIMULATION_FLAG</strong></td>
<td>String</td>
<td>Hayır</td>
<td>Metod çağrılır ancak arkadaki işlem yapılmaz.</td>
</tr>
</tbody></table>

<h2 id="e-m-stahsil-g-nderme-sendcreditnote">E-Müstahsil Gönderme (SendCreditNote)</h2>

<p>E-Müstahsil Makbuzu belgesini özel entegratör sistemlerine gönderilmesini sağlayan servistir. Bu servis ile gönderilen belgeler kuyruğa eklenerek işleme (imzalama ve raporlama) alınacaktır.</p>

<p><br>
Servise gönderilmesi gereken parametreler şu şekildedir:</p>

<table><thead>
<tr>
<th>Parametre</th>
<th>Tip</th>
<th>Zorunluluk</th>
<th>Açıklama</th>
</tr>
</thead><tbody>
<tr>
<td><strong>REQUEST_HEADER</strong></td>
<td>ComplexType</td>
<td><strong>Evet</strong></td>
<td>Request Header objesi içerisinde <code class="prettyprint">SESSION_ID</code> ve <code class="prettyprint">APPLICATION_NAME</code> alanı zorunludur. <code class="prettyprint">SESSION_ID</code> değeri <strong>Kimlik Doğrulama (Authentication)</strong> webservisinde ki <code class="prettyprint">Login</code> metodundan alınan değerdir. Belge sıkıştırılarak/ziplenerek gönderiliyorsa <code class="prettyprint">COMPRESSED</code> alanı gönderilmeyebilir veya <code class="prettyprint">Y</code> olarak gönderilebilir. <strong>XML formatında sıkıştırılmadan yüklemek için mutlaka <code class="prettyprint">COMPRESSED</code> eleman eklenmeli ve <code class="prettyprint">N</code> değeri gönderilmelidir.</strong></td>
</tr>
<tr>
<td><strong>SENDER</strong></td>
<td>ComplexType</td>
<td>Hayır</td>
<td>İrsaliye gönderen tarafın vergi kimlik numarasını <code class="prettyprint">vkn</code> attribute içerisine eklenmelidir. Eğer eleman gönderilmezse oturum açılan kullanıcının bağlı olduğu hesapta ki VKN kullanılacaktır. <strong>Sender elemanı gönderilmesini tavsiye ederiz.</strong></td>
</tr>
<tr>
<td><strong>RECEIVER</strong></td>
<td>ComplexType</td>
<td>Hayır</td>
<td>Belgeyi alan tarafının kimlik numarasını (TCKN) <code class="prettyprint">vkn</code> attribute içerisine eklenmelidir. Eğer eleman gönderilmezse belge içerisinde ki alıcı taraf (AccountingCustomerParty) içerisinde ki TCKN değeri kullanılacaktır.</td>
</tr>
<tr>
<td><strong>ID_ASSIGN_FLAG</strong></td>
<td>String</td>
<td>Hayır</td>
<td>Belge numarasının özel entegratör ortamından atanmasını sağlamak için kullanılacak parametredir. Eğer belge numarası istemci tarafında atanmışsa parametre gönderilmemeli veya <code class="prettyprint">N</code> değeri gönderilmelidir. Belge numarasını sunucuda atamak için <code class="prettyprint">Y</code> değeri gönderilmelidir.</td>
</tr>
<tr>
<td><strong>ID_ASSIGN_PREFIX</strong></td>
<td>String</td>
<td>Hayır</td>
<td>Belge numarasının özel entegratör ortamından atanmasını talep edildiği durumlarda atama yapılacak seri ön eki değerinin belirlendiği parametredir. <strong>Seri ön eki 3 hane alfanumerik değer içerebilir.</strong> Gönderilen seri ön eki özel entegratör platformunda tanımlı olmalıdır.   Eğer <code class="prettyprint">ID_ASSIGN_FLAG=Y</code> olarak gönderilmiş ama <code class="prettyprint">ID_ASSIGN_PREFIX</code> parametresi gönderilmemişse, müşterinin özel entegratörde tanımlı varsaylılan serisi kullanılacaktır. Eğer varsayılan seri tanımlanmamışsa işlem başarısız olacak ve hata dönülecektir.</td>
</tr>
<tr>
<td><strong>CREDITNOTE</strong></td>
<td>ComplexType</td>
<td><strong>Evet</strong></td>
<td>Gönderilecek belgenin numarası <code class="prettyprint">ID</code> attribute içerisine, evrensel tekil tanımlama numarası (ETTN) ise <code class="prettyprint">UUID</code> attribute içerisine eklenmek zorundadır.  Aynı alıcıya düzenlenen bir veya birden fazla müstahsil makbuzu belgeleri tek istek ile entegrasyon platformuna yüklenebilir.  <strong>Birden fazla belge göndermek için CREDITNOTE elemanı çoklanmalıdır.</strong></td>
</tr>
<tr>
<td><strong>CREDITNOTE.CREDITNOTEHEADER</strong></td>
<td>ComplexType</td>
<td>Hayır</td>
<td>Webservis içerisinde ortak eleman tipi olduğu için şema içerisinde görünmektedir. <strong>Göndermeyiniz.</strong></td>
</tr>
<tr>
<td><strong>CREDITNOTE.CONTENT</strong></td>
<td>Base64Binary</td>
<td><strong>Evet</strong></td>
<td>Belgenin Base64Binary olarak encode edilmiş XML veya Ziplenmiş içeriği. Eğer belgeyi ziplemeden/sıkıştırmadan göndermek istiyorsanız <code class="prettyprint">COMPRESSED</code> elemanı eklenmeli ve <code class="prettyprint">N</code> değeri gönderilmelidir.</td>
</tr>
</tbody></table>

<p>Servisten dönen parametreler şu şekildedir:</p>

<table><thead>
<tr>
<th>Parametre</th>
<th>Tip</th>
<th>Açıklama</th>
</tr>
</thead><tbody>
<tr>
<td><strong>REQUEST_RETURN.INTL_TXN_ID</strong></td>
<td>String</td>
<td>Sunucuda işlemin gerçekleştirildiği transaction IDsi. Bu ID istemci tarafında kaydedilerek oluşabilecek hatalarda referans olarak destek ekibine iletilebilir.</td>
</tr>
<tr>
<td><strong>REQUEST_RETURN.RETURN_CODE</strong></td>
<td>String</td>
<td>Başarılı durumlarda <code class="prettyprint">0</code> değeri döner. Başarısız olduğunda REQUEST_RETURN objesi dönülmez. ERROR_TYPE objesi dönülecektir.</td>
</tr>
<tr>
<td><strong>REQUEST_RETURN.CLIENT_TXN_ID</strong></td>
<td>String</td>
<td>İstek ile istemci tarafından işlem IDsi gönderilmişse sonuç ile beraber dönülür.</td>
</tr>
</tbody></table>

<h2 id="e-m-stahsil-okuma-getcreditnote">E-Müstahsil Okuma (GetCreditNote)</h2>

<ul>
<li>Özel entegratör platformundan e-müstahsil belegelerini okumayı sağlayan servistir.</li>
<li>E-Müstahsil belgesinin imzalı UBL-TR XML, PDF veya HTML olarak okumayı sağlar.</li>
</ul>

<p><br>
Servise gönderilmesi gereken parametreler şu şekildedir:</p>

<table><thead>
<tr>
<th>Parametre</th>
<th>Tip</th>
<th>Zorunluluk</th>
<th>Açıklama</th>
</tr>
</thead><tbody>
<tr>
<td><strong>REQUEST_HEADER</strong></td>
<td>ComplexType</td>
<td><strong>Evet</strong></td>
<td>Request Header objesi içerisinde <code class="prettyprint">SESSION_ID</code> ve <code class="prettyprint">APPLICATION_NAME</code> alanı zorunludur. Faturaları XML formatında sıkıştırılmadan çekmek için mutlaka <code class="prettyprint">COMPRESSED</code> elemanı eklenmeli ve <code class="prettyprint">N</code> değeri gönderilmelidir. Eğer gönderilmezse faturalar sıkıştırılmış/ziplenmiş olarak dönülecektir.</td>
</tr>
<tr>
<td><strong>HEADER_ONLY</strong></td>
<td>String</td>
<td>Hayır</td>
<td>Sadece özet değerler mi yoksa içerik ile beraber mi okunmak istenildiğini belirleyen parametredir. Eleman <strong>gönderilmezse</strong> veya <code class="prettyprint">N</code> değeri gönderilirse irsaliyeler XML ile beraber dönülür. <code class="prettyprint">Y</code> değeri gönderilirse irsaliyelerin özeti dönülür.  Gönderilebilecek değerler: Y/N</td>
</tr>
<tr>
<td><strong>SEARCH_KEY.LIMIT</strong></td>
<td>String</td>
<td>Hayır</td>
<td>Kaç kayıt okunmak istendiği. Eğer eleman gönderilmezse 10 adet kayıt dönülür. İçerikleri (XML) ile beraber en fazla 100 adet kayıt dönülür. Sadece özet/başlıklarını çekildiğinde ise en fazla 25.000 adet kayıt dönülür.</td>
</tr>
<tr>
<td><strong>SEARCH_KEY.ID</strong></td>
<td>String</td>
<td>Hayır</td>
<td>Belge numarası ile okumak için kullanılabilir. örnek: FYA2018000000001</td>
</tr>
<tr>
<td><strong>SEARCH_KEY.UUID</strong></td>
<td>String</td>
<td>Hayır</td>
<td>Evrensel Tekil Tanımlama Numarası (ETTN) ile okumak için kullanılabilir.  GUID formatında</td>
</tr>
<tr>
<td><strong>SEARCH_KEY.START_DATE</strong></td>
<td>String</td>
<td>Hayır</td>
<td>Belirli tarih aralığında ki belgeleri çekmek istendiğinde dönem başlangıç tarihi. format: YYYY-MM-DD</td>
</tr>
<tr>
<td><strong>SEARCH_KEY.END_DATE</strong></td>
<td>String</td>
<td>Hayır</td>
<td>Belirli tarih aralığında ki belgeleri çekmek istendiğinde dönem bitiş tarihi format: YYYY-MM-DD</td>
</tr>
<tr>
<td><strong>SEARCH_KEY.READ_INCLUDED</strong></td>
<td>String</td>
<td>Hayır</td>
<td>Daha önce okunmuş belgeleri dönüşe dahil edilip edilmeyeceğini belirleyen parametredir. <code class="prettyprint">Y</code> değeri gönderilirse daha önce okunmuş olsa bile yanıta eklenir. Gönderilmezse veya <code class="prettyprint">N</code> gönderilirse sadece yeni gelen belgeler dönülür. Gönderilebilecek değerler: Y/N</td>
</tr>
<tr>
<td><strong>SEARCH_KEY.DIRECTION</strong></td>
<td>String</td>
<td>Hayır</td>
<td>Belge yönü. Giden(OUT), Gelen (IN). Müstahsil için gelen olmadığı için <code class="prettyprint">OUT</code> değeri gönderilebilir. Varsayılan değer <code class="prettyprint">OUT</code>.</td>
</tr>
<tr>
<td><strong>SEARCH_KEY.TYPE</strong></td>
<td>String</td>
<td>Hayır</td>
<td>Talep edilen format. Gönderilebilecek değerler: XML, PDF, HTML. Eğer parametre gönderilmezse imzalı UBL-TR XML dosyası dönülecektir.</td>
</tr>
<tr>
<td><strong>SEARCH_KEY.FROM</strong></td>
<td>String</td>
<td>Hayır</td>
<td><strong>Bu serviste kullanılmaz.</strong></td>
</tr>
<tr>
<td><strong>SEARCH_KEY.TO</strong></td>
<td>String</td>
<td>Hayır</td>
<td><strong>Bu serviste kullanılmaz.</strong></td>
</tr>
<tr>
<td><strong>SEARCH_KEY.SENDER</strong></td>
<td>String</td>
<td>Hayır</td>
<td><strong>Bu serviste kullanılmaz.</strong></td>
</tr>
<tr>
<td><strong>SEARCH_KEY.RECEIVER</strong></td>
<td>String</td>
<td>Hayır</td>
<td><strong>Bu serviste kullanılmaz.</strong></td>
</tr>
</tbody></table>

<p><br><br></p>

<p>Servisten dönen parametreler şu şekildedir:</p>

<table><thead>
<tr>
<th>Parametre</th>
<th>Tip</th>
<th>Açıklama</th>
</tr>
</thead><tbody>
<tr>
<td><strong>CREDITNOTE</strong></td>
<td>ComplexType</td>
<td>Sorgu kriterine uyan belgelerin listesi. Müstahsil numarası <code class="prettyprint">ID</code>, evrensel tekil tanımlama numarası  <code class="prettyprint">UUID</code> ve sisteminde tanımlı tekil numara değeri  <code class="prettyprint">LIST_ID</code> attribute içerisinde dönülmektedir.</td>
</tr>
<tr>
<td><strong>CREDITNOTE.HEADER</strong></td>
<td>ComplexType</td>
<td>Belgeye ait özet bilgiler içermektedir.</td>
</tr>
<tr>
<td><strong>HEADER.SENDER</strong></td>
<td>String</td>
<td>Belgeyi gönderen firma VKN&#39;si.</td>
</tr>
<tr>
<td><strong>HEADER.RECEIVER</strong></td>
<td>String</td>
<td>Belgeyi alanın TCKNsi.</td>
</tr>
<tr>
<td><strong>HEADER.SUPPLIER</strong></td>
<td>String</td>
<td>Belgeyi gönderen firma ünvanı.</td>
</tr>
<tr>
<td><strong>HEADER.CUSTOMER</strong></td>
<td>String</td>
<td>Belgeyi alanın ünvanı.</td>
</tr>
<tr>
<td><strong>HEADER.ISSUE_DATE</strong></td>
<td>String</td>
<td>Belge tarihi.</td>
</tr>
<tr>
<td><strong>HEADER.PAYABLE_AMOUNT</strong></td>
<td>String</td>
<td>Toplam ödenecek tutar.</td>
</tr>
<tr>
<td><strong>HEADER.PROFILEID</strong></td>
<td>String</td>
<td>Belge senaryosu. <code class="prettyprint">EARSIVBELGE</code> değeri olabilir.</td>
</tr>
<tr>
<td><strong>HEADER.TYPE_CODE</strong></td>
<td>String</td>
<td>Belgenin tipi. <code class="prettyprint">MUSTAHSILMAKBUZ</code> değeri olabilir.</td>
</tr>
<tr>
<td><strong>HEADER.STATUS</strong></td>
<td>String</td>
<td>Belgenin durumu. Detay için <strong>Müstahsil Durumları</strong> başlığını inceleyiniz.</td>
</tr>
<tr>
<td><strong>HEADER.STATUS_DESCRIPTION</strong></td>
<td>String</td>
<td>Belge durum açıklaması. Detay için <strong>Müstahsil Durumları</strong> başlığını inceleyiniz.</td>
</tr>
<tr>
<td><strong>HEADER.CDATE</strong></td>
<td>String</td>
<td>Belgenin sisteme ulaştığı tarih.</td>
</tr>
<tr>
<td><strong>CREDITNOTE.CONTENT</strong></td>
<td>Base64Binary</td>
<td>Belgenin içeriği. Eğer <code class="prettyprint">COMPRESSED</code> parametresi <code class="prettyprint">N</code> olarak gönderilmişse XML dosya, <code class="prettyprint">COMPRESSED</code> elemanı gönderilmemiş veya <code class="prettyprint">Y</code> değeri gönderilmişse sıkıştırılmış/ziplenmiş XML dosyası dönülür.</td>
</tr>
</tbody></table>

<h2 id="e-m-stahsil-durum-sorgulama-getcreditnotestatus">E-Müstahsil Durum Sorgulama (GetCreditNoteStatus)</h2>

<ul>
<li>Özel entegratör platformuna gönderilen bir veya birden fazla belgenin durumunu sorgulamayı sağlayan servistir.</li>
<li>Birden fazla belge durumu sorgulamak için <code class="prettyprint">CREDITNOTEINFO</code> parametresi çoklanabilir.</li>
</ul>

<p>Servise gönderilmesi gereken parametreler şu şekildedir:</p>

<table><thead>
<tr>
<th>Parametre</th>
<th>Tip</th>
<th>Zorunluluk</th>
<th>Açıklama</th>
</tr>
</thead><tbody>
<tr>
<td><strong>REQUEST_HEADER</strong></td>
<td>ComplexType</td>
<td><strong>Evet</strong></td>
<td>Request Header objesi içerisinde <code class="prettyprint">SESSION_ID</code> ve <code class="prettyprint">APPLICATION_NAME</code> alanı zorunludur.</td>
</tr>
<tr>
<td><strong>CREDITNOTEINFO</strong></td>
<td>ComplexType</td>
<td><strong>Evet</strong></td>
<td>Sorgulanacak belge numarası <code class="prettyprint">ID</code> attribute içerisine, Evrensel Tekil Tanımlama Numarası (ETTN) ise <code class="prettyprint">UUID</code> attribute eklenmelidir.</td>
</tr>
</tbody></table>

<p>Servisten dönen parametreler şu şekildedir:</p>

<table><thead>
<tr>
<th>Parametre</th>
<th>Tip</th>
<th>Açıklama</th>
</tr>
</thead><tbody>
<tr>
<td><strong>CREDITNOTE</strong></td>
<td>ComplexType</td>
<td>Sorgu kriterine uyan belgelerin listesi. Belge numarası <code class="prettyprint">ID</code>, evrensel tekil tanımlama numarası  <code class="prettyprint">UUID</code> attribute içerisinde dönülmektedir.</td>
</tr>
<tr>
<td><strong>CREDITNOTE.CREDITNOTEHEADER</strong></td>
<td>ComplexType</td>
<td>Belgeye ait özet bilgiler içermektedir. Parametre listesi aşağıdadır.</td>
</tr>
<tr>
<td><strong>CREDITNOTEHEADER.ID</strong></td>
<td>String</td>
<td>Belgenin numarası.</td>
</tr>
<tr>
<td><strong>CREDITNOTEHEADER.UUID</strong></td>
<td>String</td>
<td>Belgenin evrensel tekil tanımlama numarası.</td>
</tr>
<tr>
<td><strong>CREDITNOTEHEADER.PROFILEID</strong></td>
<td>String</td>
<td>Belge senaryosu. <code class="prettyprint">EARSIVBELGE</code> değeri olabilir.</td>
</tr>
<tr>
<td><strong>CREDITNOTEHEADER.TYPE_CODE</strong></td>
<td>String</td>
<td>Belgenin tipi. <code class="prettyprint">MUSTAHSILMAKBUZ</code> değeri olabilir.</td>
</tr>
<tr>
<td><strong>CREDITNOTEHEADER.SENDER</strong></td>
<td>String</td>
<td>Belgeyi gönderen firmanın VKNsi <code class="prettyprint">VKN</code> attribute içerisinde, firma ünvanı ise <code class="prettyprint">IDENTIFIER</code> attribute içerisinde dönülmektedir.</td>
</tr>
<tr>
<td><strong>CREDITNOTEHEADER.RECEIVER</strong></td>
<td>String</td>
<td>Belgeyi alan firmanın VKNsi <code class="prettyprint">VKN</code> attribute içerisinde, firma ünvanı ise <code class="prettyprint">IDENTIFIER</code> attribute içerisinde dönülmektedir.</td>
</tr>
<tr>
<td><strong>CREDITNOTEHEADER.ISSUE_DATE</strong></td>
<td>Date</td>
<td>Belge tarihi.</td>
</tr>
<tr>
<td><strong>CREDITNOTEHEADER.ISSUE_TIME</strong></td>
<td>String</td>
<td>Belge düzenleme zamanı.</td>
</tr>
<tr>
<td><strong>CREDITNOTEHEADER.DIRECTION</strong></td>
<td>String</td>
<td>Belge yönü. Gelen irsaliye için <code class="prettyprint">IN</code>, giden irsaliye için <code class="prettyprint">OUT</code> değeri dönülür.</td>
</tr>
<tr>
<td><strong>CREDITNOTEHEADER.STATUS</strong></td>
<td>String</td>
<td>Belgenin durumu. Lütfen bu alanı kullanarak karar vermeyin. Karar vermek için <code class="prettyprint">STATUS_CODE</code> alanını kullanınız.</td>
</tr>
<tr>
<td><strong>CREDITNOTEHEADER.STATUS_CODE</strong></td>
<td>String</td>
<td>Belgenin durum kodu. Detay için <strong>İrsaliye Durumları</strong> başlığını inceleyiniz.</td>
</tr>
<tr>
<td><strong>CREDITNOTEHEADER.STATUS_DESCRIPTION</strong></td>
<td>String</td>
<td>Belgenin durum açıklaması. Detay için <strong>İrsaliye Durumları</strong> başlığını inceleyiniz.</td>
</tr>
<tr>
<td><strong>CREDITNOTEHEADER.REPORT_ID</strong></td>
<td>String</td>
<td>Belgenin rapor numarası. GİBe raporlandıktan sonra dönülmektedir.</td>
</tr>
<tr>
<td><strong>CREDITNOTEHEADER.CDATE</strong></td>
<td>DateTime</td>
<td>Belgenin sisteme ulaştığı/yüklendiği tarih.</td>
</tr>
</tbody></table>

<h2 id="e-m-stahsil-durumlar">E-Müstahsil Durumları</h2>

<table><thead>
<tr>
<th>Durum</th>
<th>Kod</th>
<th>Detaylı Açıklama</th>
</tr>
</thead><tbody>
<tr>
<td>DURUM_HENUZ_GUNCELLENMEDI</td>
<td>100</td>
<td>DURUM HENÜZ GÜNCELLENMEDİ</td>
</tr>
<tr>
<td>LOAD_SUCCEED</td>
<td>101</td>
<td>KUYRUĞA EKLENDİ</td>
</tr>
<tr>
<td>LOAD_PROCESSİNG</td>
<td>102</td>
<td>TASLAK İŞLENİYOR</td>
</tr>
<tr>
<td>PACKAGE_PROCESSING</td>
<td>103</td>
<td>PAKETLENİYOR</td>
</tr>
<tr>
<td>PACKAGE_SUCCEED</td>
<td>104</td>
<td>PAKETLENDİ</td>
</tr>
<tr>
<td>PACKAGE_FAILED</td>
<td>105</td>
<td>PAKETLEME_HATASI</td>
</tr>
<tr>
<td>SIGN_PROCESSING</td>
<td>106</td>
<td>İMZALANIYOR</td>
</tr>
<tr>
<td>SIGN_FAILED</td>
<td>106</td>
<td>İMZALANIYOR</td>
</tr>
<tr>
<td>SIGN_SUCCEED</td>
<td>107</td>
<td>İMZALANDI</td>
</tr>
<tr>
<td>RECEIVE_SUCCEED</td>
<td>133</td>
<td>BAŞARIYLA ALINDI</td>
</tr>
<tr>
<td>SEND_TIMEOUT</td>
<td>134</td>
<td>GÖNDERME İŞLEMİ SİSTEM TARAFINDAN  TEKRAR DENENECEKTİR</td>
</tr>
<tr>
<td>RECEIVE_TIMEOUT</td>
<td>134</td>
<td>GÖNDERME İŞLEMİ SİSTEM TARAFINDAN  TEKRAR DENENECEKTİR</td>
</tr>
<tr>
<td>SEND_PROCESSING</td>
<td>135</td>
<td>GÖNDERİLİYOR</td>
</tr>
<tr>
<td>SEND_FAILED</td>
<td>136</td>
<td>GÖNDERME İŞLEMİ BAŞARISIZ</td>
</tr>
<tr>
<td>SEND_SUCCEED</td>
<td>137</td>
<td>GÖNDERME İŞLEMİ BAŞARILI</td>
</tr>
</tbody></table>

          <h1 id="e-serbest-meslek-webservisi">E-Serbest Meslek Webservisi</h1>

<p>487 Sıra No.lu Vergi Usul Kanunu Genel Tebliği ile yürürlüğe giren e-Serbest Meslek Makbuzu (e-SMM) Uygulaması, Serbest Meslek Makbuzunun Gelir İdaresi Başkanlığı tarafından belirlenen standartlara uygun olarak elektronik ortamda oluşturulması, muhafazası, ibrazı ve raporlanmasını kapsayan uygulamadır.</p>

<p>01/01/2018 tarihi itibariyle dileyen serbest meslek erbapları uygulamaya dahil olarak mesleki faaliyetlerine ilişkin tahsilatları için kağıt ortamda düzenlemiş oldukları Serbest Meslek Makbuzunu elektronik belge olarak elektronik ortamda düzenleyebilir, muhatabının talebi doğrultusunda elektronik veya kağıt ortamda iletilebilir, elektronik ortamda muhafaza edip Gelir İdaresi Başkanlığı’na elektronik ortamda raporlayabilirler.</p>

<h2 id="e-serbest-meslek-senaryolar">E-Serbest Meslek Senaryoları</h2>

<p>E-SMM sistemi üzerinden düzenlenebilecek ve gönderilebilecek makbuz senaryoları ve örnek  XML dosyaları aşağıda listelenmiştir.</p>

<table><thead>
<tr>
<th>Senaryosu</th>
<th>Açıklama</th>
<th>XML</th>
</tr>
</thead><tbody>
<tr>
<td><strong>Nihai Tüketiciye (Şahıslara) Düzenlenen E-SMM</strong></td>
<td>Alıcısının vergi mükellefi olmayıp şahıslara düzenlenen serbest meslek makbuzu senaryosudur. Nihai tüketiciye düzenlen makbuzlarda Gelir Vergisi (GV) stopajı uygulanır.</td>
<td><a href="/resource/xml/esmm_nihaituketici.xml" target = "_blank" ><img src="/images/icon_xml.png" height="40" width="35"/></a></td>
</tr>
<tr>
<td><strong>Vergi Mükelleflerine Düzenlenen E-SMM</strong></td>
<td>Alıcısının vergi mükellefi olduğu durumlarda düzenenlen serbest meslek makbuzu senaryosudur. Bu durumda KDV eklenmek zorundadır. KDV Tevkifatı uygulanabilir. <strong>KDV tevkifatı için aşağıda ki senaryoyı inceleyiniz.</strong></td>
<td><a href="/resource/xml/esmm_vergimukellefi.xml" target="_blank"> <img src="/images/icon_xml.png" height="40" width="35"/></a></td>
</tr>
<tr>
<td><strong>KDV Tevkifatı İçeren E-SMM</strong></td>
<td>Alıcısının vergi mükellefi olduğu durumlarda düzenenlen serbest meslek makbuzu senaryosudur. Bu durumda KDV eklenmek zorundadır. KDV Tevkifatı uygulanabilir.</td>
<td><a href="/resource/xml/esmm_vergimullefikdvtevkifati.xml" target="_blank"> <img src="/images/icon_xml.png" height="40" width="35"/></a></td>
</tr>
</tbody></table>

<h2 id="webservice-endpoint-wsdl-url">Webservice Endpoint (WSDL) URL</h2>

<table><thead>
<tr>
<th>Ürün</th>
<th>Endpoint URL</th>
</tr>
</thead><tbody>
<tr>
<td>Kimlik Doğrulama</td>
<td><a href="https://efaturatest.izibiz.com.tr/AuthenticationWS?wsdl">https://efaturatest.izibiz.com.tr/AuthenticationWS?wsdl</a></td>
</tr>
<tr>
<td>E-Fatura Webservis</td>
<td><a href="https://efaturatest.izibiz.com.tr/EFaturaOIB?wsdl">https://efaturatest.izibiz.com.tr/EFaturaOIB?wsdl</a></td>
</tr>
<tr>
<td>E-Arşiv Fatura Webservis</td>
<td><a href="https://efaturatest.izibiz.com.tr/EIArchiveWS/EFaturaArchive?wsdl">https://efaturatest.izibiz.com.tr/EIArchiveWS/EFaturaArchive?wsdl</a></td>
</tr>
<tr>
<td>E-İrsaliye Webservis</td>
<td><a href="https://efaturatest.izibiz.com.tr/EIrsaliyeWS/EIrsaliye?wsdl">https://efaturatest.izibiz.com.tr/EIrsaliyeWS/EIrsaliye?wsdl</a></td>
</tr>
<tr>
<td>E-Müstahsil Webservis</td>
<td><a href="http://efaturatest.izibiz.com.tr/CreditNoteWS/CreditNote?wsdl">http://efaturatest.izibiz.com.tr/CreditNoteWS/CreditNote?wsdl</a></td>
</tr>
<tr>
<td>E-Mutabakat Webservis</td>
<td><a href="http://efaturatest.izibiz.com.tr/Reconciliation?wsdl">http://efaturatest.izibiz.com.tr/Reconciliation?wsdl</a></td>
</tr>
<tr>
<td>E-Serbest Meslek Webservis</td>
<td><a href="https://efaturatest.izibiz.com.tr/SmmWS?wsdl">https://efaturatest.izibiz.com.tr/SmmWS?wsdl</a></td>
</tr>
<tr>
<td>E-ZRapor Webservis</td>
<td><a href="https://efaturatest.izibiz.com.tr/ZReportWS?wsdl">https://efaturatest.izibiz.com.tr/ZReportWS?wsdl</a></td>
</tr>
</tbody></table>

<h3 id="portal-uygulamas">Portal Uygulaması</h3>

<p>Entegrasyon sürecinde Portal uygulamamızı aşağıda ki durumlar için kullanabilirsiniz:</p>

<ul>
<li>Belgelerin durumunu kontrol</li>
<li>Farklı senaryolar için belge düzenleyerek XML içeriğini kontrol</li>
<li>Alıcı firmanın mükellefiyet sorgulaması</li>
</ul>

<p>Test Portal Adresimiz: <a href="https://portaltest.izibiz.com.tr">https://portaltest.izibiz.com.tr</a></p>

<p>Test portali erişim bilgileri için <strong>entegrasyon@izibiz.com.tr</strong> adresi ile iletişime geçebilirsiniz.</p>

<h2 id="test-hesaplar">Test Hesaplar</h2>

<p>Test hesabı talep etmek için <strong>entegrasyon@izibiz.com.tr</strong> adresi ile iletişime geçebilirsiniz.
Test sürecinde düzenlenen belgelerin gönderici VKNsi 4840847211 olmalıdır.</p>

<h2 id="dikkat-edilecek-hususlar">Dikkat Edilecek Hususlar</h2>

<p>E-SMM uygulamanızı geliştirken aşağıda ki bilgiler faydalı olacaktır:</p>

<ol>
<li><strong>Kimlik Doğrulama (Authentication)</strong> Webservisinde bulunan <strong>Login</strong> metodu ile oturum açarak session id alınacaktır. Session Id sistemimiz tarafında 8 saate kadar zaman aşımına uğramadığı için kullanıcı giriş yapınca session id alıp bütün kullanım süresinde aynı session id kullanabilirsiniz.</li>
<li>SMM belgeleri UBL-TR Invoice formatına dönüştürerek gönderilmelidir. Her dosya içerisinde görüntülenmesini sağlayan XSLT dokümanı olmalıdır.</li>
<li><strong>SendSMM</strong> metodu ile belge gönderimi yapılmaktadır.</li>
<li><strong>GetSMMStatus</strong> metodu ile entegrasyon sunucularına yüklenen belgelerin durumları sorgulanacak. <strong>Sık sorgulama yapmayınız.</strong></li>
<li><strong>GetSMM</strong> metodu ile yüklenen belgenin imzalı XML, PDF ve HTML formatında tekrar müşteri bilgisayarına çekmek için kullanılabilir.</li>
<li><strong>CancelSMM</strong> metodu ile eksik/hatalı oluşturulmuş veya müşteri tarafından iptal/iade edilmiş belgeleri GİB&#39;e iptal olarak raporlanmasını veya tamamen iptal edilerek hiç raporlanmamasını sağlayabilirsiniz.</li>
<li><strong>Kimlik Doğrulama (Authentication)</strong> Webservisinde bulunan  <strong>Logout</strong> metodu ile kullanıcı programını kapatınca veya sizin belirlediğiniz bir sürede oturumu
kapatabilirsiniz.</li>
</ol>

<h2 id="ortak-kullan-lan-eleman">Ortak Kullanılan Eleman</h2>

<p>Her webservis isteğinde gönderilmesi beklen ortak elemandır (REQUEST_HEADER)</p>

<table><thead>
<tr>
<th>Parametre</th>
<th>Tip</th>
<th>Zorunluluk</th>
<th>Açıklama</th>
</tr>
</thead><tbody>
<tr>
<td><strong>SESSION_ID</strong></td>
<td>String</td>
<td><strong>Evet</strong></td>
<td>Login Metodunda sistem tarafında gönderilen SESSION_ID bilgisi. Sonraki tüm metod çağrılarında parametre olarak metoda geçmelidir.</td>
</tr>
<tr>
<td><strong>APPLICATION_NAME</strong></td>
<td>String</td>
<td><strong>Evet</strong></td>
<td>Metodu çağıran uygulamanın adı. Mutlaka uygulama adının yazılması gerekmektedir.</td>
</tr>
<tr>
<td><strong>CHANNEL_NAME</strong></td>
<td>String</td>
<td><strong>Evet</strong></td>
<td>Metodun çağrıldığı kanal adı.</td>
</tr>
<tr>
<td><strong>COMPRESSED</strong></td>
<td>String</td>
<td>Hayır</td>
<td>İçerikte taşınan bilginin ZIP formatında sıkıştırılmış mı gönderildiği/talep edildiği bilgisi. Belge gönderim ve belge okuma servislerinde gönderilen değere göre işlem yapılmaktadır.</td>
</tr>
<tr>
<td><strong>CLIENT_TXN_ID</strong></td>
<td>String</td>
<td>Hayır</td>
<td>İstemci uygulama tarafından işlem için üretilen işlem bilgisi (transaction id) varsa istek esnasında gönderilip, sonuçta alabileceğiniz bir değerdir. request/response eşleşmesi yapmak için kullanılabilir.</td>
</tr>
<tr>
<td><strong>INT_PARENT_TXN_ID</strong></td>
<td>String</td>
<td>Hayır</td>
<td>İstemci uygulamasında ana modül entitileri ile ilişkilendirelmek istenen ana transaction ID.</td>
</tr>
<tr>
<td><strong>ACTION_DATE</strong></td>
<td>String</td>
<td>Hayır</td>
<td>Metodun çağrılma tarihi</td>
</tr>
<tr>
<td><strong>CHANGE_INFO</strong></td>
<td>Array</td>
<td>Hayır</td>
<td>Bu eleman ile eğer verilerde bir değişiklik yapılacak ise o değişikliği ait bilgi.</td>
</tr>
<tr>
<td><strong>REASON</strong></td>
<td>String</td>
<td>Hayır</td>
<td>İşlem sebebi. Fatura gönderme, fatura alma vs.</td>
</tr>
<tr>
<td><strong>HOST_NAME</strong></td>
<td>String</td>
<td>Hayır</td>
<td>Metodu çağıran sunucunun host bilgisi.</td>
</tr>
<tr>
<td><strong>SIMULATION_FLAG</strong></td>
<td>String</td>
<td>Hayır</td>
<td>Metod çağrılır ancak arkadaki işlem yapılmaz.</td>
</tr>
</tbody></table>

<h2 id="e-smm-g-nderme-sendsmm">E-SMM Gönderme (SendSMM)</h2>

<p>E-SMM belgesini özel entegratör sistemlerine gönderilmesini sağlayan servistir. Bu servis ile gönderilen belgeler kuyruğa eklenerek işleme (imzalama, e-posta/sms gönderme ve raporlama) alınacaktır.</p>

<ul>
<li>Eğer müşterinin özel entegratör ile e-posta gönderme hizmeti sözleşmesi yoksa ve webservis isteğinde e-posta gönderme seçeneği seçilmişse işlem hata alacaktır. Bu durumda özel entegratör ile iletişime geçerek e-posta gönderim hizmeti sözleşmesi imzalanmalı ve e-posta gönderim hizmetinin aktiflemesi talep edilmelidir. Eğer e-posta gönderimi farklı kanallardan yapılacaksa e-posta gönderim parametresini <code class="prettyprint">N</code> olarak gönderiniz.
<br>
Servise gönderilmesi gereken parametreler şu şekildedir:</li>
</ul>

<table><thead>
<tr>
<th>Parametre</th>
<th>Tip</th>
<th>Zorunluluk</th>
<th>Açıklama</th>
</tr>
</thead><tbody>
<tr>
<td><strong>REQUEST_HEADER</strong></td>
<td>ComplexType</td>
<td><strong>Evet</strong></td>
<td>Request Header objesi içerisinde <code class="prettyprint">SESSION_ID</code> ve <code class="prettyprint">APPLICATION_NAME</code> alanı zorunludur. <code class="prettyprint">SESSION_ID</code> değeri <strong>Kimlik Doğrulama (Authentication)</strong> webservisinde ki <code class="prettyprint">Login</code> metodundan alınan değerdir. Belge sıkıştırılarak/ziplenerek gönderiliyorsa <code class="prettyprint">COMPRESSED</code> alanı gönderilmeyebilir veya <code class="prettyprint">Y</code> olarak gönderilebilir. <strong>XML formatında sıkıştırılmadan yüklemek için mutlaka <code class="prettyprint">COMPRESSED</code> elemanı eklenmeli ve <code class="prettyprint">N</code> değeri gönderilmelidir.</strong></td>
</tr>
<tr>
<td><strong>SMM</strong></td>
<td>ComplexType</td>
<td><strong>Evet</strong></td>
<td>En az bir SMM elementi bulunmalıdır. Toplu SMM göndermek bu eleman çoklanır. Atanan belge numarası <code class="prettyprint">ID</code> attribute içerisine, Evrensel tekil tanımlama numarasını (ETTN) <code class="prettyprint">UUID</code> attribute eklenmek zorundadır.</td>
</tr>
<tr>
<td><strong>SMM.CONTENT</strong></td>
<td>Base64Binary</td>
<td><strong>Evet</strong></td>
<td>Belgenin Base64Binary olarak encode edilmiş XML veya Ziplenmiş içeriği. XML formatında sıkıştırılmadan göndermek için mutlaka <code class="prettyprint">COMPRESSED</code> elemanı eklenmeli ve <code class="prettyprint">N</code> değeri gönderilmelidir. <strong>Daha hızlı iletişim sağlamak için belgelerin sıkıştırılarak gönderilmesini öneriyoruz.</strong></td>
</tr>
<tr>
<td><strong>SMM_PROPERTIES</strong></td>
<td>ComplexType</td>
<td>Hayır</td>
<td>SMM belgesi ile ilgili parametrelerin belirlendiği elemandır. Belgenin alıcısına e-posta veya SMS olarak iletme isteği belirlenebilir.</td>
</tr>
<tr>
<td><strong>SMM_PROPERTIES.SMS_FLAG</strong></td>
<td>String</td>
<td>Hayır</td>
<td>Belge alıcısına SMS olarak göndermek için <code class="prettyprint">Y</code> değeri gönderilmelidir. Eleman gönderilmezse <code class="prettyprint">SMS_NUMBER</code> dolu olsa dahi SMS gönderilmez. <strong>DİKKAT: Eğer müşterinin özel entegratör ile SMS gönderme hizmeti sözleşmesi yoksa ve <code class="prettyprint">Y</code> değeri gönderilirse belgenin sisteme yüklenmesine izin verilmeyecektir. Bu durumda özel entegratör ile iletişime geçerek SMS gönderim hizmeti satın alınmalı veya SMS gönderiminin farklı bir kanaldan müşteri tarafından yapılması gerekmektedir. Bu durumda bu parametre gönderilmemeli veya <code class="prettyprint">N</code> olarak gönderilmelidir.</strong></td>
</tr>
<tr>
<td><strong>SMM_PROPERTIES.SMS_NUMBER</strong></td>
<td>String</td>
<td>Hayır</td>
<td>Belgenin SMS olarak iletileceği telefon numarası. Eğer <code class="prettyprint">SMS_FLAG</code> elemanına <code class="prettyprint">Y</code> gönderilirse bu alan zorunludur. <code class="prettyprint">SMS_FLAG</code> elemanı <code class="prettyprint">Y</code> gönderilmezse bu elaman dolu olsa dahi SMS gönderilmez.</td>
</tr>
<tr>
<td><strong>SMM_PROPERTIES.EMAIL_FLAG</strong></td>
<td>String</td>
<td>Hayır</td>
<td>Belge alıcısına e-posta olarak gönderilip gönderilmeyeceğinin belirlendiği parametredir. E-Posta göndermek istenilen durumda <code class="prettyprint">Y</code> değeri gönderilmelidir. Eleman gönderilmezse <code class="prettyprint">EMAIL</code> alanı dolu olsa dahi e-posta gönderilmez. *<em>DİKKAT: Eğer müşterinin özel entegratör ile e-posta gönderme hizmeti sözleşmesi yoksa ve <code class="prettyprint">Y</code> değeri gönderilirse belgenin sisteme yüklenmesine izin verilmeyecektir. Bu durumda özel entegratör ile iletişime geçerek e-posta gönderim hizmeti satın alınmalı veya  e-posta gönderiminin farklı bir kanaldan müşteri tarafından yapılması gerekmektedir. Bu durumda bu parametre gönderilmemeli veya <code class="prettyprint">N</code> olarak gönderilmelidir. *</em></td>
</tr>
<tr>
<td><strong>SMM_PROPERTIES.EMAIL</strong></td>
<td>String</td>
<td>Hayır</td>
<td>Belgenin e-posta olarak iletileceği e-posta adresi. E-Posta formatında olmak zorundadır. E-Posta gönderimini özel entegratör sisteminden yapılması isteniyorsa <code class="prettyprint">Y</code> değeri gönderilmelidir. Varsayılan değer <code class="prettyprint">N</code> dir. <code class="prettyprint">EMAIL_FLAG</code> alanı <code class="prettyprint">Y</code> gönderildiği zaman bu elaman zorunludur. <code class="prettyprint">EMAIL_FLAG</code> gönderilmemiş veya <code class="prettyprint">N</code> değeri gönderilmişse bu elaman dolu olsa dahi e-posta gönderilmeyecektir.</td>
</tr>
<tr>
<td><strong>SERIES_PROPERTIES</strong></td>
<td>ComplexType</td>
<td>Hayır</td>
<td>Belge numarasının özel entegratör tarafından atanmasının belirleyen parametredir. <strong>Belge numarasının istemci tarafından atanmasını tavsiye ederiz.</strong></td>
</tr>
<tr>
<td><strong>SERIES_PROPERTIES.SERIES_FLAG</strong></td>
<td>String</td>
<td>Hayır</td>
<td>Belge numarasının özel entegratör tarafından atanması için <code class="prettyprint">Y</code> değeri gönderilmelidir. DİKKAT: <code class="prettyprint">SERIES_PREFIX</code> elemanında belirlenen ön ek ile belge numarası atanacak ve belge içerisinde ki değer ezilecektir.</td>
</tr>
<tr>
<td><strong>SERIES_PROPERTIES.SERIES_PREFIX</strong></td>
<td>String</td>
<td>Hayır</td>
<td>Belge numarası atanacak ön ek. 3 hane alfanumerik değer içermelidir. Belge numarası yönetimi hakkında daha detaylı bilgi almak için <strong>Başlarken -&gt; Belge Numarası Yönetimi</strong> başlığını inceleyiniz. Belge numarasının özel entegratör tarafından atanması için <code class="prettyprint">Y</code> değeri gönderilmelidir. DİKKAT: <code class="prettyprint">SERIES_FLAG</code> elemanı <code class="prettyprint">Y</code> değeri gönderilmemişse bu alan dolu olsa dahi belge numarası atanmayacaktır.</td>
</tr>
</tbody></table>

<p>Servisten dönen parametreler şu şekildedir:</p>

<table><thead>
<tr>
<th>Parametre</th>
<th>Tip</th>
<th>Açıklama</th>
</tr>
</thead><tbody>
<tr>
<td><strong>REQUEST_RETURN.INTL_TXN_ID</strong></td>
<td>String</td>
<td>Sunucuda işlemin gerçekleştirildiği transaction IDsi. Bu ID istemci tarafında kaydedilerek oluşabilecek hatalarda referans olarak destek ekibine iletilebilir.</td>
</tr>
<tr>
<td><strong>REQUEST_RETURN.RETURN_CODE</strong></td>
<td>String</td>
<td>Başarılı durumlarda <code class="prettyprint">0</code> değeri döner. Başarısız olduğunda REQUEST_RETURN objesi dönülmez. ERROR_TYPE objesi dönülecektir.</td>
</tr>
<tr>
<td><strong>REQUEST_RETURN.CLIENT_TXN_ID</strong></td>
<td>String</td>
<td>İstek ile istemci tarafından işlem IDsi gönderilmişse sonuç ile beraber dönülür.</td>
</tr>
</tbody></table>

<h3 id="kar-la-labilecek-hatalar">Karşılaşılabilecek Hatalar</h3>

<h2 id="e-smm-okuma-getsmm">E-SMM Okuma (GetSMM)</h2>

<ul>
<li>Özel entegratör platformundan imzalanmış belgeleri okumayı sağlayan servistir.</li>
<li>E-SMM belgesinin PDF formatında okunabilir.</li>
<li>Belirlenen kritere uygun kayıt bulunamamışsa sonuç boş dönecektir. Hata fırlatılmaz.</li>
<li>Sonuç tek veya çoklu dönülmesine bakılmaksızın liste olarak dönülür.</li>
</ul>

<p><br>
Servise gönderilmesi gereken parametreler şu şekildedir:</p>

<table><thead>
<tr>
<th>Parametre</th>
<th>Tip</th>
<th>Zorunluluk</th>
<th>Açıklama</th>
</tr>
</thead><tbody>
<tr>
<td><strong>REQUEST_HEADER</strong></td>
<td>ComplexType</td>
<td><strong>Evet</strong></td>
<td>Request Header objesi içerisinde <code class="prettyprint">SESSION_ID</code> ve <code class="prettyprint">APPLICATION_NAME</code> alanı zorunludur. Faturaları XML formatında sıkıştırılmadan çekmek için mutlaka <code class="prettyprint">COMPRESSED</code> elemanı eklenmeli ve <code class="prettyprint">N</code> değeri gönderilmelidir. Eğer gönderilmezse faturalar sıkıştırılmış/ziplenmiş olarak dönülecektir.</td>
</tr>
<tr>
<td><strong>SMM_SEARCH_KEY</strong></td>
<td>ComplexType</td>
<td><strong>Evet</strong></td>
<td>Belge okumak için kullanılabilecek filtre kritirleri</td>
</tr>
<tr>
<td><strong>SMM_SEARCH_KEY.LIMIT</strong></td>
<td>String</td>
<td>Hayır</td>
<td>Kaç kayıt okunmak istendiği. Eğer eleman gönderilmezse 10 adet kayıt dönülür. İçerikleri (PDF) ile beraber en fazla 100 adet kayıt dönülür. Sadece özet/başlıklarını çekildiğinde ise en fazla 25.000 adet kayıt dönülür.</td>
</tr>
<tr>
<td><strong>SMM_SEARCH_KEY.ID</strong></td>
<td>String</td>
<td>Hayır</td>
<td>Belge numarası ile okumak için kullanılabilir. örnek: SMM2018000000001</td>
</tr>
<tr>
<td><strong>SMM_SEARCH_KEY.UUID</strong></td>
<td>String</td>
<td>Hayır</td>
<td>Evrensel Tekil Tanımlama Numarası (ETTN) ile okumak için kullanılabilir.  GUID formatında</td>
</tr>
<tr>
<td><strong>SMM_SEARCH_KEY.START_DATE</strong></td>
<td>String</td>
<td>Hayır</td>
<td>Belirli tarih aralığında ki belgeleri çekmek istendiğinde dönem başlangıç tarihi. format: YYYY-MM-DD</td>
</tr>
<tr>
<td><strong>SMM_SEARCH_KEY.END_DATE</strong></td>
<td>String</td>
<td>Hayır</td>
<td>Belirli tarih aralığında ki belgeleri çekmek istendiğinde dönem bitiş tarihi format: YYYY-MM-DD</td>
</tr>
<tr>
<td><strong>SMM_SEARCH_KEY.READ_INCLUDED</strong></td>
<td>String</td>
<td>Hayır</td>
<td>Daha önce okunmuş belgeleri dönüşe dahil edilip edilmeyeceğini belirleyen parametredir. <code class="prettyprint">Y</code> değeri gönderilirse daha önce okunmuş olsa bile yanıta eklenir. Gönderilmezse veya <code class="prettyprint">N</code> gönderilirse sadece yeni gelen belgeler dönülür. Gönderilebilecek değerler: Y/N</td>
</tr>
<tr>
<td><strong>SMM_SEARCH_KEY.FROM</strong></td>
<td>String</td>
<td>Hayır</td>
<td>Gönderici vergi kimlik/TC kimlik numarası ile sorgulamak için kullanılabilir.</td>
</tr>
<tr>
<td><strong>SMM_SEARCH_KEY.TO</strong></td>
<td>String</td>
<td>Hayır</td>
<td>Alıcı vergi kimlik/TC kimlik numarası ile sadece belirli bir müşteriye gönderilen belgeleri okumak için kullanılabilir.</td>
</tr>
<tr>
<td><strong>HEADER_ONLY</strong></td>
<td>String</td>
<td>Hayır</td>
<td>Sadece özet değerler mi yoksa içerik ile beraber mi okunmak istenildiğini belirleyen parametredir. Eleman <strong>gönderilmezse</strong> veya <code class="prettyprint">N</code> değeri gönderilirse belgenin içeriği ile (XML) ile beraber dönülür. <code class="prettyprint">Y</code> değeri gönderilirse belgenin özeti dönülür.  Gönderilebilecek değerler: Y/N</td>
</tr>
<tr>
<td><strong>CONTENT_TYPE</strong></td>
<td>Enum</td>
<td>Hayır</td>
<td>Talep edilen format. Gönderilebilecek değerler: PDF</td>
</tr>
</tbody></table>

<p><br><br></p>

<p>Servisten dönen parametreler şu şekildedir:</p>

<table><thead>
<tr>
<th>Parametre</th>
<th>Tip</th>
<th>Açıklama</th>
</tr>
</thead><tbody>
<tr>
<td><strong>SMM</strong></td>
<td>ComplexType/Array</td>
<td>Sorgu kriterine uyan tekil belge. Belge numarası <code class="prettyprint">ID</code>, evrensel tekil tanımlama numarası <code class="prettyprint">UUID</code> attribute içerisinde dönülmektedir.</td>
</tr>
<tr>
<td><strong>SMM.HEADER</strong></td>
<td>ComplexType</td>
<td>Belgeye ait özet bilgileri içerir.</td>
</tr>
<tr>
<td><strong>HEADER.CUSTOMER</strong></td>
<td>ComplexType</td>
<td>Belge düzenlenen alıcı bilgisi. <code class="prettyprint">identifier</code> attribute ile VKN/TCKN bilgisi, <code class="prettyprint">name</code> attribute ile ünvan bilgisi dönülür.</td>
</tr>
<tr>
<td><strong>HEADER.ISSUE_DATE</strong></td>
<td>DateTime</td>
<td>Belge düzenlenme tarihi. YYYY-MM-DD HH:MM:SS formatında</td>
</tr>
<tr>
<td><strong>HEADER.PAYABLE_AMOUNT</strong></td>
<td>AmountType</td>
<td>Toplam ödenecek tutar.</td>
</tr>
<tr>
<td><strong>HEADER.STATUS</strong></td>
<td>String</td>
<td>Belgenin durumu. Detay için <strong>E-SMM Durumları</strong> başlığını inceleyiniz.</td>
</tr>
<tr>
<td><strong>HEADER.STATUS_DESCRIPTION</strong></td>
<td>String</td>
<td>Belge durum açıklaması. Detay için <strong>E-SMM Durumları</strong> başlığını inceleyiniz.</td>
</tr>
<tr>
<td><strong>HEADER.SMS_STATUS</strong></td>
<td>String</td>
<td>Belgenin SMS durumu. Detay için <strong>E-SMM SMS Durumları</strong> başlığını inceleyiniz.</td>
</tr>
<tr>
<td><strong>HEADER.SMS_STATUS_DESCRIPTION</strong></td>
<td>String</td>
<td>Belgenin SMS durum açıklaması. Detay için <strong>E-SMM SMS Durumları</strong> başlığını inceleyiniz.</td>
</tr>
<tr>
<td><strong>HEADER.EMAIL_STATUS</strong></td>
<td>String</td>
<td>Belgenin E-Posta durumu. Detay için <strong>E-SMM E-Posta Durumları</strong> başlığını inceleyiniz.</td>
</tr>
<tr>
<td><strong>HEADER.EMAIL_STATUS_DESCRIPTION</strong></td>
<td>String</td>
<td>Belgenin E-Posta durum açıklaması. Detay için <strong>E-SMM E-Posta Durumları</strong> başlığını inceleyiniz.</td>
</tr>
<tr>
<td><strong>HEADER.REPORT_DATE</strong></td>
<td>String</td>
<td>Belgenin E-Posta durumu. Detay için <strong>E-SMM E-Posta Durumları</strong> başlığını inceleyiniz.</td>
</tr>
<tr>
<td><strong>HEADER.EMAIL_STATUS_DESCRIPTION</strong></td>
<td>String</td>
<td>Belgenin E-Posta durum açıklaması. Detay için <strong>E-SMM E-Posta Durumları</strong> başlığını inceleyiniz.</td>
</tr>
<tr>
<td><strong>HEADER.CDATE</strong></td>
<td>String</td>
<td>Belgenin sisteme yüklendiği tarih.</td>
</tr>
<tr>
<td><strong>SMM.CONTENT</strong></td>
<td>Base64Binary</td>
<td>Belgenin içeriği. PDF formatında. Eğer <code class="prettyprint">COMPRESSED</code> parametresi <code class="prettyprint">N</code> olarak gönderilmişse PDF dosya sıkıştırılmadan, <code class="prettyprint">COMPRESSED</code> elemanı gönderilmemiş veya <code class="prettyprint">Y</code> değeri gönderilmişse sıkıştırılmış/ziplenmiş PDF dosyası dönülür.</td>
</tr>
</tbody></table>

<h2 id="e-smm-durum-sorgulama-getsmmstatus">E-SMM Durum Sorgulama (GetSMMStatus)</h2>

<ul>
<li>Özel entegratör platformuna gönderilen bir veya birden fazla belgenin durumunu sorgulamayı sağlayan servistir.</li>
<li>Birden fazla belge durumu sorgulamak için <code class="prettyprint">CREDITNOTEINFO</code> parametresi çoklanabilir.</li>
</ul>

<p>Servise gönderilmesi gereken parametreler şu şekildedir:</p>

<table><thead>
<tr>
<th>Parametre</th>
<th>Tip</th>
<th>Zorunluluk</th>
<th>Açıklama</th>
</tr>
</thead><tbody>
<tr>
<td><strong>REQUEST_HEADER</strong></td>
<td>ComplexType</td>
<td><strong>Evet</strong></td>
<td>Request Header objesi içerisinde <code class="prettyprint">SESSION_ID</code> ve <code class="prettyprint">APPLICATION_NAME</code> alanı zorunludur.</td>
</tr>
<tr>
<td><strong>CREDITNOTEINFO</strong></td>
<td>ComplexType</td>
<td><strong>Evet</strong></td>
<td>Sorgulanacak belge numarası <code class="prettyprint">ID</code> attribute içerisine, Evrensel Tekil Tanımlama Numarası (ETTN) ise <code class="prettyprint">UUID</code> attribute eklenmelidir.</td>
</tr>
</tbody></table>

<p>Servisten dönen parametreler şu şekildedir:</p>

<table><thead>
<tr>
<th>Parametre</th>
<th>Tip</th>
<th>Açıklama</th>
</tr>
</thead><tbody>
<tr>
<td><strong>CREDITNOTE</strong></td>
<td>ComplexType</td>
<td>Sorgu kriterine uyan belgelerin listesi. Belge numarası <code class="prettyprint">ID</code>, evrensel tekil tanımlama numarası  <code class="prettyprint">UUID</code> attribute içerisinde dönülmektedir.</td>
</tr>
<tr>
<td><strong>CREDITNOTE.CREDITNOTEHEADER</strong></td>
<td>ComplexType</td>
<td>Belgeye ait özet bilgiler içermektedir. Parametre listesi aşağıdadır.</td>
</tr>
<tr>
<td><strong>CREDITNOTEHEADER.ID</strong></td>
<td>String</td>
<td>Belgenin numarası.</td>
</tr>
<tr>
<td><strong>CREDITNOTEHEADER.UUID</strong></td>
<td>String</td>
<td>Belgenin evrensel tekil tanımlama numarası.</td>
</tr>
<tr>
<td><strong>CREDITNOTEHEADER.PROFILEID</strong></td>
<td>String</td>
<td>Belge senaryosu. <code class="prettyprint">EARSIVBELGE</code> değeri olabilir.</td>
</tr>
<tr>
<td><strong>CREDITNOTEHEADER.TYPE_CODE</strong></td>
<td>String</td>
<td>Belgenin tipi. <code class="prettyprint">MUSTAHSILMAKBUZ</code> değeri olabilir.</td>
</tr>
<tr>
<td><strong>CREDITNOTEHEADER.SENDER</strong></td>
<td>String</td>
<td>Belgeyi gönderen firmanın VKNsi <code class="prettyprint">VKN</code> attribute içerisinde, firma ünvanı ise <code class="prettyprint">IDENTIFIER</code> attribute içerisinde dönülmektedir.</td>
</tr>
<tr>
<td><strong>CREDITNOTEHEADER.RECEIVER</strong></td>
<td>String</td>
<td>Belgeyi alan firmanın VKNsi <code class="prettyprint">VKN</code> attribute içerisinde, firma ünvanı ise <code class="prettyprint">IDENTIFIER</code> attribute içerisinde dönülmektedir.</td>
</tr>
<tr>
<td><strong>CREDITNOTEHEADER.ISSUE_DATE</strong></td>
<td>Date</td>
<td>Belge tarihi.</td>
</tr>
<tr>
<td><strong>CREDITNOTEHEADER.ISSUE_TIME</strong></td>
<td>String</td>
<td>Belge düzenleme zamanı.</td>
</tr>
<tr>
<td><strong>CREDITNOTEHEADER.DIRECTION</strong></td>
<td>String</td>
<td>Belge yönü. Gelen irsaliye için <code class="prettyprint">IN</code>, giden irsaliye için <code class="prettyprint">OUT</code> değeri dönülür.</td>
</tr>
<tr>
<td><strong>CREDITNOTEHEADER.STATUS</strong></td>
<td>String</td>
<td>Belgenin durumu. Lütfen bu alanı kullanarak karar vermeyin. Karar vermek için <code class="prettyprint">STATUS_CODE</code> alanını kullanınız.</td>
</tr>
<tr>
<td><strong>CREDITNOTEHEADER.STATUS_CODE</strong></td>
<td>String</td>
<td>Belgenin durum kodu. Detay için <strong>İrsaliye Durumları</strong> başlığını inceleyiniz.</td>
</tr>
<tr>
<td><strong>CREDITNOTEHEADER.STATUS_DESCRIPTION</strong></td>
<td>String</td>
<td>Belgenin durum açıklaması. Detay için <strong>İrsaliye Durumları</strong> başlığını inceleyiniz.</td>
</tr>
<tr>
<td><strong>CREDITNOTEHEADER.REPORT_ID</strong></td>
<td>String</td>
<td>Belgenin rapor numarası. GİBe raporlandıktan sonra dönülmektedir.</td>
</tr>
<tr>
<td><strong>CREDITNOTEHEADER.CDATE</strong></td>
<td>DateTime</td>
<td>Belgenin sisteme ulaştığı/yüklendiği tarih.</td>
</tr>
</tbody></table>

<h2 id="e-m-stahsil-durumlar">E-Müstahsil Durumları</h2>

<table><thead>
<tr>
<th>Durum</th>
<th>Kod</th>
<th>Detaylı Açıklama</th>
</tr>
</thead><tbody>
<tr>
<td>DURUM_HENUZ_GUNCELLENMEDI</td>
<td>100</td>
<td>DURUM HENÜZ GÜNCELLENMEDİ</td>
</tr>
<tr>
<td>LOAD_SUCCEED</td>
<td>101</td>
<td>KUYRUĞA EKLENDİ</td>
</tr>
<tr>
<td>LOAD_PROCESSİNG</td>
<td>102</td>
<td>TASLAK İŞLENİYOR</td>
</tr>
<tr>
<td>PACKAGE_PROCESSING</td>
<td>103</td>
<td>PAKETLENİYOR</td>
</tr>
<tr>
<td>PACKAGE_SUCCEED</td>
<td>104</td>
<td>PAKETLENDİ</td>
</tr>
<tr>
<td>PACKAGE_FAILED</td>
<td>105</td>
<td>PAKETLEME_HATASI</td>
</tr>
<tr>
<td>SIGN_PROCESSING</td>
<td>106</td>
<td>İMZALANIYOR</td>
</tr>
<tr>
<td>SIGN_FAILED</td>
<td>106</td>
<td>İMZALANIYOR</td>
</tr>
<tr>
<td>SIGN_SUCCEED</td>
<td>107</td>
<td>İMZALANDI</td>
</tr>
<tr>
<td>RECEIVE_SUCCEED</td>
<td>133</td>
<td>BAŞARIYLA ALINDI</td>
</tr>
<tr>
<td>SEND_TIMEOUT</td>
<td>134</td>
<td>GÖNDERME İŞLEMİ SİSTEM TARAFINDAN  TEKRAR DENENECEKTİR</td>
</tr>
<tr>
<td>RECEIVE_TIMEOUT</td>
<td>134</td>
<td>GÖNDERME İŞLEMİ SİSTEM TARAFINDAN  TEKRAR DENENECEKTİR</td>
</tr>
<tr>
<td>SEND_PROCESSING</td>
<td>135</td>
<td>GÖNDERİLİYOR</td>
</tr>
<tr>
<td>SEND_FAILED</td>
<td>136</td>
<td>GÖNDERME İŞLEMİ BAŞARISIZ</td>
</tr>
<tr>
<td>SEND_SUCCEED</td>
<td>137</td>
<td>GÖNDERME İŞLEMİ BAŞARILI</td>
</tr>
</tbody></table>

          <h1 id="e-mutabakat-webservis">E-Mutabakat Webservis</h1>

<p>e-Mutabakat servisi, mükelleflerin BA/BS ve Cari mutabakatlarını yönetmlerini sağlayan webservis uygulamasıdır.</p>

<h2 id="webservice-endpoint-wsdl-url">Webservice Endpoint (WSDL) URL</h2>

<table><thead>
<tr>
<th>Ürün</th>
<th>Endpoint URL</th>
</tr>
</thead><tbody>
<tr>
<td>Kimlik Doğrulama</td>
<td><a href="https://efaturatest.izibiz.com.tr/AuthenticationWS?wsdl">https://efaturatest.izibiz.com.tr/AuthenticationWS?wsdl</a></td>
</tr>
<tr>
<td>E-Fatura Webservis</td>
<td><a href="https://efaturatest.izibiz.com.tr/EFaturaOIB?wsdl">https://efaturatest.izibiz.com.tr/EFaturaOIB?wsdl</a></td>
</tr>
<tr>
<td>E-Arşiv Fatura Webservis</td>
<td><a href="https://efaturatest.izibiz.com.tr/EIArchiveWS/EFaturaArchive?wsdl">https://efaturatest.izibiz.com.tr/EIArchiveWS/EFaturaArchive?wsdl</a></td>
</tr>
<tr>
<td>E-İrsaliye Webservis</td>
<td><a href="https://efaturatest.izibiz.com.tr/EIrsaliyeWS/EIrsaliye?wsdl">https://efaturatest.izibiz.com.tr/EIrsaliyeWS/EIrsaliye?wsdl</a></td>
</tr>
<tr>
<td>E-Müstahsil Webservis</td>
<td><a href="http://efaturatest.izibiz.com.tr/CreditNoteWS/CreditNote?wsdl">http://efaturatest.izibiz.com.tr/CreditNoteWS/CreditNote?wsdl</a></td>
</tr>
<tr>
<td>E-Mutabakat Webservis</td>
<td><a href="http://efaturatest.izibiz.com.tr/Reconciliation?wsdl">http://efaturatest.izibiz.com.tr/Reconciliation?wsdl</a></td>
</tr>
<tr>
<td>E-Serbest Meslek Webservis</td>
<td><a href="https://efaturatest.izibiz.com.tr/SmmWS?wsdl">https://efaturatest.izibiz.com.tr/SmmWS?wsdl</a></td>
</tr>
<tr>
<td>E-ZRapor Webservis</td>
<td><a href="https://efaturatest.izibiz.com.tr/ZReportWS?wsdl">https://efaturatest.izibiz.com.tr/ZReportWS?wsdl</a></td>
</tr>
</tbody></table>

<h3 id="portal-uygulamas">Portal Uygulaması</h3>

<p>Entegrasyon sürecinde Portal uygulamamızı aşağıda ki durumlar için kullanabilirsiniz:</p>

<ul>
<li>Belgelerin durumunu kontrol</li>
<li>Farklı senaryolar için belge düzenleyerek XML içeriğini kontrol</li>
<li>Alıcı firmanın mükellefiyet sorgulaması</li>
</ul>

<p>Test Portal Adresimiz: <a href="https://portaltest.izibiz.com.tr">https://portaltest.izibiz.com.tr</a></p>

<p>Test portali erişim bilgileri için <strong>entegrasyon@izibiz.com.tr</strong> adresi ile iletişime geçebilirsiniz.</p>

<h2 id="dikkat-edilecek-hususlar">Dikkat Edilecek Hususlar</h2>

<p>Uygulamanızı tasarlarken aşağıda ki bilgiler faydalı olacaktır:</p>

<ol>
<li><strong>Kimlik Doğrulama (Authentication)</strong> Webservisinde bulunan <strong>Login</strong> servisi ile oturum açarak session id alınacak. Session Id sistemimiz tarafında 8 saate kadar zaman aşımına uğramadığı için kullanıcı giriş yapınca session id alıp bütün kullanım süresinde aynı session id kullanabilirsiniz.</li>
<li><strong>SendReconciliation</strong> metodu ile BA/BS ve Cari mutabakat gönderimi yapılabilmektedir. Detaylar için <strong>E-Mutabakat Gönderme</strong> bölümünü inceleyiniz.</li>
<li><strong>GetReconciliationStatus</strong> metodu ile gönderilen mutabakatların durumları sorgulanabilir. Nihai duruma erişene kadar mutabakatların durumu özel entegratör sisteminden minumum 4 saatte bir sorgulanmalıdır. <strong>Sık sorgulama yapmayınız.</strong></li>
<li><strong>Kimlik Doğrulama (Authentication)</strong> Webservisinde bulunan <strong>Logout</strong> metodu ile kullanıcı mutabakat programını kapatınca oturum kapatılabilir.</li>
</ol>

<h2 id="e-mutabakat-entegrasyon-kontrol-listesi">E-Mutabakat Entegrasyon Kontrol Listesi</h2>

<table><thead>
<tr>
<th>Durum</th>
<th>Kontrol</th>
</tr>
</thead><tbody>
<tr>
<td><strong>Evet / Hayır</strong></td>
<td>Oturum Açmak için <strong>Kimlik Doğrulama (Authentication)</strong> webservisinde ki <strong>Login</strong> metodu kullanıldı.</td>
</tr>
<tr>
<td><strong>Evet / Hayır</strong></td>
<td>Oturum açıldıktan sonra bütün isteklerde aynı Session ID kullanılıyor. Eğer Aktif session bulunamadı hatası dönülürse yeni oturum açılıyor.</td>
</tr>
<tr>
<td><strong>Evet / Hayır</strong></td>
<td>Gönderilen her istek ile REQUEST_HEADER objesinde ki <code class="prettyprint">SESSION_ID</code> ve <code class="prettyprint">APPLICATION_NAME</code>, <code class="prettyprint">CHANNEL_NAME</code> alanları dolu gönderiliyor.</td>
</tr>
<tr>
<td><strong>Evet / Hayır</strong></td>
<td>BA/BS ve Cari Mutabakat için <strong>SendBABSReconciliation</strong> metodu kullanılarak örnek gönderim yapıldı.</td>
</tr>
<tr>
<td><strong>Evet / Hayır</strong></td>
<td>Özel entegratöre iletilen mutabakat muhasebe paketi/ERP&#39;de değişiklik yapılamıyor. Kayıt kitleniyor.</td>
</tr>
<tr>
<td><strong>Evet / Hayır</strong></td>
<td>Gönderilen mutabakatların durum sorgulaması <strong>GetBABSReconciliationStatus</strong> metodu ile yapılıyor.</td>
</tr>
<tr>
<td><strong>Evet / Hayır</strong></td>
<td>Mutabakatların durumu zamanlayıcı ile otomatik sorgulanıyorsa bu süre konfiguratif ve en az 4 saat olarak belirlendi.</td>
</tr>
<tr>
<td><strong>Evet / Hayır</strong></td>
<td>Nihai duruma ulaşmış mutabakatların durumları sorgulanmıyor.</td>
</tr>
<tr>
<td><strong>Evet / Hayır</strong></td>
<td>Kullanıcı uygulamayı kapattığında <strong>Kimlik Doğrulama (Authentication)</strong> webservisinde ki <strong>Logout</strong> metodu kullanarak oturum kapatıldı.</td>
</tr>
</tbody></table>

<h2 id="stemci-client-rnek-projeler">İstemci (client) Örnek Projeler</h2>

<p>E-Mutabakat entegrasyonu için sunucu taraflı programlama diline uygun farklı istemci(client) örnekleri sunar. Bu istemcilerden programlama yapmak istediğiniz dile uygun olanı seçip test bilgileri ile kullanmaya başlayabilirsiniz.</p>

<p><a href="/resource/client/izibiz-emutabakat-soapui-client.zip" target="_blank"><img src="/images/icon_soapui.png" height="100" width="100"/></a></p>

<h2 id="ortak-kullan-lan-eleman">Ortak Kullanılan Eleman</h2>

<p>Her webservis isteğinde gönderilmesi beklen ortak elemandır (REQUEST_HEADER)</p>

<table><thead>
<tr>
<th>Parametre</th>
<th>Tip</th>
<th>Zorunluluk</th>
<th>Açıklama</th>
</tr>
</thead><tbody>
<tr>
<td><strong>SESSION_ID</strong></td>
<td>String</td>
<td><strong>Evet</strong></td>
<td>Login Metodunda sistem tarafında gönderilen SESSION_ID bilgisi. Sonraki tüm metod çağrılarında parametre olarak metoda geçmelidir.</td>
</tr>
<tr>
<td><strong>APPLICATION_NAME</strong></td>
<td>String</td>
<td><strong>Evet</strong></td>
<td>Metodu çağıran uygulamanın adı. Mutlaka uygulama adının yazılması gerekmektedir.</td>
</tr>
<tr>
<td><strong>CHANNEL_NAME</strong></td>
<td>String</td>
<td><strong>Evet</strong></td>
<td>Metodun çağrıldığı kanal adı.</td>
</tr>
<tr>
<td><strong>COMPRESSED</strong></td>
<td>String</td>
<td>Hayır</td>
<td>İçerikte taşınan bilginin ZIP formatında sıkıştırılmış mı gönderildiği/talep edildiği bilgisi. Belge gönderim ve belge okuma servislerinde gönderilen değere göre işlem yapılmaktadır.</td>
</tr>
<tr>
<td><strong>CLIENT_TXN_ID</strong></td>
<td>String</td>
<td>Hayır</td>
<td>İstemci uygulama tarafından işlem için üretilen işlem bilgisi (transaction id) varsa istek esnasında gönderilip, sonuçta alabileceğiniz bir değerdir. request/response eşleşmesi yapmak için kullanılabilir.</td>
</tr>
<tr>
<td><strong>INT_PARENT_TXN_ID</strong></td>
<td>String</td>
<td>Hayır</td>
<td>İstemci uygulamasında ana modül entitileri ile ilişkilendirelmek istenen ana transaction ID.</td>
</tr>
<tr>
<td><strong>ACTION_DATE</strong></td>
<td>String</td>
<td>Hayır</td>
<td>Metodun çağrılma tarihi</td>
</tr>
<tr>
<td><strong>CHANGE_INFO</strong></td>
<td>Array</td>
<td>Hayır</td>
<td>Bu eleman ile eğer verilerde bir değişiklik yapılacak ise o değişikliği ait bilgi.</td>
</tr>
<tr>
<td><strong>REASON</strong></td>
<td>String</td>
<td>Hayır</td>
<td>İşlem sebebi. Fatura gönderme, fatura alma vs.</td>
</tr>
<tr>
<td><strong>HOST_NAME</strong></td>
<td>String</td>
<td>Hayır</td>
<td>Metodu çağıran sunucunun host bilgisi.</td>
</tr>
<tr>
<td><strong>SIMULATION_FLAG</strong></td>
<td>String</td>
<td>Hayır</td>
<td>Metod çağrılır ancak arkadaki işlem yapılmaz.</td>
</tr>
</tbody></table>

<h2 id="ba-bs-mutabakat-g-nderme-sendbabsreconciliation">BA/BS Mutabakat Gönderme (SendBABSReconciliation)</h2>

<ul>
<li>Özel entegratör sistemi üzerinden toplu BA/BS mutabakat gönderimini sağlayan servistir.</li>
<li>Toplu mutabakat göndermek için <code class="prettyprint">RECONCILIATION</code> parametresi çoklanabilir.</li>
<li>BA/BS mutabakat için cariye düzenlenen belge tutarı 5000 TL ve üzeri olmalıdır.</li>
</ul>

<p>Servise gönderilmesi gereken parametreler şu şekildedir:</p>

<table><thead>
<tr>
<th>Parametre</th>
<th>Tip</th>
<th>Zorunluluk</th>
<th>Açıklama</th>
</tr>
</thead><tbody>
<tr>
<td><strong>REQUEST_HEADER</strong></td>
<td>ComplexType</td>
<td><strong>Evet</strong></td>
<td>Request Header objesi içerisinde <code class="prettyprint">SESSION_ID</code> ve <code class="prettyprint">APPLICATION_NAME</code>, <code class="prettyprint">CHANNEL_NAME</code> alanı zorunludur.</td>
</tr>
<tr>
<td><strong>RECONCILIATION</strong></td>
<td>ComplexType</td>
<td><strong>Evet</strong></td>
<td>En az bir mutabakat bulunmalıdır. Toplu gönderim için bu eleman çoklanır.</td>
</tr>
<tr>
<td><strong>RECONCILIATION.CUSTOMER_IDENTIFIER</strong></td>
<td>String</td>
<td><strong>Evet</strong></td>
<td>Mutabakat gönderilecek firmanın vergi kimlik nuarası. VKN doğrulaması yapılmadığı için gönderilen verinin doğruluğu mükellefe aittir.</td>
</tr>
<tr>
<td><strong>RECONCILIATION.COMMERCIAL_NAME</strong></td>
<td>String</td>
<td><strong>Evet</strong></td>
<td>Mutabakat gönderilecek firmanın ünvanı. Alıcı firmaya gönderilen e-posta üzerinde görünecektir.</td>
</tr>
<tr>
<td><strong>RECONCILIATION.TAX_OFFICE</strong></td>
<td>String</td>
<td><strong>Evet</strong></td>
<td>Mutabakat gönderilecek firmanın vergi dairesi.</td>
</tr>
<tr>
<td><strong>RECONCILIATION.CUSTOMER_ADDRESS</strong></td>
<td>String</td>
<td><strong>Evet</strong></td>
<td>Mutabakat gönderilecek firmanın adresi.</td>
</tr>
<tr>
<td><strong>RECONCILIATION.TELEFONE_NO</strong></td>
<td>String</td>
<td><strong>Evet</strong></td>
<td>Mutabakat gönderilecek firmanın telefon numarası. <strong>Format: 0 (212) 555 55 55</strong></td>
</tr>
<tr>
<td><strong>RECONCILIATION.FAX_NO</strong></td>
<td>String</td>
<td>Hayır</td>
<td>Mutabakat gönderilecek firmanın faks numarası. <strong>Format: 0 (212) 555 55 55</strong></td>
</tr>
<tr>
<td><strong>RECONCILIATION.EMAIL</strong></td>
<td>String</td>
<td>Hayır</td>
<td>Mutabakat gönderilecek firmanın e-posta adresi. E-posta adresinin formatı kontrol edilir ancak doğruluğu ve geçerliliği mükellefin sorumluluğundadır. <strong>Format: muhasebe@firma.com.tr</strong></td>
</tr>
<tr>
<td><strong>RECONCILIATION.NOTE</strong></td>
<td>String</td>
<td>Hayır</td>
<td>Mutabakat gönderilecek firmaya iletilmek istenilen not metni. Maksimum 250 karakter gönderilebilir.</td>
</tr>
<tr>
<td><strong>RECONCILIATION.ACCOUNTING_PERIOD</strong></td>
<td>String</td>
<td>Hayır</td>
<td>Mutabakat dönemi. <strong>Format: 201807</strong></td>
</tr>
<tr>
<td><strong>RECONCILIATION.BA_DOCUMENT_COUNT</strong></td>
<td>String</td>
<td>Hayır</td>
<td>BA mutabakat belge adeti.</td>
</tr>
<tr>
<td><strong>RECONCILIATION.BA_DOCUMENT_AMAOUT</strong></td>
<td>Decimal</td>
<td>Hayır</td>
<td>BA mutabakat belgelerinin toplam tutarı.</td>
</tr>
<tr>
<td><strong>RECONCILIATION.BS_DOCUMENT_COUNT</strong></td>
<td>String</td>
<td>Hayır</td>
<td>BS mutabakat belge adeti.</td>
</tr>
<tr>
<td><strong>RECONCILIATION.BA_DOCUMENT_AMAOUT</strong></td>
<td>Decimal</td>
<td>Hayır</td>
<td>BS mutabakat belgelerinin toplam tutarı.</td>
</tr>
</tbody></table>

<p><br><br></p>

<p>Servisten dönen parametreler şu şekildedir:</p>

<table><thead>
<tr>
<th>Parametre</th>
<th>Tip</th>
<th>Açıklama</th>
</tr>
</thead><tbody>
<tr>
<td><strong>REQUEST_RETURN.INT_TXN_ID</strong></td>
<td>String</td>
<td>Sunucuda işlemin gerçekleştirildiği transaction IDsi. Bu ID istemci tarafında kaydedilerek oluşabilecek hatalarda referans olarak destek ekibine iletilebilir.</td>
</tr>
<tr>
<td><strong>REQUEST_RETURN.RETURN_CODE</strong></td>
<td>String</td>
<td>Başarılı durumlarda <code class="prettyprint">0</code> değeri döner. Başarısız olduğunda WS Fault objesi dönecektir.</td>
</tr>
</tbody></table>

<h3 id="e-mutabakat-hata-kodlar">E-Mutabakat Hata Kodları</h3>

<table><thead>
<tr>
<th>Hata Kodu</th>
<th>Hata Açıklaması</th>
</tr>
</thead><tbody>
<tr>
<td>200</td>
<td>EKSİK VEYA HATALI PARAMETRE (PARAMETRE ADI)</td>
</tr>
<tr>
<td>210</td>
<td>YETKİ HATASI(xxx.xxx.xxx.xxx adresinin bu işleme yetkisi yoktur)</td>
</tr>
<tr>
<td>220</td>
<td>GÜNLÜK İSTEK LİTİMİ AŞILDI</td>
</tr>
<tr>
<td>230</td>
<td>MUTABAKAT SİSTEMDE MEVCUT ( VKN/TCKN:XXXXX, DÖNEM:yyyymm)</td>
</tr>
<tr>
<td>240</td>
<td>BELGE KONTROL HATASI (MEVZUATA UYGUN OLMAYAN MUTABAKAT KAYDI MEVCUT (5000 TL Limiti)</td>
</tr>
<tr>
<td>250</td>
<td>GEÇERSİZ E-POSTA FORMATI( eposta@adfads.com)</td>
</tr>
</tbody></table>

<h2 id="ba-bs-mutabakat-durum-sorgulama-getbabsreconciliationstatus">BA/BS Mutabakat Durum Sorgulama (GetBABSReconciliationStatus)</h2>

<ul>
<li>Entegrasyon platformunda bulunan BA/BS mutabakatın durumunu sorgulamayı sağlayan servistir.</li>
</ul>

<p>Servise gönderilmesi gereken parametreler şu şekildedir:</p>

<table><thead>
<tr>
<th>Parametre</th>
<th>Tip</th>
<th>Zorunluluk</th>
<th>Açıklama</th>
</tr>
</thead><tbody>
<tr>
<td><strong>REQUEST_HEADER</strong></td>
<td>ComplexType</td>
<td><strong>Evet</strong></td>
<td>Request Header objesi içerisinde <code class="prettyprint">SESSION_ID</code> ve <code class="prettyprint">APPLICATION_NAME</code>, <code class="prettyprint">CHANNEL_NAME</code> alanı zorunludur.</td>
</tr>
<tr>
<td><strong>RECONCILIATION_SEARCHING</strong></td>
<td>ComplexType</td>
<td><strong>Evet</strong></td>
<td>Sorgulanacak mutabakatlara ait kriterleri belirlemek için kullanılır.</td>
</tr>
<tr>
<td><strong>SEARCH_KEY.CUSTOMER_IDENTIFIER</strong></td>
<td>String</td>
<td>Hayır</td>
<td>Durumu sorgulanacak müşteri VKN/TCKN. Bir dönemde sadece bir cari/mükellefe ait mutabakatın durumunu sorgulamak için kullanılabilir.</td>
</tr>
<tr>
<td><strong>SEARCH_KEY.ACCOUNTING_PERIOD</strong></td>
<td>String</td>
<td><strong>Evet</strong></td>
<td>Durumu sorgulanacak mutabakat dönemi. Bir dönemde ki bütün mutabakatların durumunu sorgulamak için kullanılır.</td>
</tr>
</tbody></table>

<p>Servisten dönen parametreler şu şekildedir:</p>

<table><thead>
<tr>
<th>Parametre</th>
<th>Tip</th>
<th>Açıklama</th>
</tr>
</thead><tbody>
<tr>
<td><strong>RECONCILIATION_STATUS</strong></td>
<td>ComplexType</td>
<td>Mutabakat durum sonuç objesi. Eğer aranan kritere uygun mutabakat bulunmuyorsa sonuç boş kayıt döner.</td>
</tr>
<tr>
<td><strong>RECONCILIATION_STATUS.RECONCILATION</strong></td>
<td>ComplexType</td>
<td>Durumu sorgulaması kriterine uyan mutabakat objesi.</td>
</tr>
<tr>
<td><strong>RECONCILATION.CUSTOMER_IDENTIFIER</strong></td>
<td>String</td>
<td>Mutabakat gönderilen mükellef VKN/TCKN.</td>
</tr>
<tr>
<td><strong>RECONCILIATION.ACCOUNTING_PERIOD</strong></td>
<td>String</td>
<td>Mutabakat dönemi. <strong>Format: 201807</strong></td>
</tr>
<tr>
<td><strong>RECONCILIATION.STATUS_CODE</strong></td>
<td>String</td>
<td>Mutabakat durum kodu. Detaylar için E-Mutabakat durum kodları başlığını inceleyebilirsiniz.</td>
</tr>
<tr>
<td><strong>RECONCILIATION.STATUS_DESCRIPTION</strong></td>
<td>String</td>
<td>Mutabakat durum açıklaması. Detaylar için E-Mutabakat durum kodları başlığını inceleyebilirsiniz.</td>
</tr>
<tr>
<td><strong>RECONCILIATION.CREATE_DATE</strong></td>
<td>DateTime</td>
<td>Mutabakatın özel entegratör sistemine yüklendiği tarih.</td>
</tr>
<tr>
<td><strong>RECONCILIATION.EMAIL</strong></td>
<td>ComplexType</td>
<td>Mutabakatın e-posta durum sonuç objesi</td>
</tr>
<tr>
<td><strong>RECONCILIATION.EMAIL_STATUS_CODE</strong></td>
<td>String</td>
<td>Mutabakatın e-posta durum kodu. Detaylar için E-Mutabakat e-posta durum kodları başlığını inceleyebilirsiniz.</td>
</tr>
<tr>
<td><strong>RECONCILIATION.EMAIL_STATUS_DESCRIPTION</strong></td>
<td>String</td>
<td>Mutabakatın e-posta durum açıklaması. Detaylar için E-Mutabakat e-posta durum kodları başlığını inceleyebilirsiniz.</td>
</tr>
<tr>
<td><strong>RECONCILIATION.EMAIL_STATUS_DATE</strong></td>
<td>DateTime</td>
<td>Mutabakatın e-posta durum tarihi.</td>
</tr>
</tbody></table>

<h3 id="e-mutabakat-durumlar">E-Mutabakat Durumları</h3>

<table><thead>
<tr>
<th>Durum Kodu</th>
<th>Durum Açıklaması</th>
</tr>
</thead><tbody>
<tr>
<td>100</td>
<td>KUYRUĞA EKLENDİ</td>
</tr>
<tr>
<td>105</td>
<td>TASLAK OLARAK EKLENDİ</td>
</tr>
<tr>
<td>110</td>
<td>İŞLENİYOR</td>
</tr>
<tr>
<td>120</td>
<td>İŞLENDİ</td>
</tr>
<tr>
<td>125</td>
<td>MUTABIK</td>
</tr>
<tr>
<td>126</td>
<td>MUTABIK DEĞİL</td>
</tr>
</tbody></table>

<h3 id="e-mutabakat-e-posta-g-nderim-durumlar">E-Mutabakat E-Posta Gönderim Durumları</h3>

<table><thead>
<tr>
<th>Durum Kodu</th>
<th>Durum Açıklaması</th>
</tr>
</thead><tbody>
<tr>
<td>100</td>
<td>HENÜZ İŞLENMEDİ</td>
</tr>
<tr>
<td>110</td>
<td>İŞLENİYOR</td>
</tr>
<tr>
<td>120</td>
<td>İŞLENDİ</td>
</tr>
<tr>
<td>130</td>
<td>E-POSTA GÖNDERİM SONLANDI</td>
</tr>
</tbody></table>

          <h1 id="z-rapor-webservis">Z-Rapor Webservis</h1>

<p>ZRapor servisi, mükelleflerin yeni veya eski nesil ÖKC cihazlarından alınan Z-Raporlarınını Gelir İdaresi Başkanlığına raporlanmasını sağlayan servistir.</p>

<h2 id="webservice-endpoint-wsdl-url">Webservice Endpoint (WSDL) URL</h2>

<table><thead>
<tr>
<th>Ürün</th>
<th>Endpoint URL</th>
</tr>
</thead><tbody>
<tr>
<td>Kimlik Doğrulama</td>
<td><a href="https://efaturatest.izibiz.com.tr/AuthenticationWS?wsdl">https://efaturatest.izibiz.com.tr/AuthenticationWS?wsdl</a></td>
</tr>
<tr>
<td>E-Fatura Webservis</td>
<td><a href="https://efaturatest.izibiz.com.tr/EFaturaOIB?wsdl">https://efaturatest.izibiz.com.tr/EFaturaOIB?wsdl</a></td>
</tr>
<tr>
<td>E-Arşiv Fatura Webservis</td>
<td><a href="https://efaturatest.izibiz.com.tr/EIArchiveWS/EFaturaArchive?wsdl">https://efaturatest.izibiz.com.tr/EIArchiveWS/EFaturaArchive?wsdl</a></td>
</tr>
<tr>
<td>E-İrsaliye Webservis</td>
<td><a href="https://efaturatest.izibiz.com.tr/EIrsaliyeWS/EIrsaliye?wsdl">https://efaturatest.izibiz.com.tr/EIrsaliyeWS/EIrsaliye?wsdl</a></td>
</tr>
<tr>
<td>E-Müstahsil Webservis</td>
<td><a href="http://efaturatest.izibiz.com.tr/CreditNoteWS/CreditNote?wsdl">http://efaturatest.izibiz.com.tr/CreditNoteWS/CreditNote?wsdl</a></td>
</tr>
<tr>
<td>E-Mutabakat Webservis</td>
<td><a href="http://efaturatest.izibiz.com.tr/Reconciliation?wsdl">http://efaturatest.izibiz.com.tr/Reconciliation?wsdl</a></td>
</tr>
<tr>
<td>E-Serbest Meslek Webservis</td>
<td><a href="https://efaturatest.izibiz.com.tr/SmmWS?wsdl">https://efaturatest.izibiz.com.tr/SmmWS?wsdl</a></td>
</tr>
<tr>
<td>E-ZRapor Webservis</td>
<td><a href="https://efaturatest.izibiz.com.tr/ZReportWS?wsdl">https://efaturatest.izibiz.com.tr/ZReportWS?wsdl</a></td>
</tr>
</tbody></table>

<h3 id="portal-uygulamas">Portal Uygulaması</h3>

<p>Entegrasyon sürecinde Portal uygulamamızı aşağıda ki durumlar için kullanabilirsiniz:</p>

<ul>
<li>Belgelerin durumunu kontrol</li>
<li>Farklı senaryolar için belge düzenleyerek XML içeriğini kontrol</li>
<li>Alıcı firmanın mükellefiyet sorgulaması</li>
</ul>

<p>Test Portal Adresimiz: <a href="https://portaltest.izibiz.com.tr">https://portaltest.izibiz.com.tr</a></p>

<p>Test portali erişim bilgileri için <strong>entegrasyon@izibiz.com.tr</strong> adresi ile iletişime geçebilirsiniz.</p>

<h2 id="dikkat-edilecek-hususlar">Dikkat Edilecek Hususlar</h2>

<p>Uygulamanızı tasarlarken aşağıda ki bilgiler faydalı olacaktır:</p>

<ol>
<li><strong>Kimlik Doğrulama (Authentication)</strong> Webservisinde bulunan <strong>Login</strong> servisi ile oturum açarak session id alınacak. Session Id sistemimiz tarafında 8 saate kadar zaman aşımına uğramadığı için kullanıcı giriş yapınca session id alıp bütün kullanım süresinde aynı session id kullanabilirsiniz.</li>
<li><strong>LoadZReport</strong> metodu ile tekil veya toplu Z-Rapor yüklemesi yapılır.</li>
<li><strong>GetZReportStatus</strong> metodu ile gönderilen Z-Raporlarının durumları sorgulanabilir.</li>
<li><strong>GetZReport</strong> metodu ile gönderilen Z-Raporlar tekrar istemciye çekilebilir veya son yüklenen Z-Rapor bilgisi sorgulanabilir.</li>
<li><strong>CancelZReport</strong> metodu ile gönderilen Z-Raporlar iptal edilebilir. <strong>İptal edilen Z-Raport tekrar yüklenmelidir.</strong></li>
<li><strong>Kimlik Doğrulama (Authentication)</strong> Webservisinde bulunan <strong>Logout</strong> metodu ile kullanıcı mutabakat programını kapatınca oturum kapatılabilir.</li>
</ol>

<h2 id="z-rapor-entegrasyon-kontrol-listesi">Z-Rapor Entegrasyon Kontrol Listesi</h2>

<table><thead>
<tr>
<th>Durum</th>
<th>Kontrol</th>
</tr>
</thead><tbody>
<tr>
<td><strong>Evet / Hayır</strong></td>
<td>Oturum Açmak için <strong>Kimlik Doğrulama (Authentication)</strong> webservisinde ki <strong>Login</strong> metodu kullanıldı.</td>
</tr>
</tbody></table>

<h2 id="stemci-client-rnek-projeler">İstemci (client) Örnek Projeler</h2>

<p>Z-Rapor entegrasyonu için sunucu taraflı programlama diline uygun farklı istemci(client) örnekleri sunar. Bu istemcilerden programlama yapmak istediğiniz dile uygun olanı seçip test bilgileri ile kullanmaya başlayabilirsiniz.</p>

<p><a href="/resource/client/izibiz-zrapor-soapui-client.zip" target="_blank"><img src="/images/icon_soapui.png" height="100" width="100"/></a></p>

<h2 id="ortak-kullan-lan-eleman">Ortak Kullanılan Eleman</h2>

<p>Her webservis isteğinde gönderilmesi beklen ortak elemandır (REQUEST_HEADER)</p>

<table><thead>
<tr>
<th>Parametre</th>
<th>Tip</th>
<th>Zorunluluk</th>
<th>Açıklama</th>
</tr>
</thead><tbody>
<tr>
<td><strong>SESSION_ID</strong></td>
<td>String</td>
<td><strong>Evet</strong></td>
<td>Login Metodunda sistem tarafında gönderilen SESSION_ID bilgisi. Sonraki tüm metod çağrılarında parametre olarak metoda geçmelidir.</td>
</tr>
<tr>
<td><strong>APPLICATION_NAME</strong></td>
<td>String</td>
<td><strong>Evet</strong></td>
<td>Metodu çağıran uygulamanın adı. Mutlaka uygulama adının yazılması gerekmektedir.</td>
</tr>
<tr>
<td><strong>CHANNEL_NAME</strong></td>
<td>String</td>
<td><strong>Evet</strong></td>
<td>Metodun çağrıldığı kanal adı.</td>
</tr>
<tr>
<td><strong>COMPRESSED</strong></td>
<td>String</td>
<td>Hayır</td>
<td>İçerikte taşınan bilginin ZIP formatında sıkıştırılmış mı gönderildiği/talep edildiği bilgisi. Belge gönderim ve belge okuma servislerinde gönderilen değere göre işlem yapılmaktadır.</td>
</tr>
<tr>
<td><strong>CLIENT_TXN_ID</strong></td>
<td>String</td>
<td>Hayır</td>
<td>İstemci uygulama tarafından işlem için üretilen işlem bilgisi (transaction id) varsa istek esnasında gönderilip, sonuçta alabileceğiniz bir değerdir. request/response eşleşmesi yapmak için kullanılabilir.</td>
</tr>
<tr>
<td><strong>INT_PARENT_TXN_ID</strong></td>
<td>String</td>
<td>Hayır</td>
<td>İstemci uygulamasında ana modül entitileri ile ilişkilendirelmek istenen ana transaction ID.</td>
</tr>
<tr>
<td><strong>ACTION_DATE</strong></td>
<td>String</td>
<td>Hayır</td>
<td>Metodun çağrılma tarihi</td>
</tr>
<tr>
<td><strong>CHANGE_INFO</strong></td>
<td>Array</td>
<td>Hayır</td>
<td>Bu eleman ile eğer verilerde bir değişiklik yapılacak ise o değişikliği ait bilgi.</td>
</tr>
<tr>
<td><strong>REASON</strong></td>
<td>String</td>
<td>Hayır</td>
<td>İşlem sebebi. Fatura gönderme, fatura alma vs.</td>
</tr>
<tr>
<td><strong>HOST_NAME</strong></td>
<td>String</td>
<td>Hayır</td>
<td>Metodu çağıran sunucunun host bilgisi.</td>
</tr>
<tr>
<td><strong>SIMULATION_FLAG</strong></td>
<td>String</td>
<td>Hayır</td>
<td>Metod çağrılır ancak arkadaki işlem yapılmaz.</td>
</tr>
</tbody></table>

<h2 id="z-rapor-y-kleme-loadzreport">Z-Rapor Yükleme (LoadZReport)</h2>

<ul>
<li>Özel entegratör sistemi üzerinden Z-Raporlarının GİB&#39;e raporlanmasını sağlayan servistir.</li>
<li>Toplu Z-Rapor yüklemek için <code class="prettyprint">ZREPORT</code> parametresi çoklanabilir.</li>
</ul>

<p>Servise gönderilmesi gereken parametreler şu şekildedir:</p>

<table><thead>
<tr>
<th>Parametre</th>
<th>Tip</th>
<th>Zorunluluk</th>
<th>Açıklama</th>
</tr>
</thead><tbody>
<tr>
<td><strong>REQUEST_HEADER</strong></td>
<td>ComplexType</td>
<td><strong>Evet</strong></td>
<td>Request Header objesi içerisinde <code class="prettyprint">SESSION_ID</code> ve <code class="prettyprint">APPLICATION_NAME</code>, <code class="prettyprint">CHANNEL_NAME</code> alanı zorunludur.</td>
</tr>
<tr>
<td><strong>ZREPORT</strong></td>
<td>ComplexType</td>
<td><strong>Evet</strong></td>
<td>En az bir Z-Rapor bulunmalıdır. Toplu gönderim için bu eleman çoklanır.</td>
</tr>
<tr>
<td><strong>ZREPORT.SUBE_KODU</strong></td>
<td>String</td>
<td>Hayır</td>
<td>ÖKC kurulu olduğu şube numarası. Eğer şebeli yapı yoksa varsayılan şube kodu 001 olarak kaydedilir.</td>
</tr>
<tr>
<td><strong>ZREPORT.OKC_SICIL_NO</strong></td>
<td>String</td>
<td><strong>Evet</strong></td>
<td>ÖKC Firma Kodu ile birlikte Cihaz Sicil No’su yazılacaktır. Örnek:LH0001</td>
</tr>
<tr>
<td><strong>ZREPORT.EKU_NO</strong></td>
<td>String</td>
<td><strong>Evet</strong></td>
<td>ÖKC cihazına ait EKU numarası.</td>
</tr>
<tr>
<td>****</td>
<td>String</td>
<td><strong>Evet</strong></td>
<td>Mutabakat gönderilecek firmanın adresi.</td>
</tr>
<tr>
<td><strong>ZREPORT.ZRAPOR_NO</strong></td>
<td>String</td>
<td><strong>Evet</strong></td>
<td>Z-Rapor numarası</td>
</tr>
<tr>
<td><strong>ZREPORT.ZRAPOR_TARIH</strong></td>
<td>String</td>
<td><strong>Evet</strong></td>
<td>Z-Rapor tarihi. <strong>Format: YYYY-MM-DD</strong></td>
</tr>
<tr>
<td><strong>ZREPORT.SATIS_TUTAR</strong></td>
<td>Decimal</td>
<td><strong>Evet</strong></td>
<td>Z-Raporda ki satış tutarı</td>
</tr>
<tr>
<td><strong>ZREPORT.VERGI_KDV</strong></td>
<td>Decimal</td>
<td><strong>Evet</strong></td>
<td>Z-Raporda ki toplam KDV tutarı.</td>
</tr>
<tr>
<td><strong>ZREPORT.VERGI_OTV</strong></td>
<td>Decimal</td>
<td>Hayır</td>
<td>Z-Raporda ki toplam OTV tutarı (Eğer varsa)</td>
</tr>
</tbody></table>

<p><br><br></p>

<p>Servisten dönen parametreler şu şekildedir:</p>

<table><thead>
<tr>
<th>Parametre</th>
<th>Tip</th>
<th>Açıklama</th>
</tr>
</thead><tbody>
<tr>
<td><strong>REQUEST_RETURN.INT_TXN_ID</strong></td>
<td>String</td>
<td>Sunucuda işlemin gerçekleştirildiği transaction IDsi. Bu ID istemci tarafında kaydedilerek oluşabilecek hatalarda referans olarak destek ekibine iletilebilir.</td>
</tr>
<tr>
<td><strong>REQUEST_RETURN.RETURN_CODE</strong></td>
<td>String</td>
<td>Başarılı durumlarda <code class="prettyprint">0</code> değeri döner. Başarısız olduğunda WS Fault objesi dönecektir.</td>
</tr>
</tbody></table>

<h3 id="z-rapor-hata-kodlar">Z-Rapor Hata Kodları</h3>

<table><thead>
<tr>
<th>Hata Kodu</th>
<th>Hata Açıklaması</th>
</tr>
</thead><tbody>
<tr>
<td>200</td>
<td>EKSİK VEYA HATALI PARAMETRE (PARAMETRE ADI)</td>
</tr>
<tr>
<td>210</td>
<td>YETKİ HATASI(xxx.xxx.xxx.xxx adresinin bu işleme yetkisi yoktur)</td>
</tr>
<tr>
<td>220</td>
<td>GÜNLÜK İSTEK LİTİMİ AŞILDI</td>
</tr>
<tr>
<td>230</td>
<td>BELGE SİSTEMDE MEVCUT ( ZRAPOR:XXXXX)</td>
</tr>
<tr>
<td>240</td>
<td>BELGE KONTROL HATASI ()</td>
</tr>
</tbody></table>

<h2 id="z-rapor-sorgulama-ekme-getzreport">Z-Rapor Sorgulama / Çekme (GetZReport)</h2>

<ul>
<li>Entegrasyon platformunda bulunan Z-Raporun sorgulamasını sağlayan servistir.</li>
<li><strong>SON_RAPOR</strong> parametresi <code class="prettyprint">Y</code> göndererek son yüklenen Z-Rapor bilgisi çekilebilir.</li>
</ul>

<p><br>
Servise gönderilmesi gereken parametreler şu şekildedir:</p>

<table><thead>
<tr>
<th>Parametre</th>
<th>Tip</th>
<th>Zorunluluk</th>
<th>Açıklama</th>
</tr>
</thead><tbody>
<tr>
<td><strong>REQUEST_HEADER</strong></td>
<td>ComplexType</td>
<td><strong>Evet</strong></td>
<td>Request Header objesi içerisinde <code class="prettyprint">SESSION_ID</code> ve <code class="prettyprint">APPLICATION_NAME</code> alanı zorunludur. Faturaları XML formatında sıkıştırılmadan çekmek için mutlaka <code class="prettyprint">COMPRESSED</code> elemanı eklenmeli ve <code class="prettyprint">N</code> değeri gönderilmelidir. Eğer gönderilmezse faturalar sıkıştırılmış/ziplenmiş olarak dönülecektir.</td>
</tr>
<tr>
<td><strong>SON_RAPOR</strong></td>
<td>String</td>
<td>Hayır</td>
<td>Sadece son yüklenen Z-Raporu sorgulamak için <code class="prettyprint">Y</code> değerleri gönderilebilir.  Eleman <strong>gönderilmezse</strong> veya <code class="prettyprint">N</code> değeri gönderilirse diğer kriterlere uyan kayıtlar dönülür. Gönderilebilecek değerler: Y/N</td>
</tr>
<tr>
<td><strong>ZREPORT_SEARCH_KEY.LIMIT</strong></td>
<td>Integer</td>
<td>Hayır</td>
<td>Kaç kayıt okunmak istendiği. Eğer eleman gönderilmezse en fazla 25.000 adet kayıt dönülür.</td>
</tr>
<tr>
<td><strong>ZREPORT_SEARCH_KEY.SUBE_KODU</strong></td>
<td>String</td>
<td>Hayır</td>
<td>Şube kodu. Şubeli yapısı olan müşteriler için bir şubeye ait Z-Raporları sorgulamak için kullanılabilir.</td>
</tr>
<tr>
<td><strong>ZREPORT_SEARCH_KEY.OKC_SICIL_NO</strong></td>
<td>String</td>
<td>Hayır</td>
<td>ÖKC cihaz sicil numarası</td>
</tr>
<tr>
<td><strong>ZREPORT_SEARCH_KEY.EKU_NO</strong></td>
<td>String</td>
<td>Hayır</td>
<td>ÖKC cihaz EKU numarası</td>
</tr>
<tr>
<td><strong>ZREPORT_SEARCH_KEY.ZRAPOR_NO</strong></td>
<td>String</td>
<td>Hayır</td>
<td>Z-Rapor numarası</td>
</tr>
<tr>
<td><strong>ZREPORT_SEARCH_KEY.BASLANGIC_TARIH</strong></td>
<td>String</td>
<td>Hayır</td>
<td>Belirli tarih aralığında ki belgeleri çekmek istendiğinde dönem başlangıç tarihi. format: YYYY-MM-DD</td>
</tr>
<tr>
<td><strong>ZREPORT_SEARCH_KEY.BITIS_TARIH</strong></td>
<td>String</td>
<td>Hayır</td>
<td>Belirli tarih aralığında ki belgeleri çekmek istendiğinde dönem bitiş tarihi format: YYYY-MM-DD</td>
</tr>
</tbody></table>

<p><br><br></p>

<p>Servisten dönen parametreler şu şekildedir:</p>

<table><thead>
<tr>
<th>Parametre</th>
<th>Tip</th>
<th>Açıklama</th>
</tr>
</thead><tbody>
<tr>
<td><strong>ZREPORT</strong></td>
<td>ComplexType</td>
<td>Sorgu kriterine uyan belgelerin listesi.</td>
</tr>
<tr>
<td><strong>ZREPORT.SUBE_KODU</strong></td>
<td>String</td>
<td>ÖKC kurulu olduğu şube numarası.</td>
</tr>
<tr>
<td><strong>ZREPORT.OKC_SICIL_NO</strong></td>
<td>String</td>
<td>ÖKC Sicil numarası</td>
</tr>
<tr>
<td><strong>ZREPORT.EKU_NO</strong></td>
<td>String</td>
<td>ÖKC cihazına ait EKU numarası.</td>
</tr>
<tr>
<td><strong>ZREPORT.ZRAPOR_NO</strong></td>
<td>String</td>
<td>Z-Rapor numarası</td>
</tr>
<tr>
<td><strong>ZREPORT.ZRAPOR_TARIH</strong></td>
<td>String</td>
<td>Z-Rapor tarihi. <strong>Format: YYYY-MM-DD</strong></td>
</tr>
<tr>
<td><strong>ZREPORT.SATIS_TUTAR</strong></td>
<td>Decimal</td>
<td>Z-Raporda ki satış tutarı</td>
</tr>
<tr>
<td><strong>ZREPORT.VERGI_KDV</strong></td>
<td>Decimal</td>
<td>Z-Raporda ki toplam KDV tutarı.</td>
</tr>
<tr>
<td><strong>ZREPORT.VERGI_OTV</strong></td>
<td>Decimal</td>
<td>Z-Raporda ki toplam OTV tutarı (Eğer varsa)</td>
</tr>
<tr>
<td><strong>ZREPORT.ZREPORT_DETAIL</strong></td>
<td>ComplexType</td>
<td>Z-Rapora ait durum, rapor vs detayları</td>
</tr>
<tr>
<td><strong>ZREPORT_DETAIL.STATUS</strong></td>
<td>String</td>
<td>Z-Raporun durumu</td>
</tr>
<tr>
<td><strong>ZREPORT_DETAIL.STATUS_CODE</strong></td>
<td>Integer</td>
<td>Z-Raporun durum kodu</td>
</tr>
<tr>
<td><strong>ZREPORT_DETAIL.STATUS_DESCRIPTION</strong></td>
<td>String</td>
<td>Z-Raporun durum açıklaması</td>
</tr>
<tr>
<td><strong>ZREPORT_DETAIL.REPORT_IDENTIFIER</strong></td>
<td>String</td>
<td>Z-Raporun GİB&#39;e raporlandığı rapora ait ETTN bilgisi. Raporlanmadı ise eleman dönülmez.</td>
</tr>
<tr>
<td><strong>ZREPORT_DETAIL.REPORT_DATE</strong></td>
<td>String</td>
<td>Z-Raporun GİB&#39;e raporlandığı raporun tarihi. Raporlanmadı ise eleman dönülmez.</td>
</tr>
<tr>
<td><strong>ZREPORT_DETAIL.REPORT_STATUS_CODE</strong></td>
<td>String</td>
<td>Z-Raporun GİB&#39;e raporlandığı raporun durum kodu. Raporlanmadı ise eleman dönülmez.</td>
</tr>
<tr>
<td><strong>ZREPORT_DETAIL.REPORT_STATUS_DESCRIPTION</strong></td>
<td>String</td>
<td>Z-Raporun GİB&#39;e raporlandığı raporun durum açıklaması. Raporlanmadı ise eleman dönülmez.</td>
</tr>
</tbody></table>

          <h1 id="z-b-z-e-defter-uygulamas">İZİBİZ E-Defter Uygulaması</h1>

<h2 id="uygulaman-n-zellikleri">Uygulamanın Özellikleri</h2>

<ul>
<li>Platform bağımsız özelliği ile veritabanına erişerek doğrudan veya CSV formatında veri aktarımı desteklenmektedir</li>
<li>Yaygın kullanılan muhasebe sistemleri ile tam uyumludur. Veritabanına erişilebilen bütün senaryoları desteklemektedir</li>
<li>Yevmiye ve sıra numaralandırmasını ERP&#39;den veya E-Defter programından yapabilme</li>
<li>Kullanıcı yönetim ve yetkilendirme modülü ile sınırsız kullanıcı oluşturma ve yetkilendirme</li>
<li>Defter Oluşturma</li>
<li>Defter İmzalama</li>
<li>Berat Oluşturma</li>
<li>Berat İmzalama</li>
<li>GIB’e Otomatik Berat Yükleme</li>
<li>GIB’den Otomatik Berat İndirme</li>
<li>Birden fazla firmanın e-Defter ihtiyacını tek kurulum ile yönetebilme</li>
<li>Organizasyon yönetimi ile çoklu firma ve çoklu şube yönetimi desteklenmektedir</li>
<li>Kolay arayüzü ve yüksek performans sayesinde hızlı e-defter üretme ve takip</li>
<li>Doğrudan GİB entegrasyonu sayesinde program içerisinden online berat yükleme ve indirme</li>
<li>Oluşturulan E-Defterlerin İzibiz sunucularında saklama özelliği</li>
<li>Mali mühürün ortak bir sunucuda kurulumu yapılarak bir çok bilgisayarda kullanılması</li>
<li>İmzalama yönteminde mali mühür yanında zaman damgası kullanımı tercih ederek verinin değişmezliğinin sağlanması</li>
<li>Dönemde tarih aralığına göre defter oluşturma ve boyuta göre parçalama özelliği</li>
<li>Kullanıcı hatalarını önleyen arayüzü sayesinde iş akışına göre butonların aktif olması</li>
<li>Entegrasyon kaynağından aktarılan verilerin GİB standartlarına uygunluk kontrolü ve hatalı kayıt bazında kullanıcının uyarılması</li>
</ul>

<h2 id="rnek-verideseni">Örnek Verideseni</h2>

<p>İZİBİZ E-Defter uygulaması platform bağımsızdır. Bundan dolayı verilerin kaynak ortamda programın beklediği formatta hazırlanması beklemektedir. Beklenen veri desen hakkında aşağıda detaylı bilgi paylaşılmıştır.</p>

<p>Hazırlanan veriler <strong>CSV formatında</strong> olarak veya <strong>veritabanında View (Görünüm)</strong> hazırlanarak programa aktarılabilir.</p>

<p><strong>Örnek Dosya İndir:</strong> <a href="/resource/edefter/verideseni_ornek.csv" target="_blank">
                            <img src="/images/csv-icon.png" height="40" width="35"/>
                        </a>
<br><br></p>

<table><thead>
<tr>
<th><strong>Alan Adı</strong></th>
<th><strong>Açıklama</strong></th>
</tr>
</thead><tbody>
<tr>
<td><strong>detailref</strong></td>
<td>Detay satır referansı</td>
</tr>
<tr>
<td><strong>entryref</strong></td>
<td>Bu alan muhasebe fişlerini gruplamak için kullandığımız bir alandır, bulunması zorunludur.</td>
</tr>
<tr>
<td><strong>Fişler</strong></td>
<td>hesaplanırken bu referans numarasına göre gruplanmaktadır. Bu alana, eğer ERP’de muhasebe fiş satır referans numaraları varsa onların yazılması gerekmekte. Eğer yoksa yevmiye madde numarası yani linenumbercounter yazılması gerekmekte.</td>
</tr>
<tr>
<td><strong>linenumber</strong></td>
<td>Yevmiye madde numarası haricinde dönem başında 1’den başlayacak ve arada boşluk olmaksızın ardışık olacak şekilde yevmiye madde satır numarası</td>
</tr>
<tr>
<td><strong>linenumbercounter</strong></td>
<td>Yevmiye madde no</td>
</tr>
<tr>
<td><strong>accmainid</strong></td>
<td>Kebir kodu (muhasebe kodu ilk 3 hane)</td>
</tr>
<tr>
<td><strong>accmainiddesc</strong></td>
<td>Kebir kodu (muhasebe kodu ilk 3 hane) açıklaması</td>
</tr>
<tr>
<td><strong>accsubid</strong></td>
<td>Muhasebe kodu</td>
</tr>
<tr>
<td><strong>accsubdesc</strong></td>
<td>Muhasebe kod açıklaması</td>
</tr>
<tr>
<td><strong>amount</strong></td>
<td>Tutar (negatif değer olmamalı)</td>
</tr>
<tr>
<td><strong>debitcreditcode</strong></td>
<td>Borç ise D, Alacak ise C</td>
</tr>
<tr>
<td><strong>postingdate</strong></td>
<td>Muhasebe fiş tarihi</td>
</tr>
<tr>
<td><strong>documenttype</strong></td>
<td><strong>invoice:</strong> Fatura <strong>check:</strong> Çek  <strong>voucher:</strong> Senet  ** other:** other : Yukarıda sayılanların dışında varolan belgeler için <strong>“other”</strong> belge türü kullanılır ve bununda açıklaması (documenttypedescription) alanında yapılır.  Belgeler hakkında detaylı bilgi için <strong>Önemli Hususlar</strong> başlığını inceleyebilirsiniz.</td>
</tr>
<tr>
<td><strong>documenttypedesc</strong></td>
<td><em>Doküman tipinin other olması durumunda bazı örnekler;</em> <strong>Paymentmethod Banka;</strong> Gelen Havaleler, Gönderilen Havaleler <strong>Paymentmethod Nakit;</strong> CH Tahsilat, CH Ödeme, Bankaya Yatırılan, Bankadan Çekilen, Gider Pusulası, Verilen Serbest Meslek Makbuzu, Alınan Serbest Meslek Makbuzu <strong>Paymentmethod Teminat Mektubu;</strong> Teminat Girişi,Teminat Çıkışı</td>
</tr>
<tr>
<td><strong>documentnumber</strong></td>
<td>İlişkili belgenin numarası (Örn: Fatura numarası)</td>
</tr>
<tr>
<td><strong>documentreference</strong></td>
<td>Muhasebe fiş referans numarası, kullanılan sistemde böyle bir numara yoksa yevmiye no</td>
</tr>
<tr>
<td><strong>entrynumbercounter</strong></td>
<td>Yevmiye madde no</td>
</tr>
<tr>
<td><strong>documentdate</strong></td>
<td>İlişkili belgenin tarihi (Örn: Fatura tarihi) yyyy-aa-gg formatında</td>
</tr>
<tr>
<td><strong>paymentmethod</strong></td>
<td>Çek, Senet, Nakit, Banka, Teminat Mektubu ya da boş</td>
</tr>
<tr>
<td><strong>detailcomment</strong></td>
<td>Muhasebe fişi satır açıklaması</td>
</tr>
<tr>
<td><strong>erpno</strong></td>
<td>Kullanılan sistemde firmaları birbirinden ayırt eden firma numarası, yoksa 001</td>
</tr>
<tr>
<td><strong>divisionno</strong></td>
<td>Kullanılan sistemde işyerlerini birbirinden ayıran işyeri numarası, kağıt ortamında basılan defterlerde ayrı olarak basılıyorsa e-defter’de farklı bir işyeri numarasına sahip olmalı yoksa 0</td>
</tr>
<tr>
<td><strong>enteredby</strong></td>
<td>Muhasebe fişini giren kişinin ad soyad ilk harfi yada açık halde adı soyadı</td>
</tr>
<tr>
<td><strong>entereddate</strong></td>
<td>Muhasebe fişi kayıt tarihi</td>
</tr>
<tr>
<td><strong>entrynumber</strong></td>
<td>Muhasebe fiş numarası, kullanılan sistemde böyle bir numara yoksa yevmiye no</td>
</tr>
<tr>
<td><strong>entrycomment</strong></td>
<td>Muhasebe fişi açıklaması</td>
</tr>
</tbody></table>

<aside class="warning">
  Platform bağımsız e-defter uygulaması olduğumuz için Gelir İdaresi Başkanlığına gönderilecek verilerin hazırlanması mükellefin sorumluluğundadır.
Muhasebe programında GİB’in belirlediği doküman tipleri haricinde belge türü olması durumunda, bu belgelerin hangi belge türü ile ilişkilendirileceği konusunda mali müşavirinizden bilgi alabilirsiniz.
</aside>

<h2 id="nemli-hususlar">Önemli Hususlar</h2>

<p>E-defter uygulamasına geçen mükelleflerin e-defteri oluşturacak kayıtların oluşturulması esnasında dikkat etmesi gereken konuları, e-defter belge tiplerinin neler olduğunu, e-defter alanlarının nasıl doldurulması gerektiğine değineceğiz.
Elektronik defter tutanlar, elektronik defterlerini oluşturdukları ve muhafaza ettikleri bilgi işlem sistemlerinin haczedilmesi veya bu sistemlere yetkili mercilerce el konulması halinde, durumu en geç üç iş günü içerisinde Başkanlık’a bildirmek zorundadırlar.</p>

<aside class="notice">DİKKAT: Elektronik defter uygulamasında her bir belgeye ait bilgilerin, tek bir yevmiye kaydında gösterilmesi esastır.
</aside>

<h3 id="belge-tipi">Belge Tipi</h3>

<p>Muhasebe kaydına esas teşkil eden işlem bir belgeye dayanıyorsa, mutlaka belge tipi alanının kullanılması gerekmektedir. Ancak muhasebe kaydına esas teşkil eden işlem bir belgeye dayanmıyorsa belge tipi alanı kullanılmamalıdır. Dolayısıyla muhasebe kaydına esas teşkil eden işlem bir belgeye dayanmıyorsa, belge türü, tarihi veya numarası gibi bilgiler verilemez. Örneğin, açılış-kapanış işlemleri belgeye dayalı olmayabilir.</p>

<p>Gelir İdaresi Başkanlığının yayımlandığı Yevmiye Defteri kılavuzunda aşağıdaki sekiz belge tipi tanımlanmıştır. Tabloda sayılan yedi belge tipinin dışında ki belgeler için <strong>“Diğer”</strong> belge türü kullanılır.</p>

<table><thead>
<tr>
<th><strong>Belge Tipi</strong></th>
<th><strong>Esas Belge</strong></th>
</tr>
</thead><tbody>
<tr>
<td><strong>invoice</strong></td>
<td>Fatura</td>
</tr>
<tr>
<td><strong>check</strong></td>
<td>Çek</td>
</tr>
<tr>
<td><strong>voucher</strong></td>
<td>Senet</td>
</tr>
<tr>
<td><strong>receipt</strong></td>
<td>Makbuz</td>
</tr>
<tr>
<td><strong>shipment</strong></td>
<td>Navlun</td>
</tr>
<tr>
<td><strong>order-vendor</strong></td>
<td>Satıcı Sipariş Belgesi</td>
</tr>
<tr>
<td><strong>order-customer</strong></td>
<td>Müşteri Sipariş Belgesi</td>
</tr>
<tr>
<td><strong>other</strong></td>
<td>Diğer</td>
</tr>
</tbody></table>

<h3 id="perakende-sat-fi-i">Perakende Satışı Fişi</h3>

<p>Perakende satış fişi sayılan 7 belge içerisinde olmadığı için belge tipi diğer olarak, belge açıklaması da perakende satış fişi olarak seçilmelidir.</p>

<h3 id="banka-lemleri">Banka İşlemleri</h3>

<p>Bilindiği üzere bankaya ait işlemlerde muhasebe kaydına esas belge bankadan verilen dekont olmaktadır. Dekontların e-Defter uygulamasında belge tipi <strong>“Diğer”</strong> ve belge açıklaması <strong>“dekont”</strong> olarak kaydı yapılır ve dekontun numara ve tarihinin de girilmesi zorunludur. Ancak dekont üzerinde belge numarası-tarihi yok ise, kullanılan muhasebe programının söz konusu işleme vermiş olduğu tarih ve numara, belge numarası ve tarihi olarak yazılabilir.</p>

<p>Eğer bankaya ait işlemler dekont bazında tek tek muhasebeleştirilemiyorsa, bu banka işlemleri günlük olarak, banka banka ayrıştırmak koşuluyla, her bir bankadan yapılan işlemler birer muhasebe fişinde işlenebilir. e-Defterde bu kayda esas belge olarak muhasebe fişi gösterilebilir. Bu muhasebe fişi e-defter uygulamasında belge tipi <strong>“Diğer”</strong> ve belge açıklaması <strong>“Muhasebe Fişi”</strong> olarak kaydı yapılır ve fişin numarası ve tarihi girilir.</p>

<h3 id="masraf-listeleri">Masraf Listeleri</h3>

<p>Gün içinde işletmenin ya da personelin yapmış olduğu giderlere ilişkin alınmış belgeler teknik kılavuzlarda sayılan belgelerden biriyse mutlaka belge tipi kılavuzda belirtildiği gibi olmalıdır. Örneğin, personelin yapmış olduğu giderler arasında belge olarak fatura varsa, bu fatura ayrı bir yevmiye kaydında belge türü <strong>“invoice”</strong> yani fatura olarak fatura belge tarih-numarası da yazılmak şartıyla kaydedilmelidir. Eğer yapılan giderle ilgili belge tipi, tablo 1’de sayılan ilk yedi belge tipinden biri değil ise bir masraf formu oluşturulup eDefter uygulamasında belge tipi <strong>“Diğer”</strong> ve belge açıklaması <strong>“masraf formu”</strong> olarak kaydı yapılır. Ayrıca bu masraf formunun numarası ve tarihinin de girilmesi zorunludur. Bu masraf formlarında matbu bir numara ve tarih olmadığı için, oluşturulacak her bir form için müteselsil bir numara ve formun oluşturulduğu günün tarihi üzerine yazılmalıdır. Bu masraf formunda yapılan giderlere ait belgelerin detayları yer almak zorundadır. Ayrıca bu masraf formu firma kaşesi ve imzasıyla matbu olarak ya da elektronik imza/mali mühür ile elektronik ortamda muhafaza edilmek zorundadır. Elektronik ortamda tutulacak belgelerin görüntülenebilir ve doğrulanabilir şekilde muhafaza ve ibraz edilmesinden, diğer matbu belgeler de olduğu gibi, mükellef sorumludur.</p>

<h3 id="z-raporu">Z raporu</h3>

<p>Gün sonunda her bir yazar kasadan alınan Z raporu, muhasebe kaydında belge tipi <strong>“Diğer”</strong> ve belge açıklaması <strong>“Z Raporu”</strong> olarak kaydı yapılır. Ayrıca bu Z Raporu’nun numarası ve tarihinin de girilmesi zorunludur. Ancak gün içinde yapılan satışlarda Z Raporunun üzerinde yer alan ödeme yöntemlerine (nakit, kredi kartı, vb.) göre ayrıştırılmalıdır. Ödeme yöntemine isabet edecek KDV tutarlarının da ayrıştırılması ve her bir ödeme yönteminin farklı yevmiye maddelerinde gösterilmesi gerekmektedir.</p>

<h3 id="ek-bordrosu">Çek Bordrosu</h3>

<p>e-Defter uygulamasında kılavuzda sayılan tüm belge tiplerinde olduğu gibi, her bir çek belgesinin de ayrı yevmiye maddelerine kaydedilmesi esastır. Ancak çek bordrosuyla da kaydı mümkün olduğundan e-Defter uygulamasında da bu bordolar üzerinden, aynı alıcı veya satıcıya ait olmak şartıyla, birden fazla çek aynı yevmiye maddesinde kaydedilebilir. Ayrıca muhasebe kaydında belge tipi <strong>“Diğer”</strong> ve belge açıklaması <strong>“Çek bordrosu”</strong> olarak kaydı yapılır ve bu çek bordrosunun numarası ve tarihinin girilmesi zorunludur. Bu çek bordrosunda matbu bir numara ve tarih olmadığı için, oluşturulacak her bir bordro için müteselsil bir numara verilmeli ve bordronun oluşturulduğu günün tarihi üzerine yazılmalıdır. Her bir çek bordrosunda, çeklerin detayları yer almak zorundadır. Bu çek bordrosu firma kaşesi ve imzasıyla matbu olarak ya da elektronik imza/mali mühür ile elektronik ortamda muhafaza edilmek zorundadır. Elektronik ortamda tutulacak belgelerin görüntülenebilir ve doğrulanabilir şekilde muhafaza ve ibraz edilmesinden, diğer matbu belgeler de olduğu gibi, mükellef sorumludur.</p>

<h3 id="senet-bordrosu">Senet Bordrosu</h3>

<p>e-Defter uygulamasında kılavuzda sayılan tüm belge türlerinde olduğu gibi, her bir senet belgesinin de ayrı yevmiye maddelerine kaydedilmesi esastır. Ancak senet bordrosuyla da kaydı mümkün olduğundan e-Defter uygulamasında da bu bordolar üzerinden, aynı alıcı veya satıcıya ait olmak şartıyla, birden fazla senet aynı yevmiye maddesinde kaydedilebilir. Ayrıca muhasebe kaydında belge tipi <strong>“Diğer”</strong> ve belge açıklaması <strong>“Senet bordrosu”</strong> olarak kaydı yapılır ve bu senet bordrosunun numarası ve tarihinin girilmesi zorunludur. Bu senet bordrosunda matbu bir numara ve tarih olmadığı için, oluşturulacak her bir bordro için müteselsil bir numara verilmeli ve bordronun oluşturulduğu günün tarihi üzerine yazılmalıdır. Senet bordrolarında, senetlerin detayları yer almak zorundadır. Bu senet bordrosu firma kaşesi ve imzasıyla matbu olarak ya da elektronik imza/mali mühür ile elektronik ortamda muhafaza edilmek zorundadır. Elektronik ortamda tutulacak belgelerin görüntülenebilir ve doğrulanabilir şekilde muhafaza ve ibraz edilmesinden, diğer matbu belgeler de olduğu gibi, mükellef sorumludur</p>

<h3 id="cret-bordrosu">Ücret Bordrosu</h3>

<p>Firmalar çalışanları için aylık olarak oluşturacakları ücret bordrolarını, e-Defter uygulamasına aktarırken, tüm personel için oluşan bordroları bir listeye bağlayıp, belge tipi <strong>“Diğer”</strong> ve belge açıklaması <strong>“Ücret Bordrosu İcmali”</strong> olarak kaydedebilir. Ücret bordrosu icmalinin numara ve tarihinin girilmesi zorunludur. Ancak Ücret bordrosu icmalinde matbu bir numara ve tarih olmadığı için, oluşturulacak her bir icmal listesi için müteselsil bir numara verilmeli ve icmalin oluşturulduğu günün tarihi üzerine yazılmalıdır. Bu ücret bordrosu icmalinde her bir ücret bordrosunun detayları yer almalıdır. Ayrıca bu icmaller firma kaşesi ve imzasıyla matbu olarak ya da elektronik imza/mali mühür ile elektronik ortamda muhafaza edilmek zorundadır. Elektronik ortamda tutulacak belgelerin görüntülenebilir ve doğrulanabilir şekilde muhafaza ve ibraz edilmesinden, diğer matbu belgeler de olduğu gibi, mükellef sorumludur.</p>

<h3 id="serbest-meslek-makbuzu">Serbest Meslek Makbuzu</h3>

<p>Serbest meslek erbabının, mesleki faaliyetlerine ilişkin her türlü tahsilatı için düzenlediği belge serbest meslek makbuzudur. Bu makbuz e-Defter kılavuzunda sayılan belgeler arasında yer alan makbuz ile karıştırılmamalıdır. Serbest meslek makbuzu sayılan belgeler arasında yer almadığı için belge tipi <strong>“Diğer”</strong> ve belge açıklaması <strong>“serbest meslek makbuzu”</strong> olarak kaydı yapılır. Ayrıca belgenin numarası ve tarihinin de girilmesi zorunludur.</p>

<h2 id="e-defter-ematron-kontrol">E-Defter Şematron Kontrolü</h2>

<ul>
<li>Uygulamamız tarafından hazırlanan defterler Gelir İdaresi Başkanlığı tarafından yayınlanan şematron kurallarından, iş kurallarından, mali mühür ya da imza kontrolünden geçmektedir. Oluşturulan defterlerin şematron kontrolünde hata
almaması için aşağıdaki kurallara uygun olarak veri hazırlanmalıdır.</li>
<li>Oluşturulacak defterlerin boyutunun 200 MB’ı geçmesi halinde bölünmesi gerekmektedir. Bölme işlemi uygulama
tarafından Gelir İdaresi Başkanlığı tarafından belirlenen kurallara göre otomatik olarak yapılmaktadır.</li>
<li>Bir yevmiyenin satır kalemleri aynı defter parçasında olmak durumundadır. Bir yevmiye kaydı 200 MB’ı geçerse
belirli icmal yöntemleriyle yevmiye kaydı gruplandırılmalıdır. Firmaların veri büyüklüklerine göre farklılık
göstermekle birlikte 200 MB‘lık parça yaklaşık 100.000 yevmiye satırına denk gelmektedir.</li>
<li>Defterler sıra ile aylık olarak yüklenmelidir. Örneğin, Temmuz ayının defteri GİB’e yüklenmemişse ya da GİB’den
onaylı beratları alınıp ay kapatılmamışsa mükellef bir sonraki ayın yani Ağustos’un defterini sistemde oluşturamaz.
Uygulama bu durumda hata verir.</li>
<li>GİB’e yüklenmiş, GİB’den onaylı beratları alınmış bir tarih aralığı için bir daha defter oluşturulamaz, aynı yolla ileri
bir tarihi de kapsayacak şekilde defter oluşturulamaz.</li>
<li>Defter kaynak verilerindeki zorunlu alanların kontrolü yapılır, kaynak veri detayları için destek@izibiz.com.tr
adresinden detaylı bilgi talep edilebilir.</li>
</ul>

      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="csharp">C#</a>
          </div>
      </div>
    </div>
  </body>
</html>
